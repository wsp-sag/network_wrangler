
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://wsp-sag.github.io/network_wrangler/add-delete-transit-projects/api/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../data_models/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>API Documentation - Network Wrangler</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="grey">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Network Wrangler" class="md-header__button md-logo" aria-label="Network Wrangler" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Network Wrangler
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="grey"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/wsp-sag/network_wrangler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  API Documentation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../data_models/" class="md-tabs__link">
        
  
    
  
  Data Models

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../design/" class="md-tabs__link">
        
  
    
  
  Design

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../development/" class="md-tabs__link">
        
  
    
  
  Development

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../networks/" class="md-tabs__link">
        
  
    
  
  Networks

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Network Wrangler" class="md-nav__button md-logo" aria-label="Network Wrangler" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Network Wrangler
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wsp-sag/network_wrangler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Common Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#base-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Base Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario" class="md-nav__link">
    <span class="md-ellipsis">
      scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ProjectCardError" class="md-nav__link">
    <span class="md-ellipsis">
      ProjectCardError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scenario">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.projects" class="md-nav__link">
    <span class="md-ellipsis">
      projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.queued_projects" class="md-nav__link">
    <span class="md-ellipsis">
      queued_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.add_project_cards" class="md-nav__link">
    <span class="md-ellipsis">
      add_project_cards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.apply_all_projects" class="md-nav__link">
    <span class="md-ellipsis">
      apply_all_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.apply_projects" class="md-nav__link">
    <span class="md-ellipsis">
      apply_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.order_projects" class="md-nav__link">
    <span class="md-ellipsis">
      order_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ScenarioConflictError" class="md-nav__link">
    <span class="md-ellipsis">
      ScenarioConflictError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ScenarioCorequisiteError" class="md-nav__link">
    <span class="md-ellipsis">
      ScenarioCorequisiteError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ScenarioPrerequisiteError" class="md-nav__link">
    <span class="md-ellipsis">
      ScenarioPrerequisiteError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.build_scenario_from_config" class="md-nav__link">
    <span class="md-ellipsis">
      build_scenario_from_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.build_scenario_from_config_file" class="md-nav__link">
    <span class="md-ellipsis">
      build_scenario_from_config_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.create_base_scenario" class="md-nav__link">
    <span class="md-ellipsis">
      create_base_scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.create_scenario" class="md-nav__link">
    <span class="md-ellipsis">
      create_scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.scenario_summary" class="md-nav__link">
    <span class="md-ellipsis">
      scenario_summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network" class="md-nav__link">
    <span class="md-ellipsis">
      network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      RoadwayNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RoadwayNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.link_shapes_df" class="md-nav__link">
    <span class="md-ellipsis">
      link_shapes_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.model_net" class="md-nav__link">
    <span class="md-ellipsis">
      model_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.network_hash" class="md-nav__link">
    <span class="md-ellipsis">
      network_hash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.shapes_df" class="md-nav__link">
    <span class="md-ellipsis">
      shapes_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.summary" class="md-nav__link">
    <span class="md-ellipsis">
      summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_incident_link_data_to_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      add_incident_link_data_to_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_links" class="md-nav__link">
    <span class="md-ellipsis">
      add_links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      add_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      add_shapes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.apply" class="md-nav__link">
    <span class="md-ellipsis">
      apply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.clean_unused_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      clean_unused_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.clean_unused_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      clean_unused_shapes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.coerce_crs" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_crs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.delete_links" class="md-nav__link">
    <span class="md-ellipsis">
      delete_links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.delete_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      delete_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.get_modal_graph" class="md-nav__link">
    <span class="md-ellipsis">
      get_modal_graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.get_property_by_timespan_and_group" class="md-nav__link">
    <span class="md-ellipsis">
      get_property_by_timespan_and_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.get_selection" class="md-nav__link">
    <span class="md-ellipsis">
      get_selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.has_link" class="md-nav__link">
    <span class="md-ellipsis">
      has_link
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.has_node" class="md-nav__link">
    <span class="md-ellipsis">
      has_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.is_connected" class="md-nav__link">
    <span class="md-ellipsis">
      is_connected
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.links_with_link_ids" class="md-nav__link">
    <span class="md-ellipsis">
      links_with_link_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.links_with_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      links_with_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.modal_graph_hash" class="md-nav__link">
    <span class="md-ellipsis">
      modal_graph_hash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.move_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      move_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.nodes_in_links" class="md-nav__link">
    <span class="md-ellipsis">
      nodes_in_links
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.transit.network" class="md-nav__link">
    <span class="md-ellipsis">
      network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      TransitNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TransitNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.consistent_with_road_net" class="md-nav__link">
    <span class="md-ellipsis">
      consistent_with_road_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.feed" class="md-nav__link">
    <span class="md-ellipsis">
      feed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.feed_hash" class="md-nav__link">
    <span class="md-ellipsis">
      feed_hash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.feed_path" class="md-nav__link">
    <span class="md-ellipsis">
      feed_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.road_net" class="md-nav__link">
    <span class="md-ellipsis">
      road_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.shape_links_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      shape_links_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.shapes_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      shapes_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.stop_time_links_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      stop_time_links_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.stop_times_points_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      stop_times_points_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.stops_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      stops_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.__deepcopy__" class="md-nav__link">
    <span class="md-ellipsis">
      __deepcopy__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.apply" class="md-nav__link">
    <span class="md-ellipsis">
      apply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.deepcopy" class="md-nav__link">
    <span class="md-ellipsis">
      deepcopy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.get_selection" class="md-nav__link">
    <span class="md-ellipsis">
      get_selection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitRoadwayConsistencyError" class="md-nav__link">
    <span class="md-ellipsis">
      TransitRoadwayConsistencyError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.COPY_FROM_GP_TO_ML" class="md-nav__link">
    <span class="md-ellipsis">
      COPY_FROM_GP_TO_ML
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.COPY_TO_ACCESS_EGRESS" class="md-nav__link">
    <span class="md-ellipsis">
      COPY_TO_ACCESS_EGRESS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_CATEGORY" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_CATEGORY
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_DELETE_MODES" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_DELETE_MODES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_MAX_SEARCH_BREADTH" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_MAX_SEARCH_BREADTH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SEARCH_BREADTH" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SEARCH_BREADTH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SEARCH_MODES" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SEARCH_MODES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SP_WEIGHT_COL" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SP_WEIGHT_COL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SP_WEIGHT_FACTOR" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SP_WEIGHT_FACTOR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_TIMESPAN" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_TIMESPAN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.EST_PD_READ_SPEED" class="md-nav__link">
    <span class="md-ellipsis">
      EST_PD_READ_SPEED
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.MANAGED_LANES_LINK_ID_RANGE" class="md-nav__link">
    <span class="md-ellipsis">
      MANAGED_LANES_LINK_ID_RANGE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.MANAGED_LANES_REQUIRED_ATTRIBUTES" class="md-nav__link">
    <span class="md-ellipsis">
      MANAGED_LANES_REQUIRED_ATTRIBUTES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.ML_OFFSET_METERS" class="md-nav__link">
    <span class="md-ellipsis">
      ML_OFFSET_METERS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.SECONDARY_TRANSIT_CARD_TYPES" class="md-nav__link">
    <span class="md-ellipsis">
      SECONDARY_TRANSIT_CARD_TYPES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams" class="md-nav__link">
    <span class="md-ellipsis">
      LinksParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LinksParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.display_cols" class="md-nav__link">
    <span class="md-ellipsis">
      display_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.explicit_ids" class="md-nav__link">
    <span class="md-ellipsis">
      explicit_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.fks_to_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      fks_to_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.idx_col" class="md-nav__link">
    <span class="md-ellipsis">
      idx_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.unique_ids" class="md-nav__link">
    <span class="md-ellipsis">
      unique_ids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams" class="md-nav__link">
    <span class="md-ellipsis">
      NodesParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodesParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.display_cols" class="md-nav__link">
    <span class="md-ellipsis">
      display_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.explicit_ids" class="md-nav__link">
    <span class="md-ellipsis">
      explicit_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.geometry_props" class="md-nav__link">
    <span class="md-ellipsis">
      geometry_props
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.idx_col" class="md-nav__link">
    <span class="md-ellipsis">
      idx_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.unique_ids" class="md-nav__link">
    <span class="md-ellipsis">
      unique_ids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.ShapesParams" class="md-nav__link">
    <span class="md-ellipsis">
      ShapesParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ShapesParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.ShapesParams.idx_col" class="md-nav__link">
    <span class="md-ellipsis">
      idx_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.ShapesParams.unique_ids" class="md-nav__link">
    <span class="md-ellipsis">
      unique_ids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projects" class="md-nav__link">
    <span class="md-ellipsis">
      Projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roadway" class="md-nav__link">
    <span class="md-ellipsis">
      Roadway
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Roadway">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Network Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shapes" class="md-nav__link">
    <span class="md-ellipsis">
      Shapes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supporting-classes-methods-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Supporting Classes, Methods + Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils-and-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Utils and Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.check_one_or_one_superset_present" class="md-nav__link">
    <span class="md-ellipsis">
      check_one_or_one_superset_present
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.combine_unique_unhashable_list" class="md-nav__link">
    <span class="md-ellipsis">
      combine_unique_unhashable_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.delete_keys_from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      delete_keys_from_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.dict_to_hexkey" class="md-nav__link">
    <span class="md-ellipsis">
      dict_to_hexkey
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.findkeys" class="md-nav__link">
    <span class="md-ellipsis">
      findkeys
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.generate_list_of_new_ids" class="md-nav__link">
    <span class="md-ellipsis">
      generate_list_of_new_ids
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.generate_new_id" class="md-nav__link">
    <span class="md-ellipsis">
      generate_new_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.get_overlapping_range" class="md-nav__link">
    <span class="md-ellipsis">
      get_overlapping_range
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.list_elements_subset_of_single_element" class="md-nav__link">
    <span class="md-ellipsis">
      list_elements_subset_of_single_element
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.make_slug" class="md-nav__link">
    <span class="md-ellipsis">
      make_slug
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.normalize_to_lists" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_to_lists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.split_string_prefix_suffix_from_num" class="md-nav__link">
    <span class="md-ellipsis">
      split_string_prefix_suffix_from_num
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.topological_sort" class="md-nav__link">
    <span class="md-ellipsis">
      topological_sort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io" class="md-nav__link">
    <span class="md-ellipsis">
      io
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.FileReadError" class="md-nav__link">
    <span class="md-ellipsis">
      FileReadError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.FileWriteError" class="md-nav__link">
    <span class="md-ellipsis">
      FileWriteError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.convert_file_serialization" class="md-nav__link">
    <span class="md-ellipsis">
      convert_file_serialization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.read_table" class="md-nav__link">
    <span class="md-ellipsis">
      read_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.unzip_file" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.write_table" class="md-nav__link">
    <span class="md-ellipsis">
      write_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models" class="md-nav__link">
    <span class="md-ellipsis">
      models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.DatamodelDataframeIncompatableError" class="md-nav__link">
    <span class="md-ellipsis">
      DatamodelDataframeIncompatableError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.TableValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      TableValidationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.coerce_extra_fields_to_type_in_df" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_extra_fields_to_type_in_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.default_from_datamodel" class="md-nav__link">
    <span class="md-ellipsis">
      default_from_datamodel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.empty_df_from_datamodel" class="md-nav__link">
    <span class="md-ellipsis">
      empty_df_from_datamodel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.extra_attributes_undefined_in_model" class="md-nav__link">
    <span class="md-ellipsis">
      extra_attributes_undefined_in_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.identify_model" class="md-nav__link">
    <span class="md-ellipsis">
      identify_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.submodel_fields_in_model" class="md-nav__link">
    <span class="md-ellipsis">
      submodel_fields_in_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.validate_df_to_model" class="md-nav__link">
    <span class="md-ellipsis">
      validate_df_to_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.net" class="md-nav__link">
    <span class="md-ellipsis">
      net
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.net.point_seq_to_links" class="md-nav__link">
    <span class="md-ellipsis">
      point_seq_to_links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time" class="md-nav__link">
    <span class="md-ellipsis">
      time
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.convert_timespan_to_start_end_dt" class="md-nav__link">
    <span class="md-ellipsis">
      convert_timespan_to_start_end_dt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_contains" class="md-nav__link">
    <span class="md-ellipsis">
      dt_contains
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_list_overlaps" class="md-nav__link">
    <span class="md-ellipsis">
      dt_list_overlaps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_overlap_duration" class="md-nav__link">
    <span class="md-ellipsis">
      dt_overlap_duration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_overlaps" class="md-nav__link">
    <span class="md-ellipsis">
      dt_overlaps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_to_seconds_from_midnight" class="md-nav__link">
    <span class="md-ellipsis">
      dt_to_seconds_from_midnight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.duration_dt" class="md-nav__link">
    <span class="md-ellipsis">
      duration_dt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.filter_df_to_max_overlapping_timespans" class="md-nav__link">
    <span class="md-ellipsis">
      filter_df_to_max_overlapping_timespans
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.filter_df_to_overlapping_timespans" class="md-nav__link">
    <span class="md-ellipsis">
      filter_df_to_overlapping_timespans
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.filter_dt_list_to_overlaps" class="md-nav__link">
    <span class="md-ellipsis">
      filter_dt_list_to_overlaps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.format_time" class="md-nav__link">
    <span class="md-ellipsis">
      format_time
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.seconds_from_midnight_to_str" class="md-nav__link">
    <span class="md-ellipsis">
      seconds_from_midnight_to_str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.str_to_seconds_from_midnight" class="md-nav__link">
    <span class="md-ellipsis">
      str_to_seconds_from_midnight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.str_to_time" class="md-nav__link">
    <span class="md-ellipsis">
      str_to_time
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.str_to_time_list" class="md-nav__link">
    <span class="md-ellipsis">
      str_to_time_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.timespan_str_list_to_dt" class="md-nav__link">
    <span class="md-ellipsis">
      timespan_str_list_to_dt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.timespans_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      timespans_overlap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.InvalidJoinFieldError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidJoinFieldError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.MissingPropertiesError" class="md-nav__link">
    <span class="md-ellipsis">
      MissingPropertiesError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.attach_parameters_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      attach_parameters_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_dict_to_df_types" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_dict_to_df_types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_gdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_val_to_df_types" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_val_to_df_types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_val_to_series_type" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_val_to_series_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.compare_df_values" class="md-nav__link">
    <span class="md-ellipsis">
      compare_df_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.compare_lists" class="md-nav__link">
    <span class="md-ellipsis">
      compare_lists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.convert_numpy_to_list" class="md-nav__link">
    <span class="md-ellipsis">
      convert_numpy_to_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.dict_fields_in_df" class="md-nav__link">
    <span class="md-ellipsis">
      dict_fields_in_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.dict_to_query" class="md-nav__link">
    <span class="md-ellipsis">
      dict_to_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.diff_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      diff_dfs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.diff_list_like_series" class="md-nav__link">
    <span class="md-ellipsis">
      diff_list_like_series
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.fk_in_pk" class="md-nav__link">
    <span class="md-ellipsis">
      fk_in_pk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.list_like_columns" class="md-nav__link">
    <span class="md-ellipsis">
      list_like_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.segment_data_by_selection" class="md-nav__link">
    <span class="md-ellipsis">
      segment_data_by_selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.segment_data_by_selection_min_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      segment_data_by_selection_min_overlap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.update_df_by_col_value" class="md-nav__link">
    <span class="md-ellipsis">
      update_df_by_col_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.validate_existing_value_in_df" class="md-nav__link">
    <span class="md-ellipsis">
      validate_existing_value_in_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo" class="md-nav__link">
    <span class="md-ellipsis">
      geo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.InvalidCRSError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidCRSError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.MissingNodesError" class="md-nav__link">
    <span class="md-ellipsis">
      MissingNodesError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.check_point_valid_for_crs" class="md-nav__link">
    <span class="md-ellipsis">
      check_point_valid_for_crs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.get_bearing" class="md-nav__link">
    <span class="md-ellipsis">
      get_bearing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.get_bounding_polygon" class="md-nav__link">
    <span class="md-ellipsis">
      get_bounding_polygon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.get_point_geometry_from_linestring" class="md-nav__link">
    <span class="md-ellipsis">
      get_point_geometry_from_linestring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.length_of_linestring_miles" class="md-nav__link">
    <span class="md-ellipsis">
      length_of_linestring_miles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.linestring_from_lats_lons" class="md-nav__link">
    <span class="md-ellipsis">
      linestring_from_lats_lons
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.linestring_from_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      linestring_from_nodes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.location_ref_from_point" class="md-nav__link">
    <span class="md-ellipsis">
      location_ref_from_point
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.location_refs_from_linestring" class="md-nav__link">
    <span class="md-ellipsis">
      location_refs_from_linestring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.offset_geometry_meters" class="md-nav__link">
    <span class="md-ellipsis">
      offset_geometry_meters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.offset_point_with_distance_and_bearing" class="md-nav__link">
    <span class="md-ellipsis">
      offset_point_with_distance_and_bearing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.point_from_xy" class="md-nav__link">
    <span class="md-ellipsis">
      point_from_xy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.to_points_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      to_points_gdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.update_nodes_in_linestring_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      update_nodes_in_linestring_geometry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.update_point_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      update_point_geometry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.update_points_in_linestring" class="md-nav__link">
    <span class="md-ellipsis">
      update_points_in_linestring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors" class="md-nav__link">
    <span class="md-ellipsis">
      df_accessors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.DictQueryAccessor" class="md-nav__link">
    <span class="md-ellipsis">
      DictQueryAccessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DictQueryAccessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.DictQueryAccessor.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.DictQueryAccessor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.dfHash" class="md-nav__link">
    <span class="md-ellipsis">
      dfHash
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dfHash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.dfHash.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.dfHash.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.logger.setup_logging" class="md-nav__link">
    <span class="md-ellipsis">
      setup_logging
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Design
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Networks
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Common Usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#base-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Base Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario" class="md-nav__link">
    <span class="md-ellipsis">
      scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ProjectCardError" class="md-nav__link">
    <span class="md-ellipsis">
      ProjectCardError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario" class="md-nav__link">
    <span class="md-ellipsis">
      Scenario
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scenario">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.projects" class="md-nav__link">
    <span class="md-ellipsis">
      projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.queued_projects" class="md-nav__link">
    <span class="md-ellipsis">
      queued_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.add_project_cards" class="md-nav__link">
    <span class="md-ellipsis">
      add_project_cards
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.apply_all_projects" class="md-nav__link">
    <span class="md-ellipsis">
      apply_all_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.apply_projects" class="md-nav__link">
    <span class="md-ellipsis">
      apply_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.order_projects" class="md-nav__link">
    <span class="md-ellipsis">
      order_projects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.summarize" class="md-nav__link">
    <span class="md-ellipsis">
      summarize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.scenario.Scenario.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ScenarioConflictError" class="md-nav__link">
    <span class="md-ellipsis">
      ScenarioConflictError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ScenarioCorequisiteError" class="md-nav__link">
    <span class="md-ellipsis">
      ScenarioCorequisiteError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.ScenarioPrerequisiteError" class="md-nav__link">
    <span class="md-ellipsis">
      ScenarioPrerequisiteError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.build_scenario_from_config" class="md-nav__link">
    <span class="md-ellipsis">
      build_scenario_from_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.build_scenario_from_config_file" class="md-nav__link">
    <span class="md-ellipsis">
      build_scenario_from_config_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.create_base_scenario" class="md-nav__link">
    <span class="md-ellipsis">
      create_base_scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.create_scenario" class="md-nav__link">
    <span class="md-ellipsis">
      create_scenario
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.scenario.scenario_summary" class="md-nav__link">
    <span class="md-ellipsis">
      scenario_summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network" class="md-nav__link">
    <span class="md-ellipsis">
      network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      RoadwayNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RoadwayNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.link_shapes_df" class="md-nav__link">
    <span class="md-ellipsis">
      link_shapes_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.model_net" class="md-nav__link">
    <span class="md-ellipsis">
      model_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.network_hash" class="md-nav__link">
    <span class="md-ellipsis">
      network_hash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.shapes_df" class="md-nav__link">
    <span class="md-ellipsis">
      shapes_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.summary" class="md-nav__link">
    <span class="md-ellipsis">
      summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_incident_link_data_to_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      add_incident_link_data_to_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_links" class="md-nav__link">
    <span class="md-ellipsis">
      add_links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      add_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.add_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      add_shapes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.apply" class="md-nav__link">
    <span class="md-ellipsis">
      apply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.clean_unused_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      clean_unused_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.clean_unused_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      clean_unused_shapes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.coerce_crs" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_crs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.delete_links" class="md-nav__link">
    <span class="md-ellipsis">
      delete_links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.delete_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      delete_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.get_modal_graph" class="md-nav__link">
    <span class="md-ellipsis">
      get_modal_graph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.get_property_by_timespan_and_group" class="md-nav__link">
    <span class="md-ellipsis">
      get_property_by_timespan_and_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.get_selection" class="md-nav__link">
    <span class="md-ellipsis">
      get_selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.has_link" class="md-nav__link">
    <span class="md-ellipsis">
      has_link
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.has_node" class="md-nav__link">
    <span class="md-ellipsis">
      has_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.is_connected" class="md-nav__link">
    <span class="md-ellipsis">
      is_connected
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.links_with_link_ids" class="md-nav__link">
    <span class="md-ellipsis">
      links_with_link_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.links_with_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      links_with_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.modal_graph_hash" class="md-nav__link">
    <span class="md-ellipsis">
      modal_graph_hash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.move_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      move_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.roadway.network.RoadwayNetwork.nodes_in_links" class="md-nav__link">
    <span class="md-ellipsis">
      nodes_in_links
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.transit.network" class="md-nav__link">
    <span class="md-ellipsis">
      network
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork" class="md-nav__link">
    <span class="md-ellipsis">
      TransitNetwork
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TransitNetwork">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.consistent_with_road_net" class="md-nav__link">
    <span class="md-ellipsis">
      consistent_with_road_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.feed" class="md-nav__link">
    <span class="md-ellipsis">
      feed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.feed_hash" class="md-nav__link">
    <span class="md-ellipsis">
      feed_hash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.feed_path" class="md-nav__link">
    <span class="md-ellipsis">
      feed_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.road_net" class="md-nav__link">
    <span class="md-ellipsis">
      road_net
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.shape_links_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      shape_links_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.shapes_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      shapes_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.stop_time_links_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      stop_time_links_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.stop_times_points_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      stop_times_points_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.stops_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      stops_gdf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.__deepcopy__" class="md-nav__link">
    <span class="md-ellipsis">
      __deepcopy__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.apply" class="md-nav__link">
    <span class="md-ellipsis">
      apply
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.deepcopy" class="md-nav__link">
    <span class="md-ellipsis">
      deepcopy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitNetwork.get_selection" class="md-nav__link">
    <span class="md-ellipsis">
      get_selection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.transit.network.TransitRoadwayConsistencyError" class="md-nav__link">
    <span class="md-ellipsis">
      TransitRoadwayConsistencyError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.COPY_FROM_GP_TO_ML" class="md-nav__link">
    <span class="md-ellipsis">
      COPY_FROM_GP_TO_ML
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.COPY_TO_ACCESS_EGRESS" class="md-nav__link">
    <span class="md-ellipsis">
      COPY_TO_ACCESS_EGRESS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_CATEGORY" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_CATEGORY
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_DELETE_MODES" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_DELETE_MODES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_MAX_SEARCH_BREADTH" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_MAX_SEARCH_BREADTH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SEARCH_BREADTH" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SEARCH_BREADTH
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SEARCH_MODES" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SEARCH_MODES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SP_WEIGHT_COL" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SP_WEIGHT_COL
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_SP_WEIGHT_FACTOR" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SP_WEIGHT_FACTOR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.DEFAULT_TIMESPAN" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_TIMESPAN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.EST_PD_READ_SPEED" class="md-nav__link">
    <span class="md-ellipsis">
      EST_PD_READ_SPEED
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.MANAGED_LANES_LINK_ID_RANGE" class="md-nav__link">
    <span class="md-ellipsis">
      MANAGED_LANES_LINK_ID_RANGE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.MANAGED_LANES_REQUIRED_ATTRIBUTES" class="md-nav__link">
    <span class="md-ellipsis">
      MANAGED_LANES_REQUIRED_ATTRIBUTES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.ML_OFFSET_METERS" class="md-nav__link">
    <span class="md-ellipsis">
      ML_OFFSET_METERS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.SECONDARY_TRANSIT_CARD_TYPES" class="md-nav__link">
    <span class="md-ellipsis">
      SECONDARY_TRANSIT_CARD_TYPES
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams" class="md-nav__link">
    <span class="md-ellipsis">
      LinksParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LinksParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.display_cols" class="md-nav__link">
    <span class="md-ellipsis">
      display_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.explicit_ids" class="md-nav__link">
    <span class="md-ellipsis">
      explicit_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.fks_to_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      fks_to_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.idx_col" class="md-nav__link">
    <span class="md-ellipsis">
      idx_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.LinksParams.unique_ids" class="md-nav__link">
    <span class="md-ellipsis">
      unique_ids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams" class="md-nav__link">
    <span class="md-ellipsis">
      NodesParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodesParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.display_cols" class="md-nav__link">
    <span class="md-ellipsis">
      display_cols
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.explicit_ids" class="md-nav__link">
    <span class="md-ellipsis">
      explicit_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.geometry_props" class="md-nav__link">
    <span class="md-ellipsis">
      geometry_props
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.idx_col" class="md-nav__link">
    <span class="md-ellipsis">
      idx_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.NodesParams.unique_ids" class="md-nav__link">
    <span class="md-ellipsis">
      unique_ids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.params.ShapesParams" class="md-nav__link">
    <span class="md-ellipsis">
      ShapesParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ShapesParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.ShapesParams.idx_col" class="md-nav__link">
    <span class="md-ellipsis">
      idx_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.params.ShapesParams.unique_ids" class="md-nav__link">
    <span class="md-ellipsis">
      unique_ids
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projects" class="md-nav__link">
    <span class="md-ellipsis">
      Projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#roadway" class="md-nav__link">
    <span class="md-ellipsis">
      Roadway
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Roadway">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Network Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shapes" class="md-nav__link">
    <span class="md-ellipsis">
      Shapes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supporting-classes-methods-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Supporting Classes, Methods + Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils-and-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Utils and Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.check_one_or_one_superset_present" class="md-nav__link">
    <span class="md-ellipsis">
      check_one_or_one_superset_present
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.combine_unique_unhashable_list" class="md-nav__link">
    <span class="md-ellipsis">
      combine_unique_unhashable_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.delete_keys_from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      delete_keys_from_dict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.dict_to_hexkey" class="md-nav__link">
    <span class="md-ellipsis">
      dict_to_hexkey
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.findkeys" class="md-nav__link">
    <span class="md-ellipsis">
      findkeys
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.generate_list_of_new_ids" class="md-nav__link">
    <span class="md-ellipsis">
      generate_list_of_new_ids
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.generate_new_id" class="md-nav__link">
    <span class="md-ellipsis">
      generate_new_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.get_overlapping_range" class="md-nav__link">
    <span class="md-ellipsis">
      get_overlapping_range
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.list_elements_subset_of_single_element" class="md-nav__link">
    <span class="md-ellipsis">
      list_elements_subset_of_single_element
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.make_slug" class="md-nav__link">
    <span class="md-ellipsis">
      make_slug
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.normalize_to_lists" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_to_lists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.split_string_prefix_suffix_from_num" class="md-nav__link">
    <span class="md-ellipsis">
      split_string_prefix_suffix_from_num
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.utils.topological_sort" class="md-nav__link">
    <span class="md-ellipsis">
      topological_sort
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io" class="md-nav__link">
    <span class="md-ellipsis">
      io
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.FileReadError" class="md-nav__link">
    <span class="md-ellipsis">
      FileReadError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.FileWriteError" class="md-nav__link">
    <span class="md-ellipsis">
      FileWriteError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.convert_file_serialization" class="md-nav__link">
    <span class="md-ellipsis">
      convert_file_serialization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.read_table" class="md-nav__link">
    <span class="md-ellipsis">
      read_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.unzip_file" class="md-nav__link">
    <span class="md-ellipsis">
      unzip_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.io.write_table" class="md-nav__link">
    <span class="md-ellipsis">
      write_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models" class="md-nav__link">
    <span class="md-ellipsis">
      models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.DatamodelDataframeIncompatableError" class="md-nav__link">
    <span class="md-ellipsis">
      DatamodelDataframeIncompatableError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.TableValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      TableValidationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.coerce_extra_fields_to_type_in_df" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_extra_fields_to_type_in_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.default_from_datamodel" class="md-nav__link">
    <span class="md-ellipsis">
      default_from_datamodel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.empty_df_from_datamodel" class="md-nav__link">
    <span class="md-ellipsis">
      empty_df_from_datamodel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.extra_attributes_undefined_in_model" class="md-nav__link">
    <span class="md-ellipsis">
      extra_attributes_undefined_in_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.identify_model" class="md-nav__link">
    <span class="md-ellipsis">
      identify_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.submodel_fields_in_model" class="md-nav__link">
    <span class="md-ellipsis">
      submodel_fields_in_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.models.validate_df_to_model" class="md-nav__link">
    <span class="md-ellipsis">
      validate_df_to_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.net" class="md-nav__link">
    <span class="md-ellipsis">
      net
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.net.point_seq_to_links" class="md-nav__link">
    <span class="md-ellipsis">
      point_seq_to_links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time" class="md-nav__link">
    <span class="md-ellipsis">
      time
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.convert_timespan_to_start_end_dt" class="md-nav__link">
    <span class="md-ellipsis">
      convert_timespan_to_start_end_dt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_contains" class="md-nav__link">
    <span class="md-ellipsis">
      dt_contains
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_list_overlaps" class="md-nav__link">
    <span class="md-ellipsis">
      dt_list_overlaps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_overlap_duration" class="md-nav__link">
    <span class="md-ellipsis">
      dt_overlap_duration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_overlaps" class="md-nav__link">
    <span class="md-ellipsis">
      dt_overlaps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.dt_to_seconds_from_midnight" class="md-nav__link">
    <span class="md-ellipsis">
      dt_to_seconds_from_midnight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.duration_dt" class="md-nav__link">
    <span class="md-ellipsis">
      duration_dt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.filter_df_to_max_overlapping_timespans" class="md-nav__link">
    <span class="md-ellipsis">
      filter_df_to_max_overlapping_timespans
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.filter_df_to_overlapping_timespans" class="md-nav__link">
    <span class="md-ellipsis">
      filter_df_to_overlapping_timespans
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.filter_dt_list_to_overlaps" class="md-nav__link">
    <span class="md-ellipsis">
      filter_dt_list_to_overlaps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.format_time" class="md-nav__link">
    <span class="md-ellipsis">
      format_time
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.seconds_from_midnight_to_str" class="md-nav__link">
    <span class="md-ellipsis">
      seconds_from_midnight_to_str
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.str_to_seconds_from_midnight" class="md-nav__link">
    <span class="md-ellipsis">
      str_to_seconds_from_midnight
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.str_to_time" class="md-nav__link">
    <span class="md-ellipsis">
      str_to_time
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.str_to_time_list" class="md-nav__link">
    <span class="md-ellipsis">
      str_to_time_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.timespan_str_list_to_dt" class="md-nav__link">
    <span class="md-ellipsis">
      timespan_str_list_to_dt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.time.timespans_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      timespans_overlap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.InvalidJoinFieldError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidJoinFieldError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.MissingPropertiesError" class="md-nav__link">
    <span class="md-ellipsis">
      MissingPropertiesError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.attach_parameters_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      attach_parameters_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_dict_to_df_types" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_dict_to_df_types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_gdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_val_to_df_types" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_val_to_df_types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.coerce_val_to_series_type" class="md-nav__link">
    <span class="md-ellipsis">
      coerce_val_to_series_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.compare_df_values" class="md-nav__link">
    <span class="md-ellipsis">
      compare_df_values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.compare_lists" class="md-nav__link">
    <span class="md-ellipsis">
      compare_lists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.convert_numpy_to_list" class="md-nav__link">
    <span class="md-ellipsis">
      convert_numpy_to_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.dict_fields_in_df" class="md-nav__link">
    <span class="md-ellipsis">
      dict_fields_in_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.dict_to_query" class="md-nav__link">
    <span class="md-ellipsis">
      dict_to_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.diff_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      diff_dfs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.diff_list_like_series" class="md-nav__link">
    <span class="md-ellipsis">
      diff_list_like_series
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.fk_in_pk" class="md-nav__link">
    <span class="md-ellipsis">
      fk_in_pk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.list_like_columns" class="md-nav__link">
    <span class="md-ellipsis">
      list_like_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.segment_data_by_selection" class="md-nav__link">
    <span class="md-ellipsis">
      segment_data_by_selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.segment_data_by_selection_min_overlap" class="md-nav__link">
    <span class="md-ellipsis">
      segment_data_by_selection_min_overlap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.update_df_by_col_value" class="md-nav__link">
    <span class="md-ellipsis">
      update_df_by_col_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.data.validate_existing_value_in_df" class="md-nav__link">
    <span class="md-ellipsis">
      validate_existing_value_in_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo" class="md-nav__link">
    <span class="md-ellipsis">
      geo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.InvalidCRSError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidCRSError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.MissingNodesError" class="md-nav__link">
    <span class="md-ellipsis">
      MissingNodesError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.check_point_valid_for_crs" class="md-nav__link">
    <span class="md-ellipsis">
      check_point_valid_for_crs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.get_bearing" class="md-nav__link">
    <span class="md-ellipsis">
      get_bearing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.get_bounding_polygon" class="md-nav__link">
    <span class="md-ellipsis">
      get_bounding_polygon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.get_point_geometry_from_linestring" class="md-nav__link">
    <span class="md-ellipsis">
      get_point_geometry_from_linestring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.length_of_linestring_miles" class="md-nav__link">
    <span class="md-ellipsis">
      length_of_linestring_miles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.linestring_from_lats_lons" class="md-nav__link">
    <span class="md-ellipsis">
      linestring_from_lats_lons
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.linestring_from_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      linestring_from_nodes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.location_ref_from_point" class="md-nav__link">
    <span class="md-ellipsis">
      location_ref_from_point
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.location_refs_from_linestring" class="md-nav__link">
    <span class="md-ellipsis">
      location_refs_from_linestring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.offset_geometry_meters" class="md-nav__link">
    <span class="md-ellipsis">
      offset_geometry_meters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.offset_point_with_distance_and_bearing" class="md-nav__link">
    <span class="md-ellipsis">
      offset_point_with_distance_and_bearing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.point_from_xy" class="md-nav__link">
    <span class="md-ellipsis">
      point_from_xy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.to_points_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      to_points_gdf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.update_nodes_in_linestring_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      update_nodes_in_linestring_geometry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.update_point_geometry" class="md-nav__link">
    <span class="md-ellipsis">
      update_point_geometry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.geo.update_points_in_linestring" class="md-nav__link">
    <span class="md-ellipsis">
      update_points_in_linestring
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors" class="md-nav__link">
    <span class="md-ellipsis">
      df_accessors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.DictQueryAccessor" class="md-nav__link">
    <span class="md-ellipsis">
      DictQueryAccessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DictQueryAccessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.DictQueryAccessor.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.DictQueryAccessor.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.dfHash" class="md-nav__link">
    <span class="md-ellipsis">
      dfHash
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dfHash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.dfHash.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network_wrangler.utils.df_accessors.dfHash.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_wrangler.logger.setup_logging" class="md-nav__link">
    <span class="md-ellipsis">
      setup_logging
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="api-documentation">API Documentation<a class="headerlink" href="#api-documentation" title="Permanent link"> </a></h1>
<h2 id="common-usage">Common Usage<a class="headerlink" href="#common-usage" title="Permanent link"> </a></h2>
<h2 id="base-objects">Base Objects<a class="headerlink" href="#base-objects" title="Permanent link"> </a></h2>


<div class="doc doc-object doc-module">



<a id="network_wrangler.scenario"></a>
    <div class="doc doc-contents first">

      <p>Scenario class and related functions for managing a scenario.</p>
<p>Usage:</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">my_base_year_scenario</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;road_net&quot;</span><span class="p">:</span> <span class="n">load_roadway</span><span class="p">(</span>
        <span class="n">links_file</span><span class="o">=</span><span class="n">STPAUL_LINK_FILE</span><span class="p">,</span>
        <span class="n">nodes_file</span><span class="o">=</span><span class="n">STPAUL_NODE_FILE</span><span class="p">,</span>
        <span class="n">shapes_file</span><span class="o">=</span><span class="n">STPAUL_SHAPE_FILE</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;transit_net&quot;</span><span class="p">:</span> <span class="n">load_transit</span><span class="p">(</span><span class="n">STPAUL_DIR</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># create a future baseline scenario from base by searching for all cards in dir w/ baseline tag</span>
<span class="n">project_card_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STPAUL_DIR</span><span class="p">,</span> <span class="s2">&quot;project_cards&quot;</span><span class="p">)</span>
<span class="n">my_scenario</span> <span class="o">=</span> <span class="n">create_scenario</span><span class="p">(</span>
    <span class="n">base_scenario</span><span class="o">=</span><span class="n">my_base_year_scenario</span><span class="p">,</span>
    <span class="n">card_search_dir</span><span class="o">=</span><span class="n">project_card_directory</span><span class="p">,</span>
    <span class="n">filter_tags</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;baseline2050&quot;</span> <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># check project card queue and then apply the projects</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">queued_projects</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">apply_all_projects</span><span class="p">()</span>

<span class="c1"># check applied projects, write it out, and create a summary report.</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">applied_projects</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;baseline&quot;</span><span class="p">)</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;baseline2050summary.txt&quot;</span><span class="p">)</span>

<span class="c1"># Add some projects to create a build scenario based on a list of files.</span>
<span class="n">build_card_filenames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;3_multiple_roadway_attribute_change.yml&quot;</span><span class="p">,</span>
    <span class="s2">&quot;road.prop_changes.segment.yml&quot;</span><span class="p">,</span>
    <span class="s2">&quot;4_simple_managed_lane.yml&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">add_projects_from_files</span><span class="p">(</span><span class="n">build_card_filenames</span><span class="p">)</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;build2050&quot;</span><span class="p">)</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;build2050summary.txt&quot;</span><span class="p">)</span>
</code></pre></div>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.scenario.ProjectCardError" class="doc doc-heading">
            <code>ProjectCardError</code>


<a href="#network_wrangler.scenario.ProjectCardError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when a project card is not valid.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ProjectCardError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a project card is not valid.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.scenario.Scenario" class="doc doc-heading">
            <code>Scenario</code>


<a href="#network_wrangler.scenario.Scenario" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>object</code></p>


      <p>Holds information about a scenario.</p>
<p>Typical usage example:</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">my_base_year_scenario</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;road_net&quot;</span><span class="p">:</span> <span class="n">load_roadway</span><span class="p">(</span>
        <span class="n">links_file</span><span class="o">=</span><span class="n">STPAUL_LINK_FILE</span><span class="p">,</span>
        <span class="n">nodes_file</span><span class="o">=</span><span class="n">STPAUL_NODE_FILE</span><span class="p">,</span>
        <span class="n">shapes_file</span><span class="o">=</span><span class="n">STPAUL_SHAPE_FILE</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;transit_net&quot;</span><span class="p">:</span> <span class="n">load_transit</span><span class="p">(</span><span class="n">STPAUL_DIR</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># create a future baseline scenario from base by searching for all cards in dir w/ baseline tag</span>
<span class="n">project_card_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">STPAUL_DIR</span><span class="p">,</span> <span class="s2">&quot;project_cards&quot;</span><span class="p">)</span>
<span class="n">my_scenario</span> <span class="o">=</span> <span class="n">create_scenario</span><span class="p">(</span>
    <span class="n">base_scenario</span><span class="o">=</span><span class="n">my_base_year_scenario</span><span class="p">,</span>
    <span class="n">card_search_dir</span><span class="o">=</span><span class="n">project_card_directory</span><span class="p">,</span>
    <span class="n">filter_tags</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;baseline2050&quot;</span> <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># check project card queue and then apply the projects</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">queued_projects</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">apply_all_projects</span><span class="p">()</span>

<span class="c1"># check applied projects, write it out, and create a summary report.</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">applied_projects</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;baseline&quot;</span><span class="p">)</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;baseline2050summary.txt&quot;</span><span class="p">)</span>

<span class="c1"># Add some projects to create a build scenario based on a list of files.</span>
<span class="n">build_card_filenames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;3_multiple_roadway_attribute_change.yml&quot;</span><span class="p">,</span>
    <span class="s2">&quot;road.prop_changes.segment.yml&quot;</span><span class="p">,</span>
    <span class="s2">&quot;4_simple_managed_lane.yml&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">add_projects_from_files</span><span class="p">(</span><span class="n">build_card_filenames</span><span class="p">)</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;build2050&quot;</span><span class="p">)</span>
<span class="n">my_scenario</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&quot;build2050summary.txt&quot;</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.base_scenario">base_scenario</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary representation of a scenario</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.road_net">road_net</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="network_wrangler.roadway.network.RoadwayNetwork" href="#network_wrangler.roadway.network.RoadwayNetwork">RoadwayNetwork</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>instance of RoadwayNetwork for the scenario</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.transit_net">transit_net</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="network_wrangler.transit.network.TransitNetwork" href="#network_wrangler.transit.network.TransitNetwork">TransitNetwork</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>instance of TransitNetwork for the scenario</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.project_cards">project_cards</span></code></td>
            <td>
                  <code>dict[str, <span title="projectcard.ProjectCard">ProjectCard</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping[ProjectCard.name,ProjectCard] Storage of all project cards by name.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.scenario.Scenario.queued_projects" href="#network_wrangler.scenario.Scenario.queued_projects">queued_projects</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Projects which are &ldquo;shovel ready&rdquo; - have had pre-requisits checked and
done any required re-ordering. Similar to a git staging, project cards aren&rsquo;t
recognized in this collecton once they are moved to applied.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.applied_projects">applied_projects</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of project names that have been applied</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.scenario.Scenario.projects" href="#network_wrangler.scenario.Scenario.projects">projects</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of all projects either planned, queued, or applied</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.prerequisites">prerequisites</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary storing prerequiste information</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.corequisites">corequisites</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary storing corequisite information</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.scenario.Scenario.conflicts">conflicts</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary storing conflict information</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Scenario</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Holds information about a scenario.</span>

<span class="sd">    Typical usage example:</span>

<span class="sd">    ```python</span>
<span class="sd">    my_base_year_scenario = {</span>
<span class="sd">        &quot;road_net&quot;: load_roadway(</span>
<span class="sd">            links_file=STPAUL_LINK_FILE,</span>
<span class="sd">            nodes_file=STPAUL_NODE_FILE,</span>
<span class="sd">            shapes_file=STPAUL_SHAPE_FILE,</span>
<span class="sd">        ),</span>
<span class="sd">        &quot;transit_net&quot;: load_transit(STPAUL_DIR),</span>
<span class="sd">    }</span>

<span class="sd">    # create a future baseline scenario from base by searching for all cards in dir w/ baseline tag</span>
<span class="sd">    project_card_directory = os.path.join(STPAUL_DIR, &quot;project_cards&quot;)</span>
<span class="sd">    my_scenario = create_scenario(</span>
<span class="sd">        base_scenario=my_base_year_scenario,</span>
<span class="sd">        card_search_dir=project_card_directory,</span>
<span class="sd">        filter_tags = [ &quot;baseline2050&quot; ]</span>
<span class="sd">    )</span>

<span class="sd">    # check project card queue and then apply the projects</span>
<span class="sd">    my_scenario.queued_projects</span>
<span class="sd">    my_scenario.apply_all_projects()</span>

<span class="sd">    # check applied projects, write it out, and create a summary report.</span>
<span class="sd">    my_scenario.applied_projects</span>
<span class="sd">    my_scenario.write(&quot;baseline&quot;)</span>
<span class="sd">    my_scenario.summarize(outfile = &quot;baseline2050summary.txt&quot;)</span>

<span class="sd">    # Add some projects to create a build scenario based on a list of files.</span>
<span class="sd">    build_card_filenames = [</span>
<span class="sd">        &quot;3_multiple_roadway_attribute_change.yml&quot;,</span>
<span class="sd">        &quot;road.prop_changes.segment.yml&quot;,</span>
<span class="sd">        &quot;4_simple_managed_lane.yml&quot;,</span>
<span class="sd">    ]</span>
<span class="sd">    my_scenario.add_projects_from_files(build_card_filenames)</span>
<span class="sd">    my_scenario.write(&quot;build2050&quot;)</span>
<span class="sd">    my_scenario.summarize(outfile = &quot;build2050summary.txt&quot;)</span>
<span class="sd">    ```</span>

<span class="sd">    Attributes:</span>
<span class="sd">        base_scenario: dictionary representation of a scenario</span>
<span class="sd">        road_net: instance of RoadwayNetwork for the scenario</span>
<span class="sd">        transit_net: instance of TransitNetwork for the scenario</span>
<span class="sd">        project_cards: Mapping[ProjectCard.name,ProjectCard] Storage of all project cards by name.</span>
<span class="sd">        queued_projects: Projects which are &quot;shovel ready&quot; - have had pre-requisits checked and</span>
<span class="sd">            done any required re-ordering. Similar to a git staging, project cards aren&#39;t</span>
<span class="sd">            recognized in this collecton once they are moved to applied.</span>
<span class="sd">        applied_projects: list of project names that have been applied</span>
<span class="sd">        projects: list of all projects either planned, queued, or applied</span>
<span class="sd">        prerequisites:  dictionary storing prerequiste information</span>
<span class="sd">        corequisites:  dictionary storing corequisite information</span>
<span class="sd">        conflicts: dictionary storing conflict information</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">base_scenario</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Scenario</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
        <span class="n">project_card_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">        base_scenario: A base scenario object to base this isntance off of, or a dict which</span>
<span class="sd">            describes the scenario attributes including applied projects and respective conflicts.</span>
<span class="sd">            `{&quot;applied_projects&quot;: [],&quot;conflicts&quot;:{...}}`</span>
<span class="sd">        project_card_list: Optional list of ProjectCard instances to add to planned projects.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        name: Optional name for the scenario.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating Scenario&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">project_card_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">project_card_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_scenario</span><span class="p">,</span> <span class="n">Scenario</span><span class="p">):</span>
            <span class="n">base_scenario</span> <span class="o">=</span> <span class="n">base_scenario</span><span class="o">.</span><span class="vm">__dict__</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">BASE_SCENARIO_SUGGESTED_PROPS</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Base_scenario doesn&#39;t contain </span><span class="si">{</span><span class="n">BASE_SCENARIO_SUGGESTED_PROPS</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span> <span class="o">=</span> <span class="n">base_scenario</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># if the base scenario had roadway or transit networks, use them as the basis.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RoadwayNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;road_net&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TransitNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;transit_net&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">project_cards</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProjectCard</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">applied_projects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;applied_projects&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prerequisites&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corequisites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;corequisites&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conflicts&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_card_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_project</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">projects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of all projects in the scenario: applied and planned.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">applied_projects</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">queued_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list version of _queued_projects queue.</span>

<span class="sd">        Queued projects are thos that have been planned, have all pre-requisites satisfied, and</span>
<span class="sd">        have been ordered based on pre-requisites.</span>

<span class="sd">        If no queued projects, will dynamically generate from planned projects based on</span>
<span class="sd">        pre-requisites and return the queue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_requirements_satisfied</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_projects</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the Scenario object.&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_dependencies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">dependencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add dependencies from a project card to relevant scenario variables.</span>

<span class="sd">        Updates existing &quot;prerequisites&quot;, &quot;corequisites&quot; and &quot;conflicts&quot;.</span>
<span class="sd">        Lowercases everything to enable string matching.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_name: name of project you are adding dependencies for.</span>
<span class="sd">            dependencies: Dictionary of depndencies by dependency type and list of associated</span>
<span class="sd">                projects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project_name</span> <span class="o">=</span> <span class="n">project_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">d</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dependencies</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">_dep</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">_dep</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2"> dependency table.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">project_name</span><span class="p">:</span> <span class="n">_dep</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">_add_project</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project_card</span><span class="p">:</span> <span class="n">ProjectCard</span><span class="p">,</span>
        <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">filter_tags</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a single ProjectCard instances to the Scenario.</span>

<span class="sd">        Checks that a project of same name is not already in scenario.</span>
<span class="sd">        If selected, will validate ProjectCard before adding.</span>
<span class="sd">        If provided, will only add ProjectCard if it matches at least one filter_tags.</span>

<span class="sd">        Resets scenario queued_projects.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_card (ProjectCard): ProjectCard instance to add to scenario.</span>
<span class="sd">            validate (bool, optional): If True, will validate the projectcard before</span>
<span class="sd">                being adding it to the scenario. Defaults to True.</span>
<span class="sd">            filter_tags (Collection[str], optional): If used, will only add the project card if</span>
<span class="sd">                its tags match one or more of these filter_tags. Defaults to []</span>
<span class="sd">                which means no tag-filtering will occur.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project_name</span> <span class="o">=</span> <span class="n">project_card</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">filter_tags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">filter_tags</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">project_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">projects</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ProjectCardError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Names not unique from existing scenario projects: </span><span class="si">{</span><span class="n">project_card</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">filter_tags</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">project_card</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">filter_tags</span><span class="p">)):</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Skipping </span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2"> - no overlapping tags with </span><span class="si">{</span><span class="n">filter_tags</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">project_card</span><span class="o">.</span><span class="n">valid</span>

        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2"> to scenario.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_cards</span><span class="p">[</span><span class="n">project_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">project_card</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_dependencies</span><span class="p">(</span><span class="n">project_name</span><span class="p">,</span> <span class="n">project_card</span><span class="o">.</span><span class="n">dependencies</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_project_cards</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project_card_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">],</span>
        <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">filter_tags</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a list of ProjectCard instances to the Scenario.</span>

<span class="sd">        Checks that a project of same name is not already in scenario.</span>
<span class="sd">        If selected, will validate ProjectCard before adding.</span>
<span class="sd">        If provided, will only add ProjectCard if it matches at least one filter_tags.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_card_list (Collection[ProjectCard]): List of ProjectCard instances to add to</span>
<span class="sd">                scenario.</span>
<span class="sd">            validate (bool, optional): If True, will require each ProjectCard is validated before</span>
<span class="sd">                being added to scenario. Defaults to True.</span>
<span class="sd">            filter_tags (Collection[str], optional): If used, will filter ProjectCard instances</span>
<span class="sd">                and only add those whose tags match one or more of these filter_tags.</span>
<span class="sd">                Defaults to [] - which means no tag-filtering will occur.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_card_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_project</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="n">filter_tags</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_projects_requirements_satisfied</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks all requirements are satisified to apply this specific set of projects.</span>

<span class="sd">        Including:</span>
<span class="sd">        1. has an associaed project card</span>
<span class="sd">        2. is in scenario&#39;s planned projects</span>
<span class="sd">        3. pre-requisites satisfied</span>
<span class="sd">        4. co-requisies satisfied by applied or co-applied projects</span>
<span class="sd">        5. no conflicing applied or co-applied projects</span>

<span class="sd">        Args:</span>
<span class="sd">            project_list: list of projects to check requirements for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_planned</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_have_project_cards</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_prerequisites</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_corequisites</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_conflicts</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_projects_planned</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_names</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks that a list of projects are in the scenario&#39;s planned projects.&quot;&quot;&quot;</span>
        <span class="n">_missing_ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_missing_ps</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Projects are not in planned projects: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">_missing_ps</span><span class="si">}</span><span class="s2">. Add them by </span><span class="se">\</span>
<span class="s2">                using add_project_cards(), add_projects_from_files(), or </span><span class="se">\</span>
<span class="s2">                add_projects_from_directory().&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_projects_have_project_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks that a list of projects has an associated project card in the scenario.&quot;&quot;&quot;</span>
        <span class="n">_missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_list</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_cards</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_missing</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Projects referenced which are missing project cards: </span><span class="si">{</span><span class="n">_missing</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_check_projects_prerequisites</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check a list of projects&#39; pre-requisites have been or will be applied to scenario.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">project_names</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="k">return</span>
        <span class="n">_prereqs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_names</span><span class="p">:</span>
            <span class="n">_prereqs</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">_projects_applied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">applied_projects</span> <span class="o">+</span> <span class="n">project_names</span>
        <span class="n">_missing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_prereqs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">_projects_applied</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">_missing</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;project_names: </span><span class="si">{</span><span class="n">project_names</span><span class="si">}</span><span class="se">\n</span><span class="s2">projects_have_or_will_be_applied: </span><span class="se">\</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">_projects_applied</span><span class="si">}</span><span class="se">\n</span><span class="s2">missing: </span><span class="si">{</span><span class="n">_missing</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ScenarioPrerequisiteError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">_missing</span><span class="p">)</span><span class="si">}</span><span class="s2"> pre-requisites: </span><span class="si">{</span><span class="n">_missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_projects_corequisites</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check a list of projects&#39; co-requisites have been or will be applied to scenario.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">project_names</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corequisites</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="k">return</span>
        <span class="n">_coreqs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_names</span><span class="p">:</span>
            <span class="n">_coreqs</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corequisites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">_projects_applied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">applied_projects</span> <span class="o">+</span> <span class="n">project_names</span>
        <span class="n">_missing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_coreqs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">_projects_applied</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">_missing</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;project_names: </span><span class="si">{</span><span class="n">project_names</span><span class="si">}</span><span class="se">\n</span><span class="s2">projects_have_or_will_be_applied: </span><span class="se">\</span>
<span class="s2">                    </span><span class="si">{</span><span class="n">_projects_applied</span><span class="si">}</span><span class="se">\n</span><span class="s2">missing: </span><span class="si">{</span><span class="n">_missing</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ScenarioCorequisiteError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">_missing</span><span class="p">)</span><span class="si">}</span><span class="s2"> corequisites: </span><span class="si">{</span><span class="n">_missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_projects_conflicts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks that list of projects&#39; conflicts have not been or will be applied to scenario.&quot;&quot;&quot;</span>
        <span class="c1"># WranglerLogger.debug(&quot;Checking Conflicts...&quot;)</span>
        <span class="n">projects_to_check</span> <span class="o">=</span> <span class="n">project_names</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">applied_projects</span>
        <span class="c1"># WranglerLogger.debug(f&quot;\nprojects_to_check:{projects_to_check}\nprojects_with_conflicts:{set(self.conflicts.keys())}&quot;)</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">projects_to_check</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="c1"># WranglerLogger.debug(&quot;Projects have no conflicts to check&quot;)</span>
            <span class="k">return</span>
        <span class="n">_conflicts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_names</span><span class="p">:</span>
            <span class="n">_conflicts</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">_conflict_problems</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">_conflicts</span> <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">projects_to_check</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">_conflict_problems</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Conflict Problems: </span><span class="se">\n</span><span class="si">{</span><span class="n">_conflict_problems</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">_conf_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">projects_to_check</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_conflict_problems</span><span class="p">))</span>
            <span class="p">}</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Problematic Conflicts: </span><span class="se">\n</span><span class="si">{</span><span class="n">_conf_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ScenarioConflictError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">_conflicts</span><span class="p">)</span><span class="si">}</span><span class="s2"> conflicts: </span><span class="si">{</span><span class="n">_conflict_problems</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">order_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">deque</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Orders a list of projects based on moving up pre-requisites into a deque.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_list: list of projects to order</span>

<span class="sd">        Returns: deque for applying projects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_have_project_cards</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>

        <span class="c1"># build prereq (adjacency) list for topological sort</span>
        <span class="n">adjacency_list</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">visited_list</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">:</span>
            <span class="n">visited_list</span><span class="p">[</span><span class="n">project</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">project</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">prereq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span><span class="p">[</span><span class="n">project</span><span class="p">]:</span>
                <span class="c1"># this will always be true, else would have been flagged in missing \</span>
                <span class="c1"># prerequsite check, but just in case</span>
                <span class="k">if</span> <span class="n">prereq</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">:</span>
                    <span class="n">adjacency_list</span><span class="p">[</span><span class="n">prereq</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[</span><span class="n">project</span><span class="p">]</span>

        <span class="c1"># sorted_project_names is topological sorted project card names (based on prerequsiite)</span>
        <span class="n">_ordered_projects</span> <span class="o">=</span> <span class="n">topological_sort</span><span class="p">(</span>
            <span class="n">adjacency_list</span><span class="o">=</span><span class="n">adjacency_list</span><span class="p">,</span> <span class="n">visited_list</span><span class="o">=</span><span class="n">visited_list</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">_ordered_projects</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">project_list</span><span class="p">):</span>
            <span class="n">_missing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">_ordered_projects</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project sort resulted in missing projects: </span><span class="si">{</span><span class="n">_missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">project_deque</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">_ordered_projects</span><span class="p">)</span>

        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ordered Projects: </span><span class="se">\n</span><span class="si">{</span><span class="n">project_deque</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">project_deque</span>

    <span class="k">def</span> <span class="nf">apply_all_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies all planned projects in the queue.&quot;&quot;&quot;</span>
        <span class="c1"># Call this to make sure projects are appropriately queued in hidden variable.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queued_projects</span>

        <span class="c1"># Use hidden variable.</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_project</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>

        <span class="c1"># set this so it will trigger re-queuing any more projects.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_apply_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies a specific change specified in a project card.</span>

<span class="sd">        Change type must be in at least one of:</span>
<span class="sd">        - ROADWAY_CATEGORIES</span>
<span class="sd">        - TRANSIT_CATEGORIES</span>

<span class="sd">        Args:</span>
<span class="sd">            change: a project card or subproject card</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="ow">in</span> <span class="n">ROADWAY_CARD_TYPES</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing Roadway Network&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="ow">in</span> <span class="n">TRANSIT_CARD_TYPES</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing Transit Network&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="ow">in</span> <span class="n">SECONDARY_TRANSIT_CARD_TYPES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TRANSIT_CARD_TYPES</span> <span class="o">+</span> <span class="n">ROADWAY_CARD_TYPES</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ProjectCardError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Project </span><span class="si">{</span><span class="n">change</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2">: Don&#39;t understand project cat: </span><span class="si">{</span><span class="n">change</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies project card to scenario.</span>

<span class="sd">        If a list of changes is specified in referenced project card, iterates through each change.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_name (str): name of project to be applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project_name</span> <span class="o">=</span> <span class="n">project_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying </span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2"> from file:</span><span class="se">\</span>
<span class="s2">                            </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_cards</span><span class="p">[</span><span class="n">project_name</span><span class="p">]</span><span class="o">.</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_cards</span><span class="p">[</span><span class="n">project_name</span><span class="p">]</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;types: </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">change_types</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type: </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
                <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- applying subproject: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">applied_projects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">apply_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies a specific list of projects from the planned project queue.</span>

<span class="sd">        Will order the list of projects based on pre-requisites.</span>

<span class="sd">        NOTE: does not check co-requisites b/c that isn&#39;t possible when applying a sin</span>

<span class="sd">        Args:</span>
<span class="sd">            project_list: List of projects to be applied. All need to be in the planned project</span>
<span class="sd">                queue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_requirements_satisfied</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>
        <span class="n">ordered_project_queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_projects</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">ordered_project_queue</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_project</span><span class="p">(</span><span class="n">ordered_project_queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>

        <span class="c1"># Set so that when called again it will retrigger queueing from planned projects.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_projects</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;_summary_.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to write scenario networks and scenario summary to.</span>
<span class="sd">            name: Name to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">:</span>
            <span class="n">write_roadway</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">:</span>
            <span class="n">write_transit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">summarize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_detail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A high level summary of the created scenario.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_detail: If True (default), will write out project card summaries.</span>
<span class="sd">            outfile: If specified, will write scenario summary to text file.</span>
<span class="sd">            mode: Outfile open mode. &#39;a&#39; to append &#39;w&#39; to overwrite.</span>

<span class="sd">        Returns:</span>
<span class="sd">            string of summary</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">scenario_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_detail</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.scenario.Scenario.projects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">projects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.scenario.Scenario.projects" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Returns a list of all projects in the scenario: applied and planned.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.scenario.Scenario.queued_projects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">queued_projects</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.scenario.Scenario.queued_projects" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Returns a list version of _queued_projects queue.</p>
<p>Queued projects are thos that have been planned, have all pre-requisites satisfied, and
have been ordered based on pre-requisites.</p>
<p>If no queued projects, will dynamically generate from planned projects based on
pre-requisites and return the queue.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">base_scenario</span><span class="p">,</span> <span class="n">project_card_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.Scenario.__init__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Constructor.</p>
      

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">base_scenario</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Scenario</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">project_card_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">    Args:</span>
<span class="sd">    base_scenario: A base scenario object to base this isntance off of, or a dict which</span>
<span class="sd">        describes the scenario attributes including applied projects and respective conflicts.</span>
<span class="sd">        `{&quot;applied_projects&quot;: [],&quot;conflicts&quot;:{...}}`</span>
<span class="sd">    project_card_list: Optional list of ProjectCard instances to add to planned projects.</span>
<span class="sd">        Defaults to None.</span>
<span class="sd">    name: Optional name for the scenario.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating Scenario&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">project_card_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">project_card_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">base_scenario</span><span class="p">,</span> <span class="n">Scenario</span><span class="p">):</span>
        <span class="n">base_scenario</span> <span class="o">=</span> <span class="n">base_scenario</span><span class="o">.</span><span class="vm">__dict__</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">BASE_SCENARIO_SUGGESTED_PROPS</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Base_scenario doesn&#39;t contain </span><span class="si">{</span><span class="n">BASE_SCENARIO_SUGGESTED_PROPS</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span> <span class="o">=</span> <span class="n">base_scenario</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="c1"># if the base scenario had roadway or transit networks, use them as the basis.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RoadwayNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;road_net&quot;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TransitNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;transit_net&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">project_cards</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProjectCard</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_planned_projects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">applied_projects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;applied_projects&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prerequisites&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">corequisites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;corequisites&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conflicts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_scenario</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conflicts&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_card_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_project</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#network_wrangler.scenario.Scenario.__str__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>String representation of the Scenario object.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;String representation of the Scenario object.&quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.add_project_cards" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_project_cards</span><span class="p">(</span><span class="n">project_card_list</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#network_wrangler.scenario.Scenario.add_project_cards" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Adds a list of ProjectCard instances to the Scenario.</p>
<p>Checks that a project of same name is not already in scenario.
If selected, will validate ProjectCard before adding.
If provided, will only add ProjectCard if it matches at least one filter_tags.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>project_card_list</code></td>
            <td>
                  <code><span title="typing.Collection">Collection</span>[<span title="projectcard.ProjectCard">ProjectCard</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of ProjectCard instances to add to
scenario.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>validate</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will require each ProjectCard is validated before
being added to scenario. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>filter_tags</code></td>
            <td>
                  <code><span title="typing.Collection">Collection</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If used, will filter ProjectCard instances
and only add those whose tags match one or more of these filter_tags.
Defaults to [] - which means no tag-filtering will occur.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_project_cards</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">project_card_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">],</span>
    <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a list of ProjectCard instances to the Scenario.</span>

<span class="sd">    Checks that a project of same name is not already in scenario.</span>
<span class="sd">    If selected, will validate ProjectCard before adding.</span>
<span class="sd">    If provided, will only add ProjectCard if it matches at least one filter_tags.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_card_list (Collection[ProjectCard]): List of ProjectCard instances to add to</span>
<span class="sd">            scenario.</span>
<span class="sd">        validate (bool, optional): If True, will require each ProjectCard is validated before</span>
<span class="sd">            being added to scenario. Defaults to True.</span>
<span class="sd">        filter_tags (Collection[str], optional): If used, will filter ProjectCard instances</span>
<span class="sd">            and only add those whose tags match one or more of these filter_tags.</span>
<span class="sd">            Defaults to [] - which means no tag-filtering will occur.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_card_list</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_project</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="n">filter_tags</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.apply_all_projects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_all_projects</span><span class="p">()</span></code>

<a href="#network_wrangler.scenario.Scenario.apply_all_projects" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Applies all planned projects in the queue.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_all_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies all planned projects in the queue.&quot;&quot;&quot;</span>
    <span class="c1"># Call this to make sure projects are appropriately queued in hidden variable.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">queued_projects</span>

    <span class="c1"># Use hidden variable.</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_project</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>

    <span class="c1"># set this so it will trigger re-queuing any more projects.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_queued_projects</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.apply_projects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_projects</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.Scenario.apply_projects" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Applies a specific list of projects from the planned project queue.</p>
<p>Will order the list of projects based on pre-requisites.</p>
<p>NOTE: does not check co-requisites b/c that isn&rsquo;t possible when applying a sin</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>project_list</code></td>
            <td>
                  <code><span title="typing.Collection">Collection</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of projects to be applied. All need to be in the planned project
queue.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies a specific list of projects from the planned project queue.</span>

<span class="sd">    Will order the list of projects based on pre-requisites.</span>

<span class="sd">    NOTE: does not check co-requisites b/c that isn&#39;t possible when applying a sin</span>

<span class="sd">    Args:</span>
<span class="sd">        project_list: List of projects to be applied. All need to be in the planned project</span>
<span class="sd">            queue.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_requirements_satisfied</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>
    <span class="n">ordered_project_queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order_projects</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">ordered_project_queue</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_project</span><span class="p">(</span><span class="n">ordered_project_queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>

    <span class="c1"># Set so that when called again it will retrigger queueing from planned projects.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_projects</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.order_projects" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">order_projects</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.Scenario.order_projects" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Orders a list of projects based on moving up pre-requisites into a deque.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>project_list</code></td>
            <td>
                  <code><span title="typing.Collection">Collection</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of projects to order</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
      

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">order_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_list</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">deque</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Orders a list of projects based on moving up pre-requisites into a deque.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_list: list of projects to order</span>

<span class="sd">    Returns: deque for applying projects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">project_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">]</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_projects_have_project_cards</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span>

    <span class="c1"># build prereq (adjacency) list for topological sort</span>
    <span class="n">adjacency_list</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">visited_list</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">:</span>
        <span class="n">visited_list</span><span class="p">[</span><span class="n">project</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">project</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">prereq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prerequisites</span><span class="p">[</span><span class="n">project</span><span class="p">]:</span>
            <span class="c1"># this will always be true, else would have been flagged in missing \</span>
            <span class="c1"># prerequsite check, but just in case</span>
            <span class="k">if</span> <span class="n">prereq</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">:</span>
                <span class="n">adjacency_list</span><span class="p">[</span><span class="n">prereq</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[</span><span class="n">project</span><span class="p">]</span>

    <span class="c1"># sorted_project_names is topological sorted project card names (based on prerequsiite)</span>
    <span class="n">_ordered_projects</span> <span class="o">=</span> <span class="n">topological_sort</span><span class="p">(</span>
        <span class="n">adjacency_list</span><span class="o">=</span><span class="n">adjacency_list</span><span class="p">,</span> <span class="n">visited_list</span><span class="o">=</span><span class="n">visited_list</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">_ordered_projects</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">project_list</span><span class="p">):</span>
        <span class="n">_missing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">project_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">_ordered_projects</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project sort resulted in missing projects: </span><span class="si">{</span><span class="n">_missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">project_deque</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">_ordered_projects</span><span class="p">)</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ordered Projects: </span><span class="se">\n</span><span class="si">{</span><span class="n">project_deque</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">project_deque</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.summarize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summarize</span><span class="p">(</span><span class="n">project_detail</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.Scenario.summarize" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>A high level summary of the created scenario.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>project_detail</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (default), will write out project card summaries.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>outfile</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If specified, will write scenario summary to text file.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>mode</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Outfile open mode. &lsquo;a&rsquo; to append &lsquo;w&rsquo; to overwrite.</p>
              </div>
            </td>
            <td>
                  <code>&#39;a&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>string of summary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summarize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_detail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A high level summary of the created scenario.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_detail: If True (default), will write out project card summaries.</span>
<span class="sd">        outfile: If specified, will write scenario summary to text file.</span>
<span class="sd">        mode: Outfile open mode. &#39;a&#39; to append &#39;w&#39; to overwrite.</span>

<span class="sd">    Returns:</span>
<span class="sd">        string of summary</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">scenario_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_detail</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.scenario.Scenario.write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.Scenario.write" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p><em>summary</em>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>path</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to write scenario networks and scenario summary to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name to use.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to write scenario networks and scenario summary to.</span>
<span class="sd">        name: Name to use.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">:</span>
        <span class="n">write_roadway</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">:</span>
        <span class="n">write_transit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transit_net</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">summarize</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.scenario.ScenarioConflictError" class="doc doc-heading">
            <code>ScenarioConflictError</code>


<a href="#network_wrangler.scenario.ScenarioConflictError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when a conflict is detected.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ScenarioConflictError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a conflict is detected.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.scenario.ScenarioCorequisiteError" class="doc doc-heading">
            <code>ScenarioCorequisiteError</code>


<a href="#network_wrangler.scenario.ScenarioCorequisiteError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when a co-requisite is not satisfied.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ScenarioCorequisiteError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a co-requisite is not satisfied.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.scenario.ScenarioPrerequisiteError" class="doc doc-heading">
            <code>ScenarioPrerequisiteError</code>


<a href="#network_wrangler.scenario.ScenarioPrerequisiteError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when a pre-requisite is not satisfied.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ScenarioPrerequisiteError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a pre-requisite is not satisfied.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="network_wrangler.scenario.build_scenario_from_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_scenario_from_config</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.build_scenario_from_config" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Builds a scenario from a dictionary configuration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config_dict</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary configuration of scenario.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_scenario_from_config</span><span class="p">(</span><span class="n">config_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds a scenario from a dictionary configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_dict: dictionary configuration of scenario.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Building Scenario from Configuration&quot;</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;{pprint.pformat(config_dict)}&quot;</span><span class="p">)</span>

    <span class="n">base_network_dir</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;base_network&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;input_dir&quot;</span><span class="p">)</span>
    <span class="n">base_shape_name</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;base_network&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;shape_file_name&quot;</span><span class="p">)</span>
    <span class="n">base_link_name</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;base_network&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;link_file_name&quot;</span><span class="p">)</span>
    <span class="n">base_node_name</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;base_network&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;node_file_name&quot;</span><span class="p">)</span>

    <span class="n">project_card_filepath</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scenario&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;project_card_filepath&quot;</span><span class="p">)</span>
    <span class="n">project_tags</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scenario&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">)</span>

    <span class="n">write_out</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scenario&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;write_out&quot;</span><span class="p">)</span>
    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scenario&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_dir&quot;</span><span class="p">)</span>
    <span class="n">out_prefix</span> <span class="o">=</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scenario&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;out_prefix&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">project_tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">project_tags</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">project_card_filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">project_card_filepath</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Create Base Network</span>
    <span class="n">base_scenario</span> <span class="o">=</span> <span class="n">create_base_scenario</span><span class="p">(</span>
        <span class="n">roadway_dir</span><span class="o">=</span><span class="n">base_network_dir</span><span class="p">,</span>
        <span class="n">base_shape_name</span><span class="o">=</span><span class="n">base_shape_name</span><span class="p">,</span>
        <span class="n">base_link_name</span><span class="o">=</span><span class="n">base_link_name</span><span class="p">,</span>
        <span class="n">base_node_name</span><span class="o">=</span><span class="n">base_node_name</span><span class="p">,</span>
        <span class="n">transit_dir</span><span class="o">=</span><span class="n">base_network_dir</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">my_scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="o">.</span><span class="n">create_scenario</span><span class="p">(</span>
        <span class="n">base_scenario</span><span class="o">=</span><span class="n">base_scenario</span><span class="p">,</span>
        <span class="n">project_card_filepath</span><span class="o">=</span><span class="n">project_card_filepath</span><span class="p">,</span>
        <span class="n">filter_tags</span><span class="o">=</span><span class="n">project_tags</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Applying these projects to the base scenario ...&quot;</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">my_scenario</span><span class="o">.</span><span class="n">projects</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

    <span class="n">my_scenario</span><span class="o">.</span><span class="n">apply_all_projects</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">write_out</span><span class="p">:</span>
        <span class="n">write_roadway</span><span class="p">(</span><span class="n">my_scenario</span><span class="o">.</span><span class="n">road_net</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">out_prefix</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="n">out_dir</span><span class="p">)</span>
        <span class="n">my_scenario</span><span class="o">.</span><span class="n">transit_net</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">out_prefix</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">out_dir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.scenario.build_scenario_from_config_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_scenario_from_config_file</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.build_scenario_from_config_file" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Builds a scenario from a yaml configuration file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config_file</code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the yaml configuration file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_scenario_from_config_file</span><span class="p">(</span><span class="n">config_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds a scenario from a yaml configuration file.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_file: Path to the yaml configuration file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Specified config file does not exist - </span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">config</span><span class="p">:</span>
        <span class="n">config_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Building Scenario from </span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">build_scenario_from_config</span><span class="p">(</span><span class="n">config_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.scenario.create_base_scenario" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_base_scenario</span><span class="p">(</span><span class="n">base_shape_name</span><span class="p">,</span> <span class="n">base_link_name</span><span class="p">,</span> <span class="n">base_node_name</span><span class="p">,</span> <span class="n">roadway_dir</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">transit_dir</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.create_base_scenario" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Creates a base scenario dictionary from roadway and transit network files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>base_shape_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename of the base network shape</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>base_link_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename of the base network link</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>base_node_name</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename of the base network node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>roadway_dir</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional path to the base scenario roadway network files</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>transit_dir</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional path to base scenario transit files</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_base_scenario</span><span class="p">(</span>
    <span class="n">base_shape_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">base_link_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">base_node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">roadway_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">transit_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a base scenario dictionary from roadway and transit network files.</span>

<span class="sd">    Args:</span>
<span class="sd">        base_shape_name: filename of the base network shape</span>
<span class="sd">        base_link_name: filename of the base network link</span>
<span class="sd">        base_node_name: filename of the base network node</span>
<span class="sd">        roadway_dir: optional path to the base scenario roadway network files</span>
<span class="sd">        transit_dir: optional path to base scenario transit files</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">roadway_dir</span><span class="p">:</span>
        <span class="n">base_network_shape_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">roadway_dir</span><span class="p">,</span> <span class="n">base_shape_name</span><span class="p">)</span>
        <span class="n">base_network_link_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">roadway_dir</span><span class="p">,</span> <span class="n">base_link_name</span><span class="p">)</span>
        <span class="n">base_network_node_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">roadway_dir</span><span class="p">,</span> <span class="n">base_node_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_network_shape_file</span> <span class="o">=</span> <span class="n">base_shape_name</span>
        <span class="n">base_network_link_file</span> <span class="o">=</span> <span class="n">base_link_name</span>
        <span class="n">base_network_node_file</span> <span class="o">=</span> <span class="n">base_node_name</span>

    <span class="n">road_net</span> <span class="o">=</span> <span class="n">load_roadway</span><span class="p">(</span>
        <span class="n">links_file</span><span class="o">=</span><span class="n">base_network_link_file</span><span class="p">,</span>
        <span class="n">nodes_file</span><span class="o">=</span><span class="n">base_network_node_file</span><span class="p">,</span>
        <span class="n">shapes_file</span><span class="o">=</span><span class="n">base_network_shape_file</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">transit_dir</span><span class="p">:</span>
        <span class="n">transit_net</span> <span class="o">=</span> <span class="n">load_transit</span><span class="p">(</span><span class="n">transit_dir</span><span class="p">)</span>
        <span class="n">transit_net</span><span class="o">.</span><span class="n">road_net</span> <span class="o">=</span> <span class="n">road_net</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">transit_net</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;No transit directory specified, base scenario will have empty transit network.&quot;</span>
        <span class="p">)</span>

    <span class="n">base_scenario</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;road_net&quot;</span><span class="p">:</span> <span class="n">road_net</span><span class="p">,</span> <span class="s2">&quot;transit_net&quot;</span><span class="p">:</span> <span class="n">transit_net</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">base_scenario</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.scenario.create_scenario" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_scenario</span><span class="p">(</span><span class="n">base_scenario</span><span class="o">=</span><span class="p">{},</span> <span class="n">project_card_list</span><span class="o">=</span><span class="p">[],</span> <span class="n">project_card_filepath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="p">[],</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.create_scenario" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Creates scenario from a base scenario and adds project cards.</p>
<p>Project cards can be added using any/all of the following methods:
1. List of ProjectCard instances
2. List of ProjectCard files
3. Directory and optional glob search to find project card files in</p>
<p>Checks that a project of same name is not already in scenario.
If selected, will validate ProjectCard before adding.
If provided, will only add ProjectCard if it matches at least one filter_tags.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>base_scenario</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="network_wrangler.scenario.Scenario" href="#network_wrangler.scenario.Scenario">Scenario</a>, dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>base Scenario scenario instances of dictionary of attributes.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>project_card_list</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of ProjectCard instances to create Scenario from. Defaults
to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>project_card_filepath</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.Collection">Collection</span>[str], str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>where the project card is.  A single path, list of paths,</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>filter_tags</code></td>
            <td>
                  <code><span title="typing.Collection">Collection</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If used, will only add the project card if
its tags match one or more of these filter_tags. Defaults to []
which means no tag-filtering will occur.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>validate</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will validate the projectcard before
being adding it to the scenario. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_scenario</span><span class="p">(</span>
    <span class="n">base_scenario</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Scenario</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">project_card_list</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">project_card_filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filter_tags</span><span class="p">:</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Scenario</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates scenario from a base scenario and adds project cards.</span>

<span class="sd">    Project cards can be added using any/all of the following methods:</span>
<span class="sd">    1. List of ProjectCard instances</span>
<span class="sd">    2. List of ProjectCard files</span>
<span class="sd">    3. Directory and optional glob search to find project card files in</span>

<span class="sd">    Checks that a project of same name is not already in scenario.</span>
<span class="sd">    If selected, will validate ProjectCard before adding.</span>
<span class="sd">    If provided, will only add ProjectCard if it matches at least one filter_tags.</span>

<span class="sd">    Args:</span>
<span class="sd">        base_scenario: base Scenario scenario instances of dictionary of attributes.</span>
<span class="sd">        project_card_list: List of ProjectCard instances to create Scenario from. Defaults</span>
<span class="sd">            to [].</span>
<span class="sd">        project_card_filepath: where the project card is.  A single path, list of paths,</span>
<span class="sd">        a directory, or a glob pattern. Defaults to None.</span>
<span class="sd">        filter_tags (Collection[str], optional): If used, will only add the project card if</span>
<span class="sd">            its tags match one or more of these filter_tags. Defaults to []</span>
<span class="sd">            which means no tag-filtering will occur.</span>
<span class="sd">        validate (bool, optional): If True, will validate the projectcard before</span>
<span class="sd">            being adding it to the scenario. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scenario</span> <span class="o">=</span> <span class="n">Scenario</span><span class="p">(</span><span class="n">base_scenario</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">project_card_filepath</span><span class="p">:</span>
        <span class="n">project_card_list</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">read_cards</span><span class="p">(</span><span class="n">project_card_filepath</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="n">filter_tags</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">project_card_list</span><span class="p">:</span>
        <span class="n">scenario</span><span class="o">.</span><span class="n">add_project_cards</span><span class="p">(</span><span class="n">project_card_list</span><span class="p">,</span> <span class="n">filter_tags</span><span class="o">=</span><span class="n">filter_tags</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scenario</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.scenario.scenario_summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scenario_summary</span><span class="p">(</span><span class="n">scenario</span><span class="p">,</span> <span class="n">project_detail</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.scenario.scenario_summary" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>A high level summary of the created scenario.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>scenario</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.scenario.Scenario" href="#network_wrangler.scenario.Scenario">Scenario</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scenario instance to summarize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>project_detail</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (default), will write out project card summaries.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>outfile</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If specified, will write scenario summary to text file.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>mode</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Outfile open mode. &lsquo;a&rsquo; to append &lsquo;w&rsquo; to overwrite.</p>
              </div>
            </td>
            <td>
                  <code>&#39;a&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>string of summary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/scenario.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">scenario_summary</span><span class="p">(</span>
    <span class="n">scenario</span><span class="p">:</span> <span class="n">Scenario</span><span class="p">,</span> <span class="n">project_detail</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">outfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A high level summary of the created scenario.</span>

<span class="sd">    Args:</span>
<span class="sd">        scenario: Scenario instance to summarize.</span>
<span class="sd">        project_detail: If True (default), will write out project card summaries.</span>
<span class="sd">        outfile: If specified, will write scenario summary to text file.</span>
<span class="sd">        mode: Outfile open mode. &#39;a&#39; to append &#39;w&#39; to overwrite.</span>

<span class="sd">    Returns:</span>
<span class="sd">        string of summary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Summarizing Scenario </span><span class="si">{</span><span class="n">scenario</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">report_str</span> <span class="o">=</span> <span class="s2">&quot;------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Scenario created on </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;Base Scenario:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;--Road Network:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;----Link File: </span><span class="si">{</span><span class="n">scenario</span><span class="o">.</span><span class="n">base_scenario</span><span class="p">[</span><span class="s1">&#39;road_net&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">_links_file</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;----Node File: </span><span class="si">{</span><span class="n">scenario</span><span class="o">.</span><span class="n">base_scenario</span><span class="p">[</span><span class="s1">&#39;road_net&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">_nodes_file</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;----Shape File: </span><span class="si">{</span><span class="n">scenario</span><span class="o">.</span><span class="n">base_scenario</span><span class="p">[</span><span class="s1">&#39;road_net&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">_shapes_file</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;--Transit Network:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;----Feed Path: </span><span class="si">{</span><span class="n">scenario</span><span class="o">.</span><span class="n">base_scenario</span><span class="p">[</span><span class="s1">&#39;transit_net&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">feed_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Project Cards:</span><span class="se">\n</span><span class="s2"> -&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="n">scenario</span><span class="o">.</span><span class="n">project_cards</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

    <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Applied Projects:</span><span class="se">\n</span><span class="s2">-&quot;</span>
    <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">applied_projects</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">project_detail</span><span class="p">:</span>
        <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---Project Card Details---</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">scenario</span><span class="o">.</span><span class="n">project_cards</span><span class="p">:</span>
            <span class="n">report_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pprint</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">scenario</span><span class="o">.</span><span class="n">project_cards</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">scenario</span><span class="o">.</span><span class="n">applied_projects</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">report_str</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrote Scenario Report to: </span><span class="si">{</span><span class="n">outfile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">report_str</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.roadway.network"></a>
    <div class="doc doc-contents first">

      <p>Roadway Network class and functions for Network Wrangler.</p>
<p>Used to represent a roadway network and perform operations on it.</p>
<p>Usage:</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">network_wrangler</span> <span class="kn">import</span> <span class="n">load_roadway_from_dir</span><span class="p">,</span> <span class="n">write_roadway</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">load_roadway_from_dir</span><span class="p">(</span><span class="s2">&quot;my_dir&quot;</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">get_selection</span><span class="p">({</span><span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;I 35E&quot;</span><span class="p">]}]})</span>
<span class="n">net</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;my_project_card.yml&quot;</span><span class="p">)</span>

<span class="n">write_roadway</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="s2">&quot;my_out_prefix&quot;</span><span class="p">,</span> <span class="s2">&quot;my_dir&quot;</span><span class="p">,</span> <span class="n">file_format</span> <span class="o">=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">)</span>
</code></pre></div>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.roadway.network.RoadwayNetwork" class="doc doc-heading">
            <code>RoadwayNetwork</code>


<a href="#network_wrangler.roadway.network.RoadwayNetwork" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


      <p>Representation of a Roadway Network.</p>
<p>Typical usage example:</p>
<div class="language-py highlight"><pre><span></span><code><span class="n">net</span> <span class="o">=</span> <span class="n">load_roadway</span><span class="p">(</span>
    <span class="n">links_file</span><span class="o">=</span><span class="n">MY_LINK_FILE</span><span class="p">,</span>
    <span class="n">nodes_file</span><span class="o">=</span><span class="n">MY_NODE_FILE</span><span class="p">,</span>
    <span class="n">shapes_file</span><span class="o">=</span><span class="n">MY_SHAPE_FILE</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">my_selection</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;I 35E&quot;</span><span class="p">]}],</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;osm_node_id&quot;</span><span class="p">:</span> <span class="s2">&quot;961117623&quot;</span><span class="p">},</span>  <span class="c1"># start searching for segments at A</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;osm_node_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2564047368&quot;</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">net</span><span class="o">.</span><span class="n">get_selection</span><span class="p">(</span><span class="n">my_selection</span><span class="p">)</span>

<span class="n">my_change</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;property&#39;</span><span class="p">:</span> <span class="s1">&#39;lanes&#39;</span><span class="p">,</span>
        <span class="s1">&#39;existing&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;set&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;property&#39;</span><span class="p">:</span> <span class="s1">&#39;drive_access&#39;</span><span class="p">,</span>
        <span class="s1">&#39;set&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">]</span>

<span class="n">my_net</span><span class="o">.</span><span class="n">apply_roadway_feature_change</span><span class="p">(</span>
    <span class="n">my_net</span><span class="o">.</span><span class="n">get_selection</span><span class="p">(</span><span class="n">my_selection</span><span class="p">),</span>
    <span class="n">my_change</span>
<span class="p">)</span>

    <span class="n">net</span><span class="o">.</span><span class="n">model_net</span>
    <span class="n">net</span><span class="o">.</span><span class="n">is_network_connected</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;drive&quot;</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nodes_df</span><span class="p">,</span> <span class="n">links</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">m_links_df</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">disconnected_nodes</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">assess_connectivity</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;walk&quot;</span><span class="p">,</span>
        <span class="n">ignore_end_nodes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">m_nodes_df</span><span class="p">,</span>
        <span class="n">links</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">m_links_df</span>
    <span class="p">)</span>
    <span class="n">write_roadway</span><span class="p">(</span><span class="n">net</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">my_out_prefix</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">my_dir</span><span class="p">,</span> <span class="n">for_model</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.roadway.network.RoadwayNetwork.nodes_df">nodes_df</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadNodesTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadNodesTable">RoadNodesTable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe of of node records.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.roadway.network.RoadwayNetwork.links_df">links_df</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadLinksTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadLinksTable">RoadLinksTable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe of link records and associated properties.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.roadway.network.RoadwayNetwork.shapes_df" href="#network_wrangler.roadway.network.RoadwayNetwork.shapes_df">shapes_df</a></code></td>
            <td>
                  <code>RoadShapestable</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>data from of detailed shape records  This is lazily
created iff it is called because shapes files can be expensive to read.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.roadway.network.RoadwayNetwork.selections">selections</span></code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary of stored roadway selection objects, mapped by
<code>RoadwayLinkSelection.sel_key</code> or <code>RoadwayNodeSelection.sel_key</code> in case they are
    made repeatedly.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.roadway.network.RoadwayNetwork.crs">crs</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate reference system in ESPG number format. Defaults to DEFAULT_CRS
which is set to 4326, WGS 84 Lat/Long</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.roadway.network.RoadwayNetwork.network_hash" href="#network_wrangler.roadway.network.RoadwayNetwork.network_hash">network_hash</a></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dynamic property of the hashed value of links_df and nodes_df. Used for
quickly identifying if a network has changed since various expensive operations have
taken place (i.e. generating a ModelRoadwayNetwork or a network graph)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.roadway.network.RoadwayNetwork.model_net" href="#network_wrangler.roadway.network.RoadwayNetwork.model_net">model_net</a></code></td>
            <td>
                  <code><span title="network_wrangler.roadway.model_roadway.ModelRoadwayNetwork">ModelRoadwayNetwork</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>referenced <code>ModelRoadwayNetwork</code> object which will be
lazily created if None or if the <code>network_hash</code> has changed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RoadwayNetwork</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of a Roadway Network.</span>

<span class="sd">    Typical usage example:</span>

<span class="sd">    ```py</span>
<span class="sd">    net = load_roadway(</span>
<span class="sd">        links_file=MY_LINK_FILE,</span>
<span class="sd">        nodes_file=MY_NODE_FILE,</span>
<span class="sd">        shapes_file=MY_SHAPE_FILE,</span>
<span class="sd">    )</span>
<span class="sd">    my_selection = {</span>
<span class="sd">        &quot;link&quot;: [{&quot;name&quot;: [&quot;I 35E&quot;]}],</span>
<span class="sd">        &quot;A&quot;: {&quot;osm_node_id&quot;: &quot;961117623&quot;},  # start searching for segments at A</span>
<span class="sd">        &quot;B&quot;: {&quot;osm_node_id&quot;: &quot;2564047368&quot;},</span>
<span class="sd">    }</span>
<span class="sd">    net.get_selection(my_selection)</span>

<span class="sd">    my_change = [</span>
<span class="sd">        {</span>
<span class="sd">            &#39;property&#39;: &#39;lanes&#39;,</span>
<span class="sd">            &#39;existing&#39;: 1,</span>
<span class="sd">            &#39;set&#39;: 2,</span>
<span class="sd">        },</span>
<span class="sd">        {</span>
<span class="sd">            &#39;property&#39;: &#39;drive_access&#39;,</span>
<span class="sd">            &#39;set&#39;: 0,</span>
<span class="sd">        },</span>
<span class="sd">    ]</span>

<span class="sd">    my_net.apply_roadway_feature_change(</span>
<span class="sd">        my_net.get_selection(my_selection),</span>
<span class="sd">        my_change</span>
<span class="sd">    )</span>

<span class="sd">        net.model_net</span>
<span class="sd">        net.is_network_connected(mode=&quot;drive&quot;, nodes=self.m_nodes_df, links=self.m_links_df)</span>
<span class="sd">        _, disconnected_nodes = net.assess_connectivity(</span>
<span class="sd">            mode=&quot;walk&quot;,</span>
<span class="sd">            ignore_end_nodes=True,</span>
<span class="sd">            nodes=self.m_nodes_df,</span>
<span class="sd">            links=self.m_links_df</span>
<span class="sd">        )</span>
<span class="sd">        write_roadway(net,filename=my_out_prefix, path=my_dir, for_model = True)</span>
<span class="sd">    ```</span>

<span class="sd">    Attributes:</span>
<span class="sd">        nodes_df (RoadNodesTable): dataframe of of node records.</span>
<span class="sd">        links_df (RoadLinksTable): dataframe of link records and associated properties.</span>
<span class="sd">        shapes_df (RoadShapestable): data from of detailed shape records  This is lazily</span>
<span class="sd">            created iff it is called because shapes files can be expensive to read.</span>
<span class="sd">        selections (dict): dictionary of stored roadway selection objects, mapped by</span>
<span class="sd">            `RoadwayLinkSelection.sel_key` or `RoadwayNodeSelection.sel_key` in case they are</span>
<span class="sd">                made repeatedly.</span>
<span class="sd">        crs (str): coordinate reference system in ESPG number format. Defaults to DEFAULT_CRS</span>
<span class="sd">            which is set to 4326, WGS 84 Lat/Long</span>
<span class="sd">        network_hash: dynamic property of the hashed value of links_df and nodes_df. Used for</span>
<span class="sd">            quickly identifying if a network has changed since various expensive operations have</span>
<span class="sd">            taken place (i.e. generating a ModelRoadwayNetwork or a network graph)</span>
<span class="sd">        model_net (ModelRoadwayNetwork): referenced `ModelRoadwayNetwork` object which will be</span>
<span class="sd">            lazily created if None or if the `network_hash` has changed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">crs</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">LAT_LON_CRS</span><span class="p">]</span> <span class="o">=</span> <span class="n">LAT_LON_CRS</span>
    <span class="n">nodes_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]</span>
    <span class="n">links_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]</span>
    <span class="n">_shapes_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadShapesTable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_links_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_nodes_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_shapes_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">_shapes_params</span><span class="p">:</span> <span class="n">ShapesParams</span> <span class="o">=</span> <span class="n">ShapesParams</span><span class="p">()</span>
    <span class="n">_model_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelRoadwayNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_selections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Selections</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">_modal_graphs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;graph&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;hash&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;nodes_df&quot;</span><span class="p">,</span> <span class="s2">&quot;links_df&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">coerce_crs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coerce crs of nodes_df and links_df to network crs.&quot;&quot;&quot;</span>
        <span class="n">net_crs</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">crs</span> <span class="o">!=</span> <span class="n">net_crs</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;CRS of links_df (</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">crs</span><span class="si">}</span><span class="s2">) doesn&#39;t match network crs </span><span class="si">{</span><span class="n">net_crs</span><span class="si">}</span><span class="s2">. </span><span class="se">\</span>
<span class="s2">                    Changing to network crs.&quot;</span>
            <span class="p">)</span>
            <span class="n">v</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">net_crs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shapes_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadShapesTable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load and return RoadShapesTable.</span>

<span class="sd">        If not already loaded, will read from shapes_file and return. If shapes_file is None,</span>
<span class="sd">        will return an empty dataframe with the right schema. If shapes_df is already set, will</span>
<span class="sd">        return that.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span><span class="o">.</span><span class="n">empty</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span> <span class="o">=</span> <span class="n">read_shapes</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_file</span><span class="p">,</span>
                <span class="n">in_crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                <span class="n">shapes_params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_shapes_params</span><span class="p">,</span>
                <span class="n">filter_to_shape_ids</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="o">.</span><span class="n">shape_id</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="c1"># if there is NONE, then at least create an empty dataframe with right schema</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span> <span class="o">=</span> <span class="n">empty_df_from_datamodel</span><span class="p">(</span><span class="n">RoadShapesTable</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;shape_id_idx&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span>

    <span class="nd">@shapes_df</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">shapes_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shapes_df</span> <span class="o">=</span> <span class="n">df_to_shapes_df</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">shapes_params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_shapes_params</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">network_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hash of the links and nodes dataframes.&quot;&quot;&quot;</span>
        <span class="n">_value</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="o">.</span><span class="n">df_hash</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">df_hash</span><span class="p">())</span>

        <span class="n">_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">_value</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">_hash</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model_net</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelRoadwayNetwork</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a ModelRoadwayNetwork object for this network.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_net</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_net</span><span class="o">.</span><span class="n">_net_hash</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_hash</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_model_net</span> <span class="o">=</span> <span class="n">ModelRoadwayNetwork</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_net</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Quick summary dictionary of number of links, nodes.&quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">),</span>
            <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">d</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">link_shapes_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add shape geometry to links if available.</span>

<span class="sd">        returns: shapes merged to nodes dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_links_df</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">)</span>
        <span class="n">link_shapes_df</span> <span class="o">=</span> <span class="n">_links_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">fk_to_shape</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">link_shapes_df</span>

    <span class="k">def</span> <span class="nf">get_property_by_timespan_and_group</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">link_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">category</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_CATEGORY</span><span class="p">,</span>
        <span class="n">timespan</span><span class="p">:</span> <span class="n">TimespanString</span> <span class="o">=</span> <span class="n">DEFAULT_TIMESPAN</span><span class="p">,</span>
        <span class="n">strict_timespan_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">min_overlap_minutes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a new dataframe with model_link_id and link property by category and timespan.</span>

<span class="sd">        Convenience method for backward compatability.</span>

<span class="sd">        Args:</span>
<span class="sd">            link_property: link property to query</span>
<span class="sd">            category: category to query or a list of categories. Defaults to DEFAULT_CATEGORY.</span>
<span class="sd">            timespan: timespan to query in the form of [&quot;HH:MM&quot;,&quot;HH:MM&quot;].</span>
<span class="sd">                Defaults to DEFAULT_TIMESPAN.</span>
<span class="sd">            strict_timespan_match: If True, will only return links that match the timespan exactly.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            min_overlap_minutes: If strict_timespan_match is False, will return links that overlap</span>
<span class="sd">                with the timespan by at least this many minutes. Defaults to 60.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.links.scopes</span> <span class="kn">import</span> <span class="n">prop_for_scope</span>

        <span class="k">return</span> <span class="n">prop_for_scope</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span>
            <span class="n">link_property</span><span class="p">,</span>
            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">strict_timespan_match</span><span class="o">=</span><span class="n">strict_timespan_match</span><span class="p">,</span>
            <span class="n">min_overlap_minutes</span><span class="o">=</span><span class="n">min_overlap_minutes</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_selection</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">selection_dict</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">SelectFacility</span><span class="p">],</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">RoadwayNodeSelection</span><span class="p">,</span> <span class="n">RoadwayLinkSelection</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return selection if it already exists, otherwise performs selection.</span>

<span class="sd">        Args:</span>
<span class="sd">            selection_dict (dict): SelectFacility dictionary.</span>
<span class="sd">            overwrite: if True, will overwrite any previously cached searches. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">_create_selection_key</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using cached selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectFacility</span><span class="p">):</span>
            <span class="n">selection_data</span> <span class="o">=</span> <span class="n">selection_dict</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectLinksDict</span><span class="p">):</span>
            <span class="n">selection_data</span> <span class="o">=</span> <span class="n">SelectFacility</span><span class="p">(</span><span class="n">links</span><span class="o">=</span><span class="n">selection_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectNodesDict</span><span class="p">):</span>
            <span class="n">selection_data</span> <span class="o">=</span> <span class="n">SelectFacility</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">selection_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">selection_data</span> <span class="o">=</span> <span class="n">SelectFacility</span><span class="p">(</span><span class="o">**</span><span class="n">selection_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`selection_dict` arg must be a dictionary or SelectFacility</span><span class="se">\</span>
<span class="s2">                              model. Received: </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">SelectionError</span><span class="p">(</span><span class="s2">&quot;selection_dict arg must be a dictionary or SelectFacility model&quot;</span><span class="p">)</span>

        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selection_data</span><span class="o">.</span><span class="n">feature_types</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">,</span> <span class="s2">&quot;segment&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">RoadwayLinkSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">selection_data</span><span class="o">.</span><span class="n">feature_types</span> <span class="o">==</span> <span class="s2">&quot;nodes&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">RoadwayNodeSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Selection data should be of type &#39;segment&#39;, &#39;links&#39; or &#39;nodes&#39;.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">SelectionError</span><span class="p">(</span><span class="s2">&quot;Selection data should be of type &#39;segment&#39;, &#39;links&#39; or &#39;nodes&#39;.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">modal_graph_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hash of the links in order to detect a network change from when graph created.&quot;&quot;&quot;</span>
        <span class="n">_value</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="o">.</span><span class="n">df_hash</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">mode</span><span class="p">)</span>
        <span class="n">_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">_value</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">_hash</span>

    <span class="k">def</span> <span class="nf">get_modal_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultiDiGraph</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a networkx graph of the network for a specific mode.</span>

<span class="sd">        Args:</span>
<span class="sd">            mode: mode of the network, one of `drive`,`transit`,`walk`, `bike`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.graph</span> <span class="kn">import</span> <span class="n">net_to_graph</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modal_graphs</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="s2">&quot;hash&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modal_graph_hash</span><span class="p">(</span><span class="n">mode</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_modal_graphs</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">net_to_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modal_graphs</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_card</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">,</span> <span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">RoadwayNetwork</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper method to apply a roadway project, returning a new RoadwayNetwork instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_card: either a dictionary of the project card object or ProjectCard instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">ProjectCard</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">)):</span>
            <span class="n">project_card</span> <span class="o">=</span> <span class="n">ProjectCard</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span>

        <span class="n">project_card</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
                <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- applying subproject: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">RoadwayNetwork</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a single change: a single-project project or a sub-project.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">change</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">):</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying Project to Roadway Network: </span><span class="si">{</span><span class="n">change</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;roadway_property_change&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_roadway_property_change</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">facility</span><span class="p">),</span>
                <span class="n">change</span><span class="o">.</span><span class="n">roadway_property_change</span><span class="p">[</span><span class="s2">&quot;property_changes&quot;</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;roadway_addition&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_new_roadway</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">change</span><span class="o">.</span><span class="n">roadway_addition</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;roadway_deletion&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_roadway_deletion</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">change</span><span class="o">.</span><span class="n">roadway_deletion</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;pycode&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_calculated_roadway</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="o">.</span><span class="n">pycode</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldn&#39;t find project in: </span><span class="se">\n</span><span class="si">{</span><span class="n">change</span><span class="o">.</span><span class="vm">__dict__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Project Card Category: </span><span class="si">{</span><span class="n">change</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">links_with_link_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return subset of links_df based on link_ids list.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">filter_links_to_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="n">link_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">links_with_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return subset of links_df based on node_ids list.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">filter_links_to_node_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="n">node_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">nodes_in_links</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns subset of self.nodes_df that are in self.links_df.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">filter_nodes_to_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_links_df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate combined links_df with LinksSchema before adding to self.links_df.</span>

<span class="sd">        Args:</span>
<span class="sd">            add_links_df: Dataframe of additional links to add.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_links_df</span><span class="p">,</span> <span class="n">RoadLinksTable</span><span class="p">):</span>
            <span class="n">add_links_df</span> <span class="o">=</span> <span class="n">data_to_links_df</span><span class="p">(</span><span class="n">add_links_df</span><span class="p">,</span> <span class="n">nodes_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span> <span class="o">=</span> <span class="n">RoadLinksTable</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="n">add_links_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_nodes_df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate combined nodes_df with NodesSchema before adding to self.nodes_df.</span>

<span class="sd">        Args:</span>
<span class="sd">            add_nodes_df: Dataframe of additional nodes to add.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_nodes_df</span><span class="p">,</span> <span class="n">RoadNodesTable</span><span class="p">):</span>
            <span class="n">add_nodes_df</span> <span class="o">=</span> <span class="n">data_to_nodes_df</span><span class="p">(</span><span class="n">add_nodes_df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">RoadNodesTable</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">add_nodes_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_shapes_df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadShapesTable</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate combined shapes_df with RoadShapesTable efore adding to self.shapes_df.</span>

<span class="sd">        Args:</span>
<span class="sd">            add_shapes_df: Dataframe of additional shapes to add.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_shapes_df</span><span class="p">,</span> <span class="n">RoadShapesTable</span><span class="p">):</span>
            <span class="n">add_shapes_df</span> <span class="o">=</span> <span class="n">df_to_shapes_df</span><span class="p">(</span><span class="n">add_shapes_df</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;add_shapes_df: </span><span class="se">\n</span><span class="si">{</span><span class="n">add_shapes_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;self.shapes_df: </span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">together_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="n">add_shapes_df</span><span class="p">])</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;together_df: </span><span class="se">\n</span><span class="si">{</span><span class="n">together_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="n">RoadShapesTable</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="n">add_shapes_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">delete_links</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">selection_dict</span><span class="p">:</span> <span class="n">SelectLinksDict</span><span class="p">,</span>
        <span class="n">clean_nodes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">clean_shapes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes links based on selection dictionary and optionally associated nodes and shapes.</span>

<span class="sd">        Args:</span>
<span class="sd">            selection_dict (SelectLinks): Dictionary describing link selections as follows:</span>
<span class="sd">                `all`: Optional[bool] = False. If true, will select all.</span>
<span class="sd">                `name`: Optional[list[str]]</span>
<span class="sd">                `ref`: Optional[list[str]]</span>
<span class="sd">                `osm_link_id`:Optional[list[str]]</span>
<span class="sd">                `model_link_id`: Optional[list[int]]</span>
<span class="sd">                `modes`: Optional[list[str]]. Defaults to &quot;any&quot;</span>
<span class="sd">                `ignore_missing`: if true, will not error when defaults to True.</span>
<span class="sd">                ...plus any other link property to select on top of these.</span>
<span class="sd">            clean_nodes (bool, optional): If True, will clean nodes uniquely associated with</span>
<span class="sd">                deleted links. Defaults to False.</span>
<span class="sd">            clean_shapes (bool, optional): If True, will clean nodes uniquely associated with</span>
<span class="sd">                deleted links. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">SelectLinksDict</span><span class="p">(</span><span class="o">**</span><span class="n">selection_dict</span><span class="p">)</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span>
            <span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">({</span><span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="n">selection_dict</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">clean_nodes</span><span class="p">:</span>
            <span class="n">node_ids_to_delete</span> <span class="o">=</span> <span class="n">node_ids_unique_to_link_ids</span><span class="p">(</span>
                <span class="n">selection</span><span class="o">.</span><span class="n">selected_links</span><span class="p">,</span> <span class="n">selection</span><span class="o">.</span><span class="n">selected_links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span>
            <span class="p">)</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Dropping nodes associated with dropped links: </span><span class="se">\n</span><span class="si">{</span><span class="n">node_ids_to_delete</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">delete_nodes_by_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">del_node_ids</span><span class="o">=</span><span class="n">node_ids_to_delete</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">clean_shapes</span><span class="p">:</span>
            <span class="n">shape_ids_to_delete</span> <span class="o">=</span> <span class="n">shape_ids_unique_to_link_ids</span><span class="p">(</span>
                <span class="n">selection</span><span class="o">.</span><span class="n">selected_links</span><span class="p">,</span> <span class="n">selection</span><span class="o">.</span><span class="n">selected_links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span>
            <span class="p">)</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Dropping shapes associated with dropped links: </span><span class="se">\n</span><span class="si">{</span><span class="n">shape_ids_to_delete</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="n">delete_shapes_by_ids</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="n">del_shape_ids</span><span class="o">=</span><span class="n">shape_ids_to_delete</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span> <span class="o">=</span> <span class="n">delete_links_by_ids</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span>
            <span class="n">selection</span><span class="o">.</span><span class="n">selected_links</span><span class="p">,</span>
            <span class="n">ignore_missing</span><span class="o">=</span><span class="n">selection</span><span class="o">.</span><span class="n">ignore_missing</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_nodes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">selection_dict</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">SelectNodesDict</span><span class="p">],</span>
        <span class="n">remove_links</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes nodes from roadway network. Wont delete nodes used by links in network.</span>

<span class="sd">        Args:</span>
<span class="sd">            selection_dict: dictionary of node selection criteria in the form of a SelectNodesDict.</span>
<span class="sd">            remove_links: if True, will remove any links that are associated with the nodes.</span>
<span class="sd">                If False, will only remove nodes if they are not associated with any links.</span>
<span class="sd">                Defaults to False.</span>

<span class="sd">        raises:</span>
<span class="sd">            NodeDeletionError: If not ignore_missing and selected nodes to delete aren&#39;t in network</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectNodesDict</span><span class="p">):</span>
            <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">SelectNodesDict</span><span class="p">(</span><span class="o">**</span><span class="n">selection_dict</span><span class="p">)</span>
        <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">selection_dict</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">selection</span><span class="p">:</span> <span class="n">RoadwayNodeSelection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="n">selection_dict</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">remove_links</span><span class="p">:</span>
            <span class="n">del_node_ids</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">selected_nodes</span>
            <span class="n">link_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_with_nodes</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">selected_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">model_link_id</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">link_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> links associated with nodes.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_links</span><span class="p">({</span><span class="s2">&quot;model_link_id&quot;</span><span class="p">:</span> <span class="n">link_ids</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">unused_node_ids</span> <span class="o">=</span> <span class="n">node_ids_without_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">)</span>
            <span class="n">del_node_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">selected_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">unused_node_ids</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">delete_nodes_by_ids</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">del_node_ids</span><span class="p">,</span> <span class="n">ignore_missing</span><span class="o">=</span><span class="n">selection</span><span class="o">.</span><span class="n">ignore_missing</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">clean_unused_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes any unused shapes from network that aren&#39;t referenced by links_df.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.shapes.shapes</span> <span class="kn">import</span> <span class="n">shape_ids_without_links</span>

        <span class="n">del_shape_ids</span> <span class="o">=</span> <span class="n">shape_ids_without_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">del_shape_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clean_unused_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes any unused nodes from network that aren&#39;t referenced by links_df.</span>

<span class="sd">        NOTE: does not check if these nodes are used by transit, so use with caution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.nodes.nodes</span> <span class="kn">import</span> <span class="n">node_ids_without_links</span>

        <span class="n">node_ids</span> <span class="o">=</span> <span class="n">node_ids_without_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">move_nodes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">node_geometry_change_table</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">NodeGeometryChangeTable</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Moves nodes based on updated geometry along with associated links and shape geometry.</span>

<span class="sd">        Args:</span>
<span class="sd">            node_geometry_change_table: a table with model_node_id, X, Y, and CRS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_geometry_change_table</span> <span class="o">=</span> <span class="n">NodeGeometryChangeTable</span><span class="p">(</span><span class="n">node_geometry_change_table</span><span class="p">)</span>
        <span class="n">node_ids</span> <span class="o">=</span> <span class="n">node_geometry_change_table</span><span class="o">.</span><span class="n">model_node_id</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving nodes: </span><span class="si">{</span><span class="n">node_ids</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">edit_node_geometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">node_geometry_change_table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span> <span class="o">=</span> <span class="n">edit_link_geometry_from_nodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">node_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="n">edit_shape_geometry_from_nodes</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">node_ids</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Queries if network has node based on model_node_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_node_id: model_node_id to check for.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">has_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">model_node_id</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">model_node_id</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">has_node</span>

    <span class="k">def</span> <span class="nf">has_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ab</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns true if network has links with AB values.</span>

<span class="sd">        Args:</span>
<span class="sd">            ab: Tuple of values corresponding with A and B.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sel_a</span><span class="p">,</span> <span class="n">sel_b</span> <span class="o">=</span> <span class="n">ab</span>
        <span class="n">has_link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]]]</span><span class="o">.</span><span class="n">isin</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">sel_a</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">sel_b</span><span class="p">})</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">has_link</span>

    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determines if the network graph is &quot;strongly&quot; connected.</span>

<span class="sd">        A graph is strongly connected if each vertex is reachable from every other vertex.</span>

<span class="sd">        Args:</span>
<span class="sd">            mode:  mode of the network, one of `drive`,`transit`,`walk`, `bike`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_connected</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_modal_graph</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">is_connected</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_incident_link_data_to_nodes</span><span class="p">(</span>
        <span class="n">links_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">nodes_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">link_variables</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add data from links going to/from nodes to node.</span>

<span class="sd">        Args:</span>
<span class="sd">            links_df: if specified, will assess connectivity of this</span>
<span class="sd">                links list rather than self.links_df</span>
<span class="sd">            nodes_df: if specified, will assess connectivity of this</span>
<span class="sd">                nodes list rather than self.nodes_df</span>
<span class="sd">            link_variables: list of columns in links dataframe to add to incident nodes</span>

<span class="sd">        Returns:</span>
<span class="sd">            nodes DataFrame with link data where length is N*number of links going in/out</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding following link data to nodes: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>

        <span class="n">_link_vals_to_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">link_variables</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">links_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">link_variables</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_link_vals_to_nodes</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Following columns not in links_df and wont be added to nodes: </span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">link_variables</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">_link_vals_to_nodes</span><span class="p">))</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">_nodes_from_links_A</span> <span class="o">=</span> <span class="n">nodes_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">links_df</span><span class="p">[[</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">from_node</span><span class="p">]</span> <span class="o">+</span> <span class="n">_link_vals_to_nodes</span><span class="p">],</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">from_node</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_nodes_from_links_B</span> <span class="o">=</span> <span class="n">nodes_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">links_df</span><span class="p">[[</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">to_node</span><span class="p">]</span> <span class="o">+</span> <span class="n">_link_vals_to_nodes</span><span class="p">],</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
            <span class="n">left_on</span><span class="o">=</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">to_node</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_nodes_from_links_ab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">_nodes_from_links_A</span><span class="p">,</span> <span class="n">_nodes_from_links_B</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">_nodes_from_links_ab</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.roadway.network.RoadwayNetwork.link_shapes_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">link_shapes_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.link_shapes_df" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Add shape geometry to links if available.</p>
<p>returns: shapes merged to nodes dataframe</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.roadway.network.RoadwayNetwork.model_net" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model_net</span><span class="p">:</span> <span class="n">ModelRoadwayNetwork</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.model_net" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return a ModelRoadwayNetwork object for this network.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.roadway.network.RoadwayNetwork.network_hash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">network_hash</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.network_hash" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Hash of the links and nodes dataframes.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.roadway.network.RoadwayNetwork.shapes_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shapes_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadShapesTable</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.shapes_df" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Load and return RoadShapesTable.</p>
<p>If not already loaded, will read from shapes_file and return. If shapes_file is None,
will return an empty dataframe with the right schema. If shapes_df is already set, will
return that.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.roadway.network.RoadwayNetwork.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">:</span> <span class="nb">dict</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.summary" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Quick summary dictionary of number of links, nodes.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.add_incident_link_data_to_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_incident_link_data_to_nodes</span><span class="p">(</span><span class="n">links_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodes_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">link_variables</span><span class="o">=</span><span class="p">[])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.add_incident_link_data_to_nodes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Add data from links going to/from nodes to node.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>links_df</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadLinksTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadLinksTable">RoadLinksTable</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if specified, will assess connectivity of this
links list rather than self.links_df</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>nodes_df</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadNodesTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadNodesTable">RoadNodesTable</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if specified, will assess connectivity of this
nodes list rather than self.nodes_df</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>link_variables</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of columns in links dataframe to add to incident nodes</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadNodesTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadNodesTable">RoadNodesTable</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nodes DataFrame with link data where length is N*number of links going in/out</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">add_incident_link_data_to_nodes</span><span class="p">(</span>
    <span class="n">links_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nodes_df</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">link_variables</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add data from links going to/from nodes to node.</span>

<span class="sd">    Args:</span>
<span class="sd">        links_df: if specified, will assess connectivity of this</span>
<span class="sd">            links list rather than self.links_df</span>
<span class="sd">        nodes_df: if specified, will assess connectivity of this</span>
<span class="sd">            nodes list rather than self.nodes_df</span>
<span class="sd">        link_variables: list of columns in links dataframe to add to incident nodes</span>

<span class="sd">    Returns:</span>
<span class="sd">        nodes DataFrame with link data where length is N*number of links going in/out</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adding following link data to nodes: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>

    <span class="n">_link_vals_to_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">link_variables</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">links_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">link_variables</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_link_vals_to_nodes</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Following columns not in links_df and wont be added to nodes: </span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">link_variables</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">_link_vals_to_nodes</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">_nodes_from_links_A</span> <span class="o">=</span> <span class="n">nodes_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">links_df</span><span class="p">[[</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">from_node</span><span class="p">]</span> <span class="o">+</span> <span class="n">_link_vals_to_nodes</span><span class="p">],</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
        <span class="n">left_on</span><span class="o">=</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
        <span class="n">right_on</span><span class="o">=</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">from_node</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_nodes_from_links_B</span> <span class="o">=</span> <span class="n">nodes_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">links_df</span><span class="p">[[</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">to_node</span><span class="p">]</span> <span class="o">+</span> <span class="n">_link_vals_to_nodes</span><span class="p">],</span>
        <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
        <span class="n">left_on</span><span class="o">=</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">primary_key</span><span class="p">,</span>
        <span class="n">right_on</span><span class="o">=</span><span class="n">links_df</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">to_node</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_nodes_from_links_ab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">_nodes_from_links_A</span><span class="p">,</span> <span class="n">_nodes_from_links_B</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">_nodes_from_links_ab</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.add_links" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_links</span><span class="p">(</span><span class="n">add_links_df</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.add_links" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Validate combined links_df with LinksSchema before adding to self.links_df.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>add_links_df</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadLinksTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadLinksTable">RoadLinksTable</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe of additional links to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_links_df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate combined links_df with LinksSchema before adding to self.links_df.</span>

<span class="sd">    Args:</span>
<span class="sd">        add_links_df: Dataframe of additional links to add.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_links_df</span><span class="p">,</span> <span class="n">RoadLinksTable</span><span class="p">):</span>
        <span class="n">add_links_df</span> <span class="o">=</span> <span class="n">data_to_links_df</span><span class="p">(</span><span class="n">add_links_df</span><span class="p">,</span> <span class="n">nodes_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span> <span class="o">=</span> <span class="n">RoadLinksTable</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="n">add_links_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.add_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_nodes</span><span class="p">(</span><span class="n">add_nodes_df</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.add_nodes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Validate combined nodes_df with NodesSchema before adding to self.nodes_df.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>add_nodes_df</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadNodesTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadNodesTable">RoadNodesTable</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe of additional nodes to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_nodes_df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate combined nodes_df with NodesSchema before adding to self.nodes_df.</span>

<span class="sd">    Args:</span>
<span class="sd">        add_nodes_df: Dataframe of additional nodes to add.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_nodes_df</span><span class="p">,</span> <span class="n">RoadNodesTable</span><span class="p">):</span>
        <span class="n">add_nodes_df</span> <span class="o">=</span> <span class="n">data_to_nodes_df</span><span class="p">(</span><span class="n">add_nodes_df</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">RoadNodesTable</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">add_nodes_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.add_shapes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_shapes</span><span class="p">(</span><span class="n">add_shapes_df</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.add_shapes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Validate combined shapes_df with RoadShapesTable efore adding to self.shapes_df.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>add_shapes_df</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.tables.RoadShapesTable" href="../data_models/#network_wrangler.models.roadway.tables.RoadShapesTable">RoadShapesTable</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe of additional shapes to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">add_shapes_df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadShapesTable</span><span class="p">]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate combined shapes_df with RoadShapesTable efore adding to self.shapes_df.</span>

<span class="sd">    Args:</span>
<span class="sd">        add_shapes_df: Dataframe of additional shapes to add.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_shapes_df</span><span class="p">,</span> <span class="n">RoadShapesTable</span><span class="p">):</span>
        <span class="n">add_shapes_df</span> <span class="o">=</span> <span class="n">df_to_shapes_df</span><span class="p">(</span><span class="n">add_shapes_df</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;add_shapes_df: </span><span class="se">\n</span><span class="si">{</span><span class="n">add_shapes_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;self.shapes_df: </span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">together_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="n">add_shapes_df</span><span class="p">])</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;together_df: </span><span class="se">\n</span><span class="si">{</span><span class="n">together_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="n">RoadShapesTable</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="n">add_shapes_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.apply" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.apply" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Wrapper method to apply a roadway project, returning a new RoadwayNetwork instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>project_card</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="projectcard.ProjectCard">ProjectCard</span>, dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>either a dictionary of the project card object or ProjectCard instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_card</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">,</span> <span class="nb">dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">RoadwayNetwork</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper method to apply a roadway project, returning a new RoadwayNetwork instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_card: either a dictionary of the project card object or ProjectCard instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">ProjectCard</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">)):</span>
        <span class="n">project_card</span> <span class="o">=</span> <span class="n">ProjectCard</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span>

    <span class="n">project_card</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- applying subproject: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.clean_unused_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clean_unused_nodes</span><span class="p">()</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.clean_unused_nodes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Removes any unused nodes from network that aren&rsquo;t referenced by links_df.</p>
<p>NOTE: does not check if these nodes are used by transit, so use with caution.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_unused_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes any unused nodes from network that aren&#39;t referenced by links_df.</span>

<span class="sd">    NOTE: does not check if these nodes are used by transit, so use with caution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.nodes.nodes</span> <span class="kn">import</span> <span class="n">node_ids_without_links</span>

    <span class="n">node_ids</span> <span class="o">=</span> <span class="n">node_ids_without_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.clean_unused_shapes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clean_unused_shapes</span><span class="p">()</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.clean_unused_shapes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Removes any unused shapes from network that aren&rsquo;t referenced by links_df.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clean_unused_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes any unused shapes from network that aren&#39;t referenced by links_df.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.shapes.shapes</span> <span class="kn">import</span> <span class="n">shape_ids_without_links</span>

    <span class="n">del_shape_ids</span> <span class="o">=</span> <span class="n">shape_ids_without_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">del_shape_ids</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.coerce_crs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coerce_crs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.coerce_crs" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Coerce crs of nodes_df and links_df to network crs.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;nodes_df&quot;</span><span class="p">,</span> <span class="s2">&quot;links_df&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">coerce_crs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coerce crs of nodes_df and links_df to network crs.&quot;&quot;&quot;</span>
    <span class="n">net_crs</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">crs</span> <span class="o">!=</span> <span class="n">net_crs</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;CRS of links_df (</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">crs</span><span class="si">}</span><span class="s2">) doesn&#39;t match network crs </span><span class="si">{</span><span class="n">net_crs</span><span class="si">}</span><span class="s2">. </span><span class="se">\</span>
<span class="s2">                Changing to network crs.&quot;</span>
        <span class="p">)</span>
        <span class="n">v</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">net_crs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.delete_links" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_links</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">clean_nodes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clean_shapes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.delete_links" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Deletes links based on selection dictionary and optionally associated nodes and shapes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selection_dict</code></td>
            <td>
                  <code>SelectLinks</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary describing link selections as follows:
<code>all</code>: Optional[bool] = False. If true, will select all.
<code>name</code>: Optional[list[str]]
<code>ref</code>: Optional[list[str]]
<code>osm_link_id</code>:Optional[list[str]]
<code>model_link_id</code>: Optional[list[int]]
<code>modes</code>: Optional[list[str]]. Defaults to &ldquo;any&rdquo;
<code>ignore_missing</code>: if true, will not error when defaults to True.
&hellip;plus any other link property to select on top of these.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clean_nodes</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will clean nodes uniquely associated with
deleted links. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>clean_shapes</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will clean nodes uniquely associated with
deleted links. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_links</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">selection_dict</span><span class="p">:</span> <span class="n">SelectLinksDict</span><span class="p">,</span>
    <span class="n">clean_nodes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">clean_shapes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes links based on selection dictionary and optionally associated nodes and shapes.</span>

<span class="sd">    Args:</span>
<span class="sd">        selection_dict (SelectLinks): Dictionary describing link selections as follows:</span>
<span class="sd">            `all`: Optional[bool] = False. If true, will select all.</span>
<span class="sd">            `name`: Optional[list[str]]</span>
<span class="sd">            `ref`: Optional[list[str]]</span>
<span class="sd">            `osm_link_id`:Optional[list[str]]</span>
<span class="sd">            `model_link_id`: Optional[list[int]]</span>
<span class="sd">            `modes`: Optional[list[str]]. Defaults to &quot;any&quot;</span>
<span class="sd">            `ignore_missing`: if true, will not error when defaults to True.</span>
<span class="sd">            ...plus any other link property to select on top of these.</span>
<span class="sd">        clean_nodes (bool, optional): If True, will clean nodes uniquely associated with</span>
<span class="sd">            deleted links. Defaults to False.</span>
<span class="sd">        clean_shapes (bool, optional): If True, will clean nodes uniquely associated with</span>
<span class="sd">            deleted links. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">SelectLinksDict</span><span class="p">(</span><span class="o">**</span><span class="n">selection_dict</span><span class="p">)</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span>
        <span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">({</span><span class="s2">&quot;links&quot;</span><span class="p">:</span> <span class="n">selection_dict</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">clean_nodes</span><span class="p">:</span>
        <span class="n">node_ids_to_delete</span> <span class="o">=</span> <span class="n">node_ids_unique_to_link_ids</span><span class="p">(</span>
            <span class="n">selection</span><span class="o">.</span><span class="n">selected_links</span><span class="p">,</span> <span class="n">selection</span><span class="o">.</span><span class="n">selected_links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span>
        <span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Dropping nodes associated with dropped links: </span><span class="se">\n</span><span class="si">{</span><span class="n">node_ids_to_delete</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">delete_nodes_by_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">del_node_ids</span><span class="o">=</span><span class="n">node_ids_to_delete</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">clean_shapes</span><span class="p">:</span>
        <span class="n">shape_ids_to_delete</span> <span class="o">=</span> <span class="n">shape_ids_unique_to_link_ids</span><span class="p">(</span>
            <span class="n">selection</span><span class="o">.</span><span class="n">selected_links</span><span class="p">,</span> <span class="n">selection</span><span class="o">.</span><span class="n">selected_links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span>
        <span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Dropping shapes associated with dropped links: </span><span class="se">\n</span><span class="si">{</span><span class="n">shape_ids_to_delete</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="n">delete_shapes_by_ids</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="n">del_shape_ids</span><span class="o">=</span><span class="n">shape_ids_to_delete</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span> <span class="o">=</span> <span class="n">delete_links_by_ids</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span>
        <span class="n">selection</span><span class="o">.</span><span class="n">selected_links</span><span class="p">,</span>
        <span class="n">ignore_missing</span><span class="o">=</span><span class="n">selection</span><span class="o">.</span><span class="n">ignore_missing</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.delete_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_nodes</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">remove_links</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.delete_nodes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Deletes nodes from roadway network. Wont delete nodes used by links in network.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selection_dict</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[dict, <a class="autorefs autorefs-internal" title="network_wrangler.models.projects.roadway_selection.SelectNodesDict" href="../data_models/#network_wrangler.models.projects.roadway_selection.SelectNodesDict">SelectNodesDict</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary of node selection criteria in the form of a SelectNodesDict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>remove_links</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, will remove any links that are associated with the nodes.
If False, will only remove nodes if they are not associated with any links.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>NodeDeletionError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If not ignore_missing and selected nodes to delete aren&rsquo;t in network</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_nodes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">selection_dict</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">SelectNodesDict</span><span class="p">],</span>
    <span class="n">remove_links</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes nodes from roadway network. Wont delete nodes used by links in network.</span>

<span class="sd">    Args:</span>
<span class="sd">        selection_dict: dictionary of node selection criteria in the form of a SelectNodesDict.</span>
<span class="sd">        remove_links: if True, will remove any links that are associated with the nodes.</span>
<span class="sd">            If False, will only remove nodes if they are not associated with any links.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    raises:</span>
<span class="sd">        NodeDeletionError: If not ignore_missing and selected nodes to delete aren&#39;t in network</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectNodesDict</span><span class="p">):</span>
        <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">SelectNodesDict</span><span class="p">(</span><span class="o">**</span><span class="n">selection_dict</span><span class="p">)</span>
    <span class="n">selection_dict</span> <span class="o">=</span> <span class="n">selection_dict</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">selection</span><span class="p">:</span> <span class="n">RoadwayNodeSelection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="n">selection_dict</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">remove_links</span><span class="p">:</span>
        <span class="n">del_node_ids</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">selected_nodes</span>
        <span class="n">link_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_with_nodes</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">selected_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">model_link_id</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">link_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> links associated with nodes.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_links</span><span class="p">({</span><span class="s2">&quot;model_link_id&quot;</span><span class="p">:</span> <span class="n">link_ids</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">unused_node_ids</span> <span class="o">=</span> <span class="n">node_ids_without_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">)</span>
        <span class="n">del_node_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="o">.</span><span class="n">selected_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">unused_node_ids</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">delete_nodes_by_ids</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">del_node_ids</span><span class="p">,</span> <span class="n">ignore_missing</span><span class="o">=</span><span class="n">selection</span><span class="o">.</span><span class="n">ignore_missing</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.get_modal_graph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_modal_graph</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.get_modal_graph" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return a networkx graph of the network for a specific mode.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mode</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mode of the network, one of <code>drive</code>,<code>transit</code>,<code>walk</code>, <code>bike</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_modal_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultiDiGraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a networkx graph of the network for a specific mode.</span>

<span class="sd">    Args:</span>
<span class="sd">        mode: mode of the network, one of `drive`,`transit`,`walk`, `bike`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.graph</span> <span class="kn">import</span> <span class="n">net_to_graph</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modal_graphs</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="s2">&quot;hash&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modal_graph_hash</span><span class="p">(</span><span class="n">mode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_modal_graphs</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">net_to_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modal_graphs</span><span class="p">[</span><span class="n">mode</span><span class="p">][</span><span class="s2">&quot;graph&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.get_property_by_timespan_and_group" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_property_by_timespan_and_group</span><span class="p">(</span><span class="n">link_property</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">DEFAULT_CATEGORY</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="n">DEFAULT_TIMESPAN</span><span class="p">,</span> <span class="n">strict_timespan_match</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_overlap_minutes</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.get_property_by_timespan_and_group" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Returns a new dataframe with model_link_id and link property by category and timespan.</p>
<p>Convenience method for backward compatability.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>link_property</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>link property to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>category</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>category to query or a list of categories. Defaults to DEFAULT_CATEGORY.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.params.DEFAULT_CATEGORY" href="#network_wrangler.params.DEFAULT_CATEGORY">DEFAULT_CATEGORY</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>timespan</code></td>
            <td>
                  <code><span title="network_wrangler.models._base.types.TimespanString">TimespanString</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>timespan to query in the form of [&ldquo;HH:MM&rdquo;,&rdquo;HH:MM&rdquo;].
Defaults to DEFAULT_TIMESPAN.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.params.DEFAULT_TIMESPAN" href="#network_wrangler.params.DEFAULT_TIMESPAN">DEFAULT_TIMESPAN</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>strict_timespan_match</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will only return links that match the timespan exactly.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>min_overlap_minutes</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If strict_timespan_match is False, will return links that overlap
with the timespan by at least this many minutes. Defaults to 60.</p>
              </div>
            </td>
            <td>
                  <code>60</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_property_by_timespan_and_group</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">link_property</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">category</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_CATEGORY</span><span class="p">,</span>
    <span class="n">timespan</span><span class="p">:</span> <span class="n">TimespanString</span> <span class="o">=</span> <span class="n">DEFAULT_TIMESPAN</span><span class="p">,</span>
    <span class="n">strict_timespan_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">min_overlap_minutes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a new dataframe with model_link_id and link property by category and timespan.</span>

<span class="sd">    Convenience method for backward compatability.</span>

<span class="sd">    Args:</span>
<span class="sd">        link_property: link property to query</span>
<span class="sd">        category: category to query or a list of categories. Defaults to DEFAULT_CATEGORY.</span>
<span class="sd">        timespan: timespan to query in the form of [&quot;HH:MM&quot;,&quot;HH:MM&quot;].</span>
<span class="sd">            Defaults to DEFAULT_TIMESPAN.</span>
<span class="sd">        strict_timespan_match: If True, will only return links that match the timespan exactly.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        min_overlap_minutes: If strict_timespan_match is False, will return links that overlap</span>
<span class="sd">            with the timespan by at least this many minutes. Defaults to 60.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.links.scopes</span> <span class="kn">import</span> <span class="n">prop_for_scope</span>

    <span class="k">return</span> <span class="n">prop_for_scope</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span>
        <span class="n">link_property</span><span class="p">,</span>
        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
        <span class="n">strict_timespan_match</span><span class="o">=</span><span class="n">strict_timespan_match</span><span class="p">,</span>
        <span class="n">min_overlap_minutes</span><span class="o">=</span><span class="n">min_overlap_minutes</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.get_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_selection</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.get_selection" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return selection if it already exists, otherwise performs selection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selection_dict</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SelectFacility dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>overwrite</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, will overwrite any previously cached searches. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_selection</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">selection_dict</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">SelectFacility</span><span class="p">],</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">RoadwayNodeSelection</span><span class="p">,</span> <span class="n">RoadwayLinkSelection</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return selection if it already exists, otherwise performs selection.</span>

<span class="sd">    Args:</span>
<span class="sd">        selection_dict (dict): SelectFacility dictionary.</span>
<span class="sd">        overwrite: if True, will overwrite any previously cached searches. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">_create_selection_key</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using cached selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectFacility</span><span class="p">):</span>
        <span class="n">selection_data</span> <span class="o">=</span> <span class="n">selection_dict</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectLinksDict</span><span class="p">):</span>
        <span class="n">selection_data</span> <span class="o">=</span> <span class="n">SelectFacility</span><span class="p">(</span><span class="n">links</span><span class="o">=</span><span class="n">selection_dict</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">SelectNodesDict</span><span class="p">):</span>
        <span class="n">selection_data</span> <span class="o">=</span> <span class="n">SelectFacility</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="n">selection_dict</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">selection_data</span> <span class="o">=</span> <span class="n">SelectFacility</span><span class="p">(</span><span class="o">**</span><span class="n">selection_dict</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`selection_dict` arg must be a dictionary or SelectFacility</span><span class="se">\</span>
<span class="s2">                          model. Received: </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2"> of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">SelectionError</span><span class="p">(</span><span class="s2">&quot;selection_dict arg must be a dictionary or SelectFacility model&quot;</span><span class="p">)</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">selection_data</span><span class="o">.</span><span class="n">feature_types</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">,</span> <span class="s2">&quot;segment&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">RoadwayLinkSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">selection_data</span><span class="o">.</span><span class="n">feature_types</span> <span class="o">==</span> <span class="s2">&quot;nodes&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">RoadwayNodeSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Selection data should be of type &#39;segment&#39;, &#39;links&#39; or &#39;nodes&#39;.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">SelectionError</span><span class="p">(</span><span class="s2">&quot;Selection data should be of type &#39;segment&#39;, &#39;links&#39; or &#39;nodes&#39;.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.has_link" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_link</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.has_link" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Returns true if network has links with AB values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>ab</code></td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of values corresponding with A and B.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ab</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns true if network has links with AB values.</span>

<span class="sd">    Args:</span>
<span class="sd">        ab: Tuple of values corresponding with A and B.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sel_a</span><span class="p">,</span> <span class="n">sel_b</span> <span class="o">=</span> <span class="n">ab</span>
    <span class="n">has_link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]]]</span><span class="o">.</span><span class="n">isin</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">sel_a</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">sel_b</span><span class="p">})</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">has_link</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.has_node" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">has_node</span><span class="p">(</span><span class="n">model_node_id</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.has_node" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Queries if network has node based on model_node_id.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model_node_id</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>model_node_id to check for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Queries if network has node based on model_node_id.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_node_id: model_node_id to check for.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">has_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="o">.</span><span class="n">model_node_id</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">model_node_id</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">has_node</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.is_connected" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_connected</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.is_connected" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Determines if the network graph is &ldquo;strongly&rdquo; connected.</p>
<p>A graph is strongly connected if each vertex is reachable from every other vertex.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mode</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mode of the network, one of <code>drive</code>,<code>transit</code>,<code>walk</code>, <code>bike</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determines if the network graph is &quot;strongly&quot; connected.</span>

<span class="sd">    A graph is strongly connected if each vertex is reachable from every other vertex.</span>

<span class="sd">    Args:</span>
<span class="sd">        mode:  mode of the network, one of `drive`,`transit`,`walk`, `bike`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_connected</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_modal_graph</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">is_connected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.links_with_link_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">links_with_link_ids</span><span class="p">(</span><span class="n">link_ids</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.links_with_link_ids" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return subset of links_df based on link_ids list.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">links_with_link_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return subset of links_df based on link_ids list.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">filter_links_to_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="n">link_ids</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.links_with_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">links_with_nodes</span><span class="p">(</span><span class="n">node_ids</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.links_with_nodes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return subset of links_df based on node_ids list.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">links_with_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadLinksTable</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return subset of links_df based on node_ids list.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">filter_links_to_node_ids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="n">node_ids</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.modal_graph_hash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">modal_graph_hash</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.modal_graph_hash" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Hash of the links in order to detect a network change from when graph created.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">modal_graph_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hash of the links in order to detect a network change from when graph created.&quot;&quot;&quot;</span>
    <span class="n">_value</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="o">.</span><span class="n">df_hash</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">mode</span><span class="p">)</span>
    <span class="n">_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">_value</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">_hash</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.move_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_nodes</span><span class="p">(</span><span class="n">node_geometry_change_table</span><span class="p">)</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.move_nodes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Moves nodes based on updated geometry along with associated links and shape geometry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>node_geometry_change_table</code></td>
            <td>
                  <code><span title="pandera.typing.DataFrame">DataFrame</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.projects.roadway_property_change.NodeGeometryChangeTable" href="../data_models/#network_wrangler.models.projects.roadway_property_change.NodeGeometryChangeTable">NodeGeometryChangeTable</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a table with model_node_id, X, Y, and CRS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">move_nodes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">node_geometry_change_table</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">NodeGeometryChangeTable</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Moves nodes based on updated geometry along with associated links and shape geometry.</span>

<span class="sd">    Args:</span>
<span class="sd">        node_geometry_change_table: a table with model_node_id, X, Y, and CRS.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node_geometry_change_table</span> <span class="o">=</span> <span class="n">NodeGeometryChangeTable</span><span class="p">(</span><span class="n">node_geometry_change_table</span><span class="p">)</span>
    <span class="n">node_ids</span> <span class="o">=</span> <span class="n">node_geometry_change_table</span><span class="o">.</span><span class="n">model_node_id</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving nodes: </span><span class="si">{</span><span class="n">node_ids</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span> <span class="o">=</span> <span class="n">edit_node_geometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">node_geometry_change_table</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span> <span class="o">=</span> <span class="n">edit_link_geometry_from_nodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">node_ids</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span> <span class="o">=</span> <span class="n">edit_shape_geometry_from_nodes</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">,</span> <span class="n">node_ids</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.roadway.network.RoadwayNetwork.nodes_in_links" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes_in_links</span><span class="p">()</span></code>

<a href="#network_wrangler.roadway.network.RoadwayNetwork.nodes_in_links" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Returns subset of self.nodes_df that are in self.links_df.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/roadway/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nodes_in_links</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">[</span><span class="n">RoadNodesTable</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns subset of self.nodes_df that are in self.links_df.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">filter_nodes_to_links</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">links_df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.transit.network"></a>
    <div class="doc doc-contents first">

      <p>TransitNetwork class for representing a transit network.</p>
<p>Transit Networks are represented as a Wrangler-flavored GTFS Feed and optionally mapped to
a RoadwayNetwork object. The TransitNetwork object is the primary object for managing transit
networks in Wrangler.</p>
<p>Usage:</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">```</span><span class="n">python</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">network_wrangler</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">wr</span>
<span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wr</span><span class="o">.</span><span class="n">load_transit</span><span class="p">(</span><span class="n">stpaul_gtfs</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">road_net</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wr</span><span class="o">.</span><span class="n">load_roadway</span><span class="p">(</span><span class="n">stpaul_roadway</span><span class="p">)</span>
<span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span>
<span class="n">write_transit</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;output_dir&quot;</span><span class="p">)</span>
<span class="err">```</span>
</code></pre></div></td></tr></table></div>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.transit.network.TransitNetwork" class="doc doc-heading">
            <code>TransitNetwork</code>


<a href="#network_wrangler.transit.network.TransitNetwork" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>object</code></p>


      <p>Representation of a Transit Network.</p>
<p>Typical usage example:
<div class="language-py highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">network_wrangler</span> <span class="k">as</span> <span class="nn">wr</span>
<span class="n">tc</span><span class="o">=</span><span class="n">wr</span><span class="o">.</span><span class="n">load_transit</span><span class="p">(</span><span class="n">stpaul_gtfs</span><span class="p">)</span>
</code></pre></div></p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.transit.network.TransitNetwork.feed" href="#network_wrangler.transit.network.TransitNetwork.feed">feed</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>gtfs feed object with interlinked tables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.transit.network.TransitNetwork.road_net" href="#network_wrangler.transit.network.TransitNetwork.road_net">road_net</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.roadway.network.RoadwayNetwork" href="#network_wrangler.roadway.network.RoadwayNetwork">RoadwayNetwork</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Associated roadway network object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.transit.network.TransitNetwork.graph">graph</span></code></td>
            <td>
                  <code><span title="networkx.MultiDiGraph">MultiDiGraph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Graph for associated roadway network object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="network_wrangler.transit.network.TransitNetwork.feed_path" href="#network_wrangler.transit.network.TransitNetwork.feed_path">feed_path</a></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Where the feed was read in from.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.transit.network.TransitNetwork.validated_frequencies">validated_frequencies</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frequencies have been validated.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="network_wrangler.transit.network.TransitNetwork.validated_road_network_consistency">validated_road_network_consistency</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The network has been validated against
the road network.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/transit/network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TransitNetwork</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of a Transit Network.</span>

<span class="sd">    Typical usage example:</span>
<span class="sd">    ``` py</span>
<span class="sd">    import network_wrangler as wr</span>
<span class="sd">    tc=wr.load_transit(stpaul_gtfs)</span>
<span class="sd">    ```</span>

<span class="sd">    Attributes:</span>
<span class="sd">        feed: gtfs feed object with interlinked tables.</span>
<span class="sd">        road_net (RoadwayNetwork): Associated roadway network object.</span>
<span class="sd">        graph (nx.MultiDiGraph): Graph for associated roadway network object.</span>
<span class="sd">        feed_path (str): Where the feed was read in from.</span>
<span class="sd">        validated_frequencies (bool): The frequencies have been validated.</span>
<span class="sd">        validated_road_network_consistency (): The network has been validated against</span>
<span class="sd">            the road network.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">TIME_COLS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;arrival_time&quot;</span><span class="p">,</span> <span class="s2">&quot;departure_time&quot;</span><span class="p">,</span> <span class="s2">&quot;start_time&quot;</span><span class="p">,</span> <span class="s2">&quot;end_time&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feed</span><span class="p">:</span> <span class="n">Feed</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor for TransitNetwork.</span>

<span class="sd">        Args:</span>
<span class="sd">            feed: Feed object representing the transit network gtfs tables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating new TransitNetwork.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_road_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RoadwayNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="p">:</span> <span class="n">Feed</span> <span class="o">=</span> <span class="n">feed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># initialize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_consistent_with_road_net</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># cached selections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">feed_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pass through property from Feed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">feed_path</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pass through property from Feed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">config</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">feed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Feed associated with the transit network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span>

    <span class="nd">@feed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">feed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feed</span><span class="p">:</span> <span class="n">Feed</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feed</span><span class="p">,</span> <span class="n">Feed</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;TransitNetwork&#39;s feed value must be a valid Feed instance. </span><span class="se">\</span>
<span class="s2">                             This is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">feed</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_road_net</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">transit_road_net_consistency</span><span class="p">(</span><span class="n">feed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_road_net</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_feed</span> <span class="o">=</span> <span class="n">feed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stored_feed_hash</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">feed</span><span class="o">.</span><span class="n">hash</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Can&#39;t assign Feed inconsistent with set Roadway Network.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">TransitRoadwayConsistencyError</span><span class="p">(</span>
                <span class="s2">&quot;Can&#39;t assign Feed inconsistent with set RoadwayNetwork.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">road_net</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RoadwayNetwork</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Roadway network associated with the transit network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_road_net</span>

    <span class="nd">@road_net</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">road_net</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">road_net</span><span class="p">:</span> <span class="n">RoadwayNetwork</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">road_net</span><span class="p">,</span> <span class="n">RoadwayNetwork</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;TransitNetwork&#39;s road_net: value must be a valid RoadwayNetwork instance. </span><span class="se">\</span>
<span class="s2">                             This is a </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">road_net</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">transit_road_net_consistency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="p">,</span> <span class="n">road_net</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_road_net</span> <span class="o">=</span> <span class="n">road_net</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stored_road_net_hash</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">network_hash</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_consistent_with_road_net</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Can&#39;t assign inconsistent RoadwayNetwork - Roadway Network not </span><span class="se">\</span>
<span class="s2">                                 set, but can be referenced separately.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">TransitRoadwayConsistencyError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t assign inconsistent RoadwayNetwork.&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">feed_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the hash of the feed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">hash</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">consistent_with_road_net</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Indicate if road_net is consistent with transit network.</span>

<span class="sd">        Checks the network hash of when consistency was last evaluated. If transit network or</span>
<span class="sd">        roadway network has changed, will re-evaluate consistency and return the updated value and</span>
<span class="sd">        update self._stored_road_net_hash.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Boolean indicating if road_net is consistent with transit network.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">updated_road</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">network_hash</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_road_net_hash</span>
        <span class="n">updated_feed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feed_hash</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_feed_hash</span>

        <span class="k">if</span> <span class="n">updated_road</span> <span class="ow">or</span> <span class="n">updated_feed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_consistent_with_road_net</span> <span class="o">=</span> <span class="n">transit_road_net_consistency</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stored_road_net_hash</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">network_hash</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_stored_feed_hash</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feed_hash</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consistent_with_road_net</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns copied TransitNetwork instance with deep copy of Feed but not roadway net.&quot;&quot;&quot;</span>
        <span class="n">COPY_REF_NOT_VALUE</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_road_net&quot;</span><span class="p">]</span>
        <span class="c1"># Create a new, empty instance</span>
        <span class="n">copied_net</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="c1"># Return the new TransitNetwork instance</span>
        <span class="n">attribute_dict</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Copy the attributes to the new instance</span>
        <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">attribute_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># WranglerLogger.debug(f&quot;Copying {attr_name}&quot;)</span>
            <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">COPY_REF_NOT_VALUE</span><span class="p">:</span>
                <span class="c1"># If the attribute is in the COPY_REF_NOT_VALUE list, assign the reference</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">copied_net</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># WranglerLogger.debug(f&quot;making deep copy: {attr_name}&quot;)</span>
                <span class="c1"># For other attributes, perform a deep copy</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">copied_net</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="n">memo</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">copied_net</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns copied TransitNetwork instance with deep copy of Feed but not roadway net.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stops_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return stops as a GeoDataFrame using set roadway geometry.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">nodes_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">to_points_gdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">stops</span><span class="p">,</span> <span class="n">nodes_df</span><span class="o">=</span><span class="n">ref_nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shapes_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return aggregated shapes as a GeoDataFrame using set roadway geometry.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">nodes_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">shapes_to_trip_shapes_gdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">shapes</span><span class="p">,</span> <span class="n">ref_nodes_df</span><span class="o">=</span><span class="n">ref_nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape_links_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return shape-links as a GeoDataFrame using set roadway geometry.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">nodes_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">shapes_to_shape_links_gdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">shapes</span><span class="p">,</span> <span class="n">ref_nodes_df</span><span class="o">=</span><span class="n">ref_nodes</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop_time_links_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return stop-time-links as a GeoDataFrame using set roadway geometry.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">nodes_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">stop_times_to_stop_time_links_gdf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">stop_times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">stops</span><span class="p">,</span> <span class="n">ref_nodes_df</span><span class="o">=</span><span class="n">ref_nodes</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop_times_points_gdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return stop-time-points as a GeoDataFrame using set roadway geometry.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">road_net</span><span class="o">.</span><span class="n">nodes_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref_nodes</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">stop_times_to_stop_time_points_gdf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">stop_times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="o">.</span><span class="n">stops</span><span class="p">,</span> <span class="n">ref_nodes_df</span><span class="o">=</span><span class="n">ref_nodes</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_selection</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">selection_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TransitSelection</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return selection if it already exists, otherwise performs selection.</span>

<span class="sd">        Will raise an error if no trips found.</span>

<span class="sd">        Args:</span>
<span class="sd">            selection_dict (dict): _description_</span>
<span class="sd">            overwrite: if True, will overwrite any previously cached searches. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Selection: Selection object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">dict_to_hexkey</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">)</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performing selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">TransitSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using cached selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No links or nodes found for selection dict: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Selection not successful.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_card</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TransitNetwork&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper method to apply a roadway project, returning a new TransitNetwork instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_card: either a dictionary of the project card object or ProjectCard instance</span>
<span class="sd">            **kwargs: keyword arguments to pass to project application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">ProjectCard</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">)):</span>
            <span class="n">project_card</span> <span class="o">=</span> <span class="n">ProjectCard</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">project_card</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid Project Card: </span><span class="si">{project_card}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project card </span><span class="si">{</span><span class="n">project_card</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2"> not valid.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
                <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- applying subproject: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_change</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">change</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">],</span>
        <span class="n">reference_road_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RoadwayNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TransitNetwork</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a single change: a single-project project or a sub-project.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">change</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">):</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying Project to Transit Network: </span><span class="si">{</span><span class="n">change</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;transit_property_change&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_transit_property_change</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">service</span><span class="p">),</span>
                <span class="n">change</span><span class="o">.</span><span class="n">transit_property_change</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;transit_routing_change&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_transit_routing_change</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_selection</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">service</span><span class="p">),</span>
                <span class="n">change</span><span class="o">.</span><span class="n">transit_routing_change</span><span class="p">,</span>
                <span class="n">reference_road_net</span><span class="o">=</span><span class="n">reference_road_net</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;add_new_route&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_add_transit_route_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="o">.</span><span class="n">transit_route_addition</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;roadway_deletion&quot;</span><span class="p">:</span>
            <span class="c1"># FIXME</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Roadway deletion check not yet implemented.&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">change_type</span> <span class="o">==</span> <span class="s2">&quot;pycode&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">apply_calculated_transit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="o">.</span><span class="n">pycode</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Not a currently valid transit project: </span><span class="si">{</span><span class="n">change</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.config" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Pass through property from Feed.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.consistent_with_road_net" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">consistent_with_road_net</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.consistent_with_road_net" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Indicate if road_net is consistent with transit network.</p>
<p>Checks the network hash of when consistency was last evaluated. If transit network or
roadway network has changed, will re-evaluate consistency and return the updated value and
update self._stored_road_net_hash.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean indicating if road_net is consistent with transit network.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.feed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feed</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.feed" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Feed associated with the transit network.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.feed_hash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feed_hash</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.feed_hash" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return the hash of the feed.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.feed_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feed_path</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.feed_path" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Pass through property from Feed.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.road_net" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">road_net</span><span class="p">:</span> <span class="n">RoadwayNetwork</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.road_net" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Roadway network associated with the transit network.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.shape_links_gdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shape_links_gdf</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.shape_links_gdf" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return shape-links as a GeoDataFrame using set roadway geometry.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.shapes_gdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shapes_gdf</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.shapes_gdf" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return aggregated shapes as a GeoDataFrame using set roadway geometry.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.stop_time_links_gdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop_time_links_gdf</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.stop_time_links_gdf" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return stop-time-links as a GeoDataFrame using set roadway geometry.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.stop_times_points_gdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop_times_points_gdf</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.stop_times_points_gdf" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return stop-time-points as a GeoDataFrame using set roadway geometry.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.transit.network.TransitNetwork.stops_gdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stops_gdf</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.transit.network.TransitNetwork.stops_gdf" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return stops as a GeoDataFrame using set roadway geometry.</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="network_wrangler.transit.network.TransitNetwork.__deepcopy__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__deepcopy__</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span></code>

<a href="#network_wrangler.transit.network.TransitNetwork.__deepcopy__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Returns copied TransitNetwork instance with deep copy of Feed but not roadway net.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/transit/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns copied TransitNetwork instance with deep copy of Feed but not roadway net.&quot;&quot;&quot;</span>
    <span class="n">COPY_REF_NOT_VALUE</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_road_net&quot;</span><span class="p">]</span>
    <span class="c1"># Create a new, empty instance</span>
    <span class="n">copied_net</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
    <span class="c1"># Return the new TransitNetwork instance</span>
    <span class="n">attribute_dict</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Copy the attributes to the new instance</span>
    <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">attribute_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># WranglerLogger.debug(f&quot;Copying {attr_name}&quot;)</span>
        <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">COPY_REF_NOT_VALUE</span><span class="p">:</span>
            <span class="c1"># If the attribute is in the COPY_REF_NOT_VALUE list, assign the reference</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">copied_net</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># WranglerLogger.debug(f&quot;making deep copy: {attr_name}&quot;)</span>
            <span class="c1"># For other attributes, perform a deep copy</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">copied_net</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="n">memo</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">copied_net</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.transit.network.TransitNetwork.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">feed</span><span class="p">)</span></code>

<a href="#network_wrangler.transit.network.TransitNetwork.__init__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Constructor for TransitNetwork.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>feed</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.transit.feed.feed.Feed" href="../data_models/#network_wrangler.transit.feed.feed.Feed">Feed</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feed object representing the transit network gtfs tables</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/transit/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feed</span><span class="p">:</span> <span class="n">Feed</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor for TransitNetwork.</span>

<span class="sd">    Args:</span>
<span class="sd">        feed: Feed object representing the transit network gtfs tables</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating new TransitNetwork.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_road_net</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RoadwayNetwork</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">feed</span><span class="p">:</span> <span class="n">Feed</span> <span class="o">=</span> <span class="n">feed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># initialize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_consistent_with_road_net</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># cached selections</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.transit.network.TransitNetwork.apply" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#network_wrangler.transit.network.TransitNetwork.apply" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Wrapper method to apply a roadway project, returning a new TransitNetwork instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>project_card</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="projectcard.ProjectCard">ProjectCard</span>, dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>either a dictionary of the project card object or ProjectCard instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>keyword arguments to pass to project application</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/transit/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_card</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ProjectCard</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TransitNetwork&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper method to apply a roadway project, returning a new TransitNetwork instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_card: either a dictionary of the project card object or ProjectCard instance</span>
<span class="sd">        **kwargs: keyword arguments to pass to project application</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">ProjectCard</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="n">SubProject</span><span class="p">)):</span>
        <span class="n">project_card</span> <span class="o">=</span> <span class="n">ProjectCard</span><span class="p">(</span><span class="n">project_card</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">project_card</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid Project Card: </span><span class="si">{project_card}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project card </span><span class="si">{</span><span class="n">project_card</span><span class="o">.</span><span class="n">project</span><span class="si">}</span><span class="s2"> not valid.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">project_card</span><span class="o">.</span><span class="n">_sub_projects</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- applying subproject: </span><span class="si">{</span><span class="n">sp</span><span class="o">.</span><span class="n">change_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_change</span><span class="p">(</span><span class="n">project_card</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.transit.network.TransitNetwork.deepcopy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">deepcopy</span><span class="p">()</span></code>

<a href="#network_wrangler.transit.network.TransitNetwork.deepcopy" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Returns copied TransitNetwork instance with deep copy of Feed but not roadway net.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/transit/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns copied TransitNetwork instance with deep copy of Feed but not roadway net.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.transit.network.TransitNetwork.get_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_selection</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#network_wrangler.transit.network.TransitNetwork.get_selection" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Return selection if it already exists, otherwise performs selection.</p>
<p>Will raise an error if no trips found.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selection_dict</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>overwrite</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, will overwrite any previously cached searches. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Selection</code></td>            <td>
                  <code><span title="network_wrangler.transit.selection.TransitSelection">TransitSelection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Selection object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/transit/network.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_selection</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">selection_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TransitSelection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return selection if it already exists, otherwise performs selection.</span>

<span class="sd">    Will raise an error if no trips found.</span>

<span class="sd">    Args:</span>
<span class="sd">        selection_dict (dict): _description_</span>
<span class="sd">        overwrite: if True, will overwrite any previously cached searches. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Selection: Selection object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">dict_to_hexkey</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">)</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performing selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">TransitSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using cached selection from key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No links or nodes found for selection dict: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Selection not successful.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selections</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.transit.network.TransitRoadwayConsistencyError" class="doc doc-heading">
            <code>TransitRoadwayConsistencyError</code>


<a href="#network_wrangler.transit.network.TransitRoadwayConsistencyError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Error raised when transit network is inconsistent with roadway network.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/transit/network.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TransitRoadwayConsistencyError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Error raised when transit network is inconsistent with roadway network.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>




  </div>

    </div>

</div><h2 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link"> </a></h2>


<div class="doc doc-object doc-module">



<a id="network_wrangler.params"></a>
    <div class="doc doc-contents first">

      <p>Parameters for Network Wrangler.</p>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.COPY_FROM_GP_TO_ML" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">COPY_FROM_GP_TO_ML</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">,</span> <span class="s1">&#39;roadway&#39;</span><span class="p">,</span> <span class="s1">&#39;access&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;bike_access&#39;</span><span class="p">,</span> <span class="s1">&#39;drive_access&#39;</span><span class="p">,</span> <span class="s1">&#39;walk_access&#39;</span><span class="p">,</span> <span class="s1">&#39;bus_only&#39;</span><span class="p">,</span> <span class="s1">&#39;rail_only&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.COPY_FROM_GP_TO_ML" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(list(str)): list of attributes copied from GP lanes to access and egress dummy links.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.COPY_TO_ACCESS_EGRESS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">COPY_TO_ACCESS_EGRESS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">,</span> <span class="s1">&#39;ML_access&#39;</span><span class="p">,</span> <span class="s1">&#39;ML_drive_access&#39;</span><span class="p">,</span> <span class="s1">&#39;ML_bus_only&#39;</span><span class="p">,</span> <span class="s1">&#39;ML_rail_only&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.COPY_TO_ACCESS_EGRESS" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(list(str)): list of attributes
that must be provided in managed lanes</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_CATEGORY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_CATEGORY</span> <span class="o">=</span> <span class="s1">&#39;any&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_CATEGORY" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Read sec / MB - WILL DEPEND ON SPECIFIC COMPUTER</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_DELETE_MODES" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_DELETE_MODES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;any&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_DELETE_MODES" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(int): default for initial number of links from name-based
    selection that are traveresed before trying another shortest
    path when searching for paths between A and B node</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_MAX_SEARCH_BREADTH" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_MAX_SEARCH_BREADTH</span> <span class="o">=</span> <span class="mi">10</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_MAX_SEARCH_BREADTH" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Union(int, float)): default penalty assigned for each
    degree of distance between a link and a link with the searched-for
    name when searching for paths between A and B node</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_SEARCH_BREADTH" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_SEARCH_BREADTH</span> <span class="o">=</span> <span class="mi">5</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_SEARCH_BREADTH" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(int): default for maximum number of links traversed between
    links that match the searched name when searching for paths
    between A and B node</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_SEARCH_MODES" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_SEARCH_MODES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;drive&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_SEARCH_MODES" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(list(str)): default for searching for links to delete when no modes are specified.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_SP_WEIGHT_COL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_SP_WEIGHT_COL</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_SP_WEIGHT_COL" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Default timespan for scoped values.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_SP_WEIGHT_FACTOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_SP_WEIGHT_FACTOR</span> <span class="o">=</span> <span class="mi">100</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_SP_WEIGHT_FACTOR" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(str): default column to use as weights in the shortest path calculations.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.DEFAULT_TIMESPAN" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DEFAULT_TIMESPAN</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;24:00&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.DEFAULT_TIMESPAN" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Default category for scoped values.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.EST_PD_READ_SPEED" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EST_PD_READ_SPEED</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;csv&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;parquet&#39;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span> <span class="s1">&#39;geojson&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s1">&#39;txt&#39;</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.EST_PD_READ_SPEED" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(float): offset in meters for managed lanes centerlines</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.MANAGED_LANES_LINK_ID_RANGE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">MANAGED_LANES_LINK_ID_RANGE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">950000</span><span class="p">,</span> <span class="mi">999999</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.MANAGED_LANES_LINK_ID_RANGE" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Range of model_node_ids to use when creating an associated node for a parallel managed lane.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.MANAGED_LANES_REQUIRED_ATTRIBUTES" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">MANAGED_LANES_REQUIRED_ATTRIBUTES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;model_link_id&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.MANAGED_LANES_REQUIRED_ATTRIBUTES" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Range of model_link_ids to use when creating an associated link for a parallel managed lane.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.ML_OFFSET_METERS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ML_OFFSET_METERS</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.ML_OFFSET_METERS" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(list(str)): list of attributes
to copy from a general purpose lane to managed lane so long as a ML_<prop_name> doesn&rsquo;t exist.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="network_wrangler.params.SECONDARY_TRANSIT_CARD_TYPES" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">SECONDARY_TRANSIT_CARD_TYPES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;roadway_deletion&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#network_wrangler.params.SECONDARY_TRANSIT_CARD_TYPES" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>(list(str)): default for search modes when searching for paths between A and B node
    when no modes are specified.</p>
    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="network_wrangler.params.LinksParams" class="doc doc-heading">
            <code>LinksParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#network_wrangler.params.LinksParams" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">


      <p>Parameters for RoadLinksTable.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/params.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LinksParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for RoadLinksTable.&quot;&quot;&quot;</span>

    <span class="n">primary_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;model_link_id&quot;</span><span class="p">)</span>
    <span class="n">_addtl_unique_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[])</span>
    <span class="n">_addtl_explicit_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;osm_link_id&quot;</span><span class="p">])</span>
    <span class="n">from_node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
    <span class="n">to_node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
    <span class="n">fk_to_shape</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;shape_id&quot;</span><span class="p">)</span>
    <span class="n">table_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;links&quot;</span><span class="p">)</span>
    <span class="n">source_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">modes_to_network_link_variables</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">MODES_TO_NETWORK_LINK_VARIABLES</span>
    <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">idx_col</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Column to make the index of the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span> <span class="o">+</span> <span class="s2">&quot;_idx&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fks_to_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Foreign keys to nodes in the network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">from_node</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_node</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unique_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of unique ids for the table.&quot;&quot;&quot;</span>
        <span class="n">_uids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addtl_unique_ids</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_uids</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">explicit_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of columns that can be used to easily find specific row sin the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_ids</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addtl_explicit_ids</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of columns to display in the table.&quot;&quot;&quot;</span>
        <span class="n">_addtl</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lanes&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">explicit_ids</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fks_to_nodes</span> <span class="o">+</span> <span class="n">_addtl</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.LinksParams.display_cols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">display_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.LinksParams.display_cols" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>List of columns to display in the table.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.LinksParams.explicit_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">explicit_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.LinksParams.explicit_ids" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>List of columns that can be used to easily find specific row sin the table.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.LinksParams.fks_to_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fks_to_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.LinksParams.fks_to_nodes" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Foreign keys to nodes in the network.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.LinksParams.idx_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">idx_col</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.LinksParams.idx_col" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Column to make the index of the table.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.LinksParams.unique_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.LinksParams.unique_ids" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>List of unique ids for the table.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.params.NodesParams" class="doc doc-heading">
            <code>NodesParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#network_wrangler.params.NodesParams" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">


      <p>Parameters for RoadNodesTable.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/params.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">NodesParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for RoadNodesTable.&quot;&quot;&quot;</span>

    <span class="n">primary_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;model_node_id&quot;</span><span class="p">)</span>
    <span class="n">_addtl_unique_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;osm_node_id&quot;</span><span class="p">])</span>
    <span class="n">_addtl_explicit_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[])</span>
    <span class="n">source_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">table_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;nodes&quot;</span><span class="p">)</span>
    <span class="n">x_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
    <span class="n">y_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geometry_props</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of geometry properties.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x_field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_field</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">idx_col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Column to make the index of the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span> <span class="o">+</span> <span class="s2">&quot;_idx&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unique_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of unique ids for the table.&quot;&quot;&quot;</span>
        <span class="n">_uids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addtl_unique_ids</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_uids</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">explicit_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of columns that can be used to easily find specific records the table.&quot;&quot;&quot;</span>
        <span class="n">_eids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addtl_unique_ids</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_ids</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">_eids</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_cols</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Columns to display in the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">explicit_ids</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.NodesParams.display_cols" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">display_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.NodesParams.display_cols" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Columns to display in the table.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.NodesParams.explicit_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">explicit_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.NodesParams.explicit_ids" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>List of columns that can be used to easily find specific records the table.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.NodesParams.geometry_props" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">geometry_props</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.NodesParams.geometry_props" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>List of geometry properties.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.NodesParams.idx_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">idx_col</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.NodesParams.idx_col" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Column to make the index of the table.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.NodesParams.unique_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.NodesParams.unique_ids" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>List of unique ids for the table.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.params.ShapesParams" class="doc doc-heading">
            <code>ShapesParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#network_wrangler.params.ShapesParams" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">


      <p>Parameters for RoadShapesTable.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/params.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ShapesParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for RoadShapesTable.&quot;&quot;&quot;</span>

    <span class="n">primary_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;shape_id&quot;</span><span class="p">)</span>
    <span class="n">_addtl_unique_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[])</span>
    <span class="n">table_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;shapes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;shapes&quot;</span><span class="p">)</span>
    <span class="n">source_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">idx_col</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Column to make the index of the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span> <span class="o">+</span> <span class="s2">&quot;_idx&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unique_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List of unique ids for the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_addtl_unique_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primary_key</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.ShapesParams.idx_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">idx_col</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.ShapesParams.idx_col" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Column to make the index of the table.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="network_wrangler.params.ShapesParams.unique_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unique_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#network_wrangler.params.ShapesParams.unique_ids" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>List of unique ids for the table.</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="projects">Projects<a class="headerlink" href="#projects" title="Permanent link"> </a></h2>
<p>Projects are how you manipulate the networks. Each project type is defined in a module in the <code>projects</code> folder and accepts a RoadwayNetwork and or TransitNetwork as an input and returns the same objects (manipulated) as an output.  </p>
<h2 id="roadway">Roadway<a class="headerlink" href="#roadway" title="Permanent link"> </a></h2>
<p>The roadway module contains submodules which define and extend the links, nodes, and shapes dataframe objects which within a RoadwayNetwork object as well as other classes and methods which support and extend the RoadwayNetwork class.</p>
<h3 id="network-objects">Network Objects<a class="headerlink" href="#network-objects" title="Permanent link"> </a></h3>
<p>Submodules which define and extend the links, nodes, and shapes dataframe objects which within a RoadwayNetwork object.  Includes classes which define:</p>
<ul>
<li>dataframe schemas to be used for dataframe validation using <code>pandera</code></li>
<li>methods which extend the dataframes</li>
</ul>
<h4 id="links">Links<a class="headerlink" href="#links" title="Permanent link"> </a></h4>
<p>:: network_wrangler.roadway.links.io
:: network_wrangler.roadway.links.create
:: network_wrangler.roadway.links.delete
:: network_wrangler.roadway.links.edit
:: network_wrangler.roadway.links.filters
:: network_wrangler.roadway.links.geo
:: network_wrangler.roadway.links.scopes
:: network_wrangler.roadway.links.summary
:: network_wrangler.roadway.links.validate
:: network_wrangler.roadway.links.df_accessors</p>
<h4 id="nodes">Nodes<a class="headerlink" href="#nodes" title="Permanent link"> </a></h4>
<p>:: network_wrangler.roadway.nodes.io
:: network_wrangler.roadway.nodes.create
:: network_wrangler.roadway.nodes.delete
:: network_wrangler.roadway.nodes.edit
:: network_wrangler.roadway.nodes.filters
:: network_wrangler.roadway.nodes</p>
<h4 id="shapes">Shapes<a class="headerlink" href="#shapes" title="Permanent link"> </a></h4>
<p>:: network_wrangler.roadway.shapes.io
:: network_wrangler.roadway.shapes.create
:: network_wrangler.roadway.shapes.edit
:: network_wrangler.roadway.shapes.delete
:: network_wrangler.roadway.shapes.filters
:: network_wrangler.roadway.shapes.shapes</p>
<h3 id="supporting-classes-methods-parameters">Supporting Classes, Methods + Parameters<a class="headerlink" href="#supporting-classes-methods-parameters" title="Permanent link"> </a></h3>
<p>:: network_wrangler.roadway.segment
:: network_wrangler.roadway.subnet
:: network_wrangler.roadway.graph</p>
<h2 id="utils-and-functions">Utils and Functions<a class="headerlink" href="#utils-and-functions" title="Permanent link"> </a></h2>


<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.utils"></a>
    <div class="doc doc-contents first">

      <p>General utility functions used throughout package.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.check_one_or_one_superset_present" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_one_or_one_superset_present</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">,</span> <span class="n">all_fields_present</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.check_one_or_one_superset_present" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Checks that exactly one of the fields in mixed_list is in fields_present or one superset.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_one_or_one_superset_present</span><span class="p">(</span>
    <span class="n">mixed_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span> <span class="n">all_fields_present</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks that exactly one of the fields in mixed_list is in fields_present or one superset.&quot;&quot;&quot;</span>
    <span class="n">normalized_list</span> <span class="o">=</span> <span class="n">normalize_to_lists</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">)</span>

    <span class="n">list_items_present</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">normalized_list</span> <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">all_fields_present</span><span class="p">)]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_items_present</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">list_elements_subset_of_single_element</span><span class="p">(</span><span class="n">list_items_present</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.combine_unique_unhashable_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">combine_unique_unhashable_list</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.combine_unique_unhashable_list" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Combines lists preserving order of first and removing duplicates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>list1</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first list.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>list2</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second list.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new list containing the elements from list1 followed by the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>unique elements from list2.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>list1 = [1, 2, 3]
list2 = [2, 3, 4, 5]
combine_unique_unhashable_list(list1, list2)
[1, 2, 3, 4, 5]</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">combine_unique_unhashable_list</span><span class="p">(</span><span class="n">list1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">list2</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combines lists preserving order of first and removing duplicates.</span>

<span class="sd">    Args:</span>
<span class="sd">        list1 (list): The first list.</span>
<span class="sd">        list2 (list): The second list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A new list containing the elements from list1 followed by the</span>
<span class="sd">        unique elements from list2.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; list1 = [1, 2, 3]</span>
<span class="sd">        &gt;&gt;&gt; list2 = [2, 3, 4, 5]</span>
<span class="sd">        &gt;&gt;&gt; combine_unique_unhashable_list(list1, list2)</span>
<span class="sd">        [1, 2, 3, 4, 5]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list1</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list2</span><span class="p">]</span> <span class="o">+</span> <span class="n">list2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.delete_keys_from_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_keys_from_dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.delete_keys_from_dict" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Removes list of keys from potentially nested dictionary.</p>
<p>SOURCE: https://stackoverflow.com/questions/3405715/
User: @mseifert</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>dictionary</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary to remove keys from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>keys</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of keys to remove</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_keys_from_dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes list of keys from potentially nested dictionary.</span>

<span class="sd">    SOURCE: https://stackoverflow.com/questions/3405715/</span>
<span class="sd">    User: @mseifert</span>

<span class="sd">    Args:</span>
<span class="sd">        dictionary: dictionary to remove keys from</span>
<span class="sd">        keys: list of keys to remove</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keys_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>  <span class="c1"># Just an optimization for the &quot;if key in keys&quot; lookup.</span>

    <span class="n">modified_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys_set</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">modified_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">delete_keys_from_dict</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">keys_set</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">modified_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">value</span>  <span class="c1"># or copy.deepcopy(value) if a copy is desired for non-dicts.</span>
                <span class="p">)</span>
    <span class="k">return</span> <span class="n">modified_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.dict_to_hexkey" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dict_to_hexkey</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.dict_to_hexkey" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Converts a dictionary to a hexdigest of the sha1 hash of the dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>d</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary to convert to string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>hexdigest of the sha1 hash of dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dict_to_hexkey</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a dictionary to a hexdigest of the sha1 hash of the dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        d (dict): dictionary to convert to string</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: hexdigest of the sha1 hash of dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.findkeys" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">findkeys</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">kv</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.findkeys" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Returns values of all keys in various objects.</p>
<p>Adapted from arainchi on Stack Overflow:
https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">findkeys</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">kv</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns values of all keys in various objects.</span>

<span class="sd">    Adapted from arainchi on Stack Overflow:</span>
<span class="sd">    https://stackoverflow.com/questions/9807634/find-all-occurrences-of-a-key-in-nested-dictionaries-and-lists</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">findkeys</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">kv</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">x</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">kv</span> <span class="ow">in</span> <span class="n">node</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">node</span><span class="p">[</span><span class="n">kv</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">findkeys</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">kv</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.generate_list_of_new_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_list_of_new_ids</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">existing_ids</span><span class="p">,</span> <span class="n">id_scalar</span><span class="p">,</span> <span class="n">iter_val</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.generate_list_of_new_ids" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Generates a list of new IDs based on the input IDs, existing IDs, and other parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>input_ids</code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input IDs for which new IDs need to be generated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>existing_ids</code></td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The existing IDs that should be avoided when generating new IDs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>id_scalar</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The scalar value used to generate new IDs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iter_val</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The iteration value used in the generation process.
Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_iter</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of iterations allowed in the generation
process. Defaults to 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: A list of new IDs generated based on the input IDs and other parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_list_of_new_ids</span><span class="p">(</span>
    <span class="n">input_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">existing_ids</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">id_scalar</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">iter_val</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a list of new IDs based on the input IDs, existing IDs, and other parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_ids (list[str]): The input IDs for which new IDs need to be generated.</span>
<span class="sd">        existing_ids (pd.Series): The existing IDs that should be avoided when generating new IDs.</span>
<span class="sd">        id_scalar (int): The scalar value used to generate new IDs.</span>
<span class="sd">        iter_val (int, optional): The iteration value used in the generation process.</span>
<span class="sd">            Defaults to 10.</span>
<span class="sd">        max_iter (int, optional): The maximum number of iterations allowed in the generation</span>
<span class="sd">            process. Defaults to 1000.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: A list of new IDs generated based on the input IDs and other parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># keep new_ids as list to preserve order</span>
    <span class="n">new_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">existing_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">existing_ids</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">input_ids</span><span class="p">:</span>
        <span class="n">new_id</span> <span class="o">=</span> <span class="n">generate_new_id</span><span class="p">(</span>
            <span class="n">i</span><span class="p">,</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">existing_ids</span><span class="p">)),</span>
            <span class="n">id_scalar</span><span class="p">,</span>
            <span class="n">iter_val</span><span class="o">=</span><span class="n">iter_val</span><span class="p">,</span>
            <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">new_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_id</span><span class="p">)</span>
        <span class="n">existing_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_ids</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.generate_new_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_new_id</span><span class="p">(</span><span class="n">input_id</span><span class="p">,</span> <span class="n">existing_ids</span><span class="p">,</span> <span class="n">id_scalar</span><span class="p">,</span> <span class="n">iter_val</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.generate_new_id" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Generate a new ID that isn&rsquo;t in existing_ids.</p>
<p>TODO: check a registry rather than existing IDs</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>input_id</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>id to use to generate new id.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>existing_ids</code></td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>series that has existing IDs that should be unique</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>id_scalar</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scalar value to initially use to create the new id.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iter_val</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>iteration value to use in the generation process.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_iter</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>maximum number of iterations allowed in the generation process.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_new_id</span><span class="p">(</span>
    <span class="n">input_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">existing_ids</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">id_scalar</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">iter_val</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a new ID that isn&#39;t in existing_ids.</span>

<span class="sd">    TODO: check a registry rather than existing IDs</span>

<span class="sd">    Args:</span>
<span class="sd">        input_id: id to use to generate new id.</span>
<span class="sd">        existing_ids: series that has existing IDs that should be unique</span>
<span class="sd">        id_scalar: scalar value to initially use to create the new id.</span>
<span class="sd">        iter_val: iteration value to use in the generation process.</span>
<span class="sd">        max_iter: maximum number of iterations allowed in the generation process.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">str_prefix</span><span class="p">,</span> <span class="n">input_id</span><span class="p">,</span> <span class="n">str_suffix</span> <span class="o">=</span> <span class="n">split_string_prefix_suffix_from_num</span><span class="p">(</span><span class="n">input_id</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">new_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">str_prefix</span><span class="si">}{</span><span class="nb">int</span><span class="p">(</span><span class="n">input_id</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id_scalar</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">iter_val</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="si">}{</span><span class="n">str_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">new_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_ids</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_id</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">max_iter</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot generate new id within max iters of </span><span class="si">{</span><span class="n">max_iter</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot create unique new id.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.get_overlapping_range" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_overlapping_range</span><span class="p">(</span><span class="n">ranges</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.get_overlapping_range" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Returns the overlapping range for a list of ranges or tuples defining ranges.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>ranges</code></td>
            <td>
                  <code>list[<span title="typing.Union">Union</span>[tuple[int], range]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of ranges or tuples defining ranges.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[None, range]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[None, range]: The overlapping range if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ranges = [(1, 5), (3, 7), (6, 10)]
get_overlapping_range(ranges)
range(3, 5)</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_overlapping_range</span><span class="p">(</span><span class="n">ranges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">range</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">range</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the overlapping range for a list of ranges or tuples defining ranges.</span>

<span class="sd">    Args:</span>
<span class="sd">        ranges (list[Union[tuple[int], range]]): A list of ranges or tuples defining ranges.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[None, range]: The overlapping range if found, otherwise None.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ranges = [(1, 5), (3, 7), (6, 10)]</span>
<span class="sd">        &gt;&gt;&gt; get_overlapping_range(ranges)</span>
<span class="sd">        range(3, 5)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_ranges</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">range</span><span class="p">)</span> <span class="k">else</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ranges</span><span class="p">]</span>

    <span class="n">_overlap_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">_ranges</span><span class="p">)</span>
    <span class="n">_overlap_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">stop</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">_ranges</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_overlap_start</span> <span class="o">&lt;</span> <span class="n">_overlap_end</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">range</span><span class="p">(</span><span class="n">_overlap_start</span><span class="p">,</span> <span class="n">_overlap_end</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.list_elements_subset_of_single_element" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_elements_subset_of_single_element</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.list_elements_subset_of_single_element" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Find the first list in the mixed_list.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_elements_subset_of_single_element</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the first list in the mixed_list.&quot;&quot;&quot;</span>
    <span class="n">potential_supersets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">mixed_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">potential_supersets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>

    <span class="c1"># If no list is found, return False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">potential_supersets</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">normalized_list</span> <span class="o">=</span> <span class="n">normalize_to_lists</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">)</span>

    <span class="n">valid_supersets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">potential_supersets</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">normalized_list</span><span class="p">):</span>
            <span class="n">valid_supersets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_supersets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.make_slug" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_slug</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.make_slug" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Makes a slug from text.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_slug</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes a slug from text.&quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[,.;@#?!&amp;$&#39;]+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[\ ]+&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>  <span class="c1"># noqa: W605</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.normalize_to_lists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalize_to_lists</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.normalize_to_lists" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Turn a mixed list of scalars and lists into a list of lists.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">normalize_to_lists</span><span class="p">(</span><span class="n">mixed_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Turn a mixed list of scalars and lists into a list of lists.&quot;&quot;&quot;</span>
    <span class="n">normalized_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">mixed_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">normalized_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">normalized_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">normalized_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.split_string_prefix_suffix_from_num" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_string_prefix_suffix_from_num</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.split_string_prefix_suffix_from_num" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Split a string prefix and suffix from <em>last</em> number.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>input_string</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input string to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the prefix (including preceding numbers),
   the last numeric part as an integer, and the suffix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This function uses regular expressions to split a string into three parts:
the prefix, the last numeric part, and the suffix. The prefix includes any
preceding numbers, the last numeric part is converted to an integer, and
the suffix includes any non-digit characters after the last numeric part.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">split_string_prefix_suffix_from_num</span><span class="p">(</span><span class="s2">&quot;abc123def456&quot;</span><span class="p">)</span>
<span class="go">(&#39;abc&#39;, 123, &#39;def456&#39;)</span>
</code></pre></div>
    <div class="language-pycon highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">split_string_prefix_suffix_from_num</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="go">(&#39;hello&#39;, 0, &#39;&#39;)</span>
</code></pre></div>
    <div class="language-pycon highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">split_string_prefix_suffix_from_num</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span>
<span class="go">(&#39;&#39;, 123, &#39;&#39;)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split_string_prefix_suffix_from_num</span><span class="p">(</span><span class="n">input_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split a string prefix and suffix from *last* number.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_string (str): The input string to be processed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing the prefix (including preceding numbers),</span>
<span class="sd">               the last numeric part as an integer, and the suffix.</span>

<span class="sd">    Notes:</span>
<span class="sd">        This function uses regular expressions to split a string into three parts:</span>
<span class="sd">        the prefix, the last numeric part, and the suffix. The prefix includes any</span>
<span class="sd">        preceding numbers, the last numeric part is converted to an integer, and</span>
<span class="sd">        the suffix includes any non-digit characters after the last numeric part.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; split_string_prefix_suffix_from_num(&quot;abc123def456&quot;)</span>
<span class="sd">        (&#39;abc&#39;, 123, &#39;def456&#39;)</span>

<span class="sd">        &gt;&gt;&gt; split_string_prefix_suffix_from_num(&quot;hello&quot;)</span>
<span class="sd">        (&#39;hello&#39;, 0, &#39;&#39;)</span>

<span class="sd">        &gt;&gt;&gt; split_string_prefix_suffix_from_num(&quot;123&quot;)</span>
<span class="sd">        (&#39;&#39;, 123, &#39;&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">input_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(.*?)(\d+)(\D*)$&quot;</span><span class="p">)</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="c1"># Extract the groups: prefix (including preceding numbers), last numeric part, suffix</span>
        <span class="n">prefix</span><span class="p">,</span> <span class="n">numeric_part</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="c1"># Convert the numeric part to an integer</span>
        <span class="n">num_variable</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numeric_part</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">num_variable</span><span class="p">,</span> <span class="n">suffix</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">input_string</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.utils.topological_sort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">topological_sort</span><span class="p">(</span><span class="n">adjacency_list</span><span class="p">,</span> <span class="n">visited_list</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.utils.topological_sort" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Topological sorting for Acyclic Directed Graph.</p>
<p>Parameters:
- adjacency_list (dict): A dictionary representing the adjacency list of the graph.
- visited_list (list): A list representing the visited status of each vertex in the graph.</p>
<p>Returns:
- output_stack (list): A list containing the vertices in topological order.</p>
<p>This function performs a topological sort on an acyclic directed graph. It takes an adjacency
list and a visited list as input. The adjacency list represents the connections between
vertices in the graph, and the visited list keeps track of the visited status of each vertex.</p>
<p>The function uses a recursive helper function to perform the topological sort. It starts by
iterating over each vertex in the visited list. For each unvisited vertex, it calls the helper
function, which recursively visits all the neighbors of the vertex and adds them to the output
stack in reverse order. Finally, it returns the output stack, which contains the vertices in
topological order.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/utils.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">topological_sort</span><span class="p">(</span><span class="n">adjacency_list</span><span class="p">,</span> <span class="n">visited_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Topological sorting for Acyclic Directed Graph.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - adjacency_list (dict): A dictionary representing the adjacency list of the graph.</span>
<span class="sd">    - visited_list (list): A list representing the visited status of each vertex in the graph.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - output_stack (list): A list containing the vertices in topological order.</span>

<span class="sd">    This function performs a topological sort on an acyclic directed graph. It takes an adjacency</span>
<span class="sd">    list and a visited list as input. The adjacency list represents the connections between</span>
<span class="sd">    vertices in the graph, and the visited list keeps track of the visited status of each vertex.</span>

<span class="sd">    The function uses a recursive helper function to perform the topological sort. It starts by</span>
<span class="sd">    iterating over each vertex in the visited list. For each unvisited vertex, it calls the helper</span>
<span class="sd">    function, which recursively visits all the neighbors of the vertex and adds them to the output</span>
<span class="sd">    stack in reverse order. Finally, it returns the output stack, which contains the vertices in</span>
<span class="sd">    topological order.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output_stack</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_topology_sort_util</span><span class="p">(</span><span class="n">vertex</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">visited_list</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
            <span class="n">visited_list</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">adjacency_list</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
                <span class="n">_topology_sort_util</span><span class="p">(</span><span class="n">neighbor</span><span class="p">)</span>
            <span class="n">output_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">vertex</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">visited_list</span><span class="p">:</span>
        <span class="n">_topology_sort_util</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output_stack</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.io"></a>
    <div class="doc doc-contents first">

      <p>Helper functions for reading and writing files to reduce boilerplate.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.io.FileReadError" class="doc doc-heading">
            <code>FileReadError</code>


<a href="#network_wrangler.utils.io.FileReadError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when there is an error reading a file.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/io.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileReadError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when there is an error reading a file.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.io.FileWriteError" class="doc doc-heading">
            <code>FileWriteError</code>


<a href="#network_wrangler.utils.io.FileWriteError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when there is an error writing a file.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/io.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileWriteError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when there is an error writing a file.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.io.convert_file_serialization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_file_serialization</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boundary_gdf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_geocode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_filter_s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.io.convert_file_serialization" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert a file serialization format to another and optionally filter to a boundary.</p>
<p>If the input file is a JSON file that is larger than a reasonable portion of available
memory, <em>and</em> the output file is a Parquet file the JSON file will be read in chunks.</p>
<p>If the input file is a Geographic data type (shp, geojon, geoparquet) and a boundary is
provided, the data will be filtered to the boundary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>input_file</code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the input JSON or GEOJSON file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output Parquet file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>overwrite</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the output file if it exists.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_gdf</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame to filter the input data to. Only used for geographic data.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_geocode</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Geocode to filter the input data to. Only used for geographic data.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_file</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File to load as a boundary to filter the input data to. Only used for
geographic data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>node_filter_s</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, will filter links in .json file to only those that connect to
nodes. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>chunk_size</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of JSON objects to process in each chunk. Only works for
JSON to Parquet. If None, will determine if chunking needed and what size.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/io.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_file_serialization</span><span class="p">(</span>
    <span class="n">input_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">boundary_gdf</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boundary_geocode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boundary_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">node_filter_s</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a file serialization format to another and optionally filter to a boundary.</span>

<span class="sd">    If the input file is a JSON file that is larger than a reasonable portion of available</span>
<span class="sd">    memory, *and* the output file is a Parquet file the JSON file will be read in chunks.</span>

<span class="sd">    If the input file is a Geographic data type (shp, geojon, geoparquet) and a boundary is</span>
<span class="sd">    provided, the data will be filtered to the boundary.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_file: Path to the input JSON or GEOJSON file.</span>
<span class="sd">        output_file: Path to the output Parquet file.</span>
<span class="sd">        overwrite: If True, overwrite the output file if it exists.</span>
<span class="sd">        boundary_gdf: GeoDataFrame to filter the input data to. Only used for geographic data.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        boundary_geocode: Geocode to filter the input data to. Only used for geographic data.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        boundary_file: File to load as a boundary to filter the input data to. Only used for</span>
<span class="sd">            geographic data. Defaults to None.</span>
<span class="sd">        node_filter_s: If provided, will filter links in .json file to only those that connect to</span>
<span class="sd">            nodes. Defaults to None.</span>
<span class="sd">        chunk_size: Number of JSON objects to process in each chunk. Only works for</span>
<span class="sd">            JSON to Parquet. If None, will determine if chunking needed and what size.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converting </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2"> already exists and overwrite is False.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.json&quot;</span> <span class="ow">and</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.parquet&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chunk_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">chunk_size</span> <span class="o">=</span> <span class="n">_suggest_json_chunk_size</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chunk_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node_filter_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;A&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s2">&quot;B&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">node_filter_s</span><span class="p">)</span> <span class="o">|</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">node_filter_s</span><span class="p">)]</span>
            <span class="n">write_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_json_to_parquet_in_chunks</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">read_table</span><span class="p">(</span>
        <span class="n">input_file</span><span class="p">,</span>
        <span class="n">boundary_gdf</span><span class="o">=</span><span class="n">boundary_gdf</span><span class="p">,</span>
        <span class="n">boundary_geocode</span><span class="o">=</span><span class="n">boundary_geocode</span><span class="p">,</span>
        <span class="n">boundary_file</span><span class="o">=</span><span class="n">boundary_file</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">node_filter_s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;A&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="s2">&quot;B&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">node_filter_s</span><span class="p">)</span> <span class="o">|</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">node_filter_s</span><span class="p">)]</span>
    <span class="n">write_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.io.read_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_table</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sub_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_gdf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_geocode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.io.read_table" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Read file and return a dataframe or geodataframe.</p>
<p>If filename is a zip file, will unzip to a temporary directory.</p>
<p>If filename is a geojson or shapefile, will filter the data
to the boundary_gdf, boundary_geocode, or boundary_file if provided. Note that you can only
provide one of these boundary filters.</p>
<p>If filename is a geoparquet file, will filter the data to the <em>bounding box</em> of the
boundary_gdf, boundary_geocode, or boundary_file if provided. Note that you can only
provide one of these boundary filters.</p>
<p>NOTE:  if you are accessing multiple files from this zip file you will want to unzip it first
and THEN access the table files so you don&rsquo;t create multiple duplicate unzipped tmp dirs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>filename</code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sub_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the file is a zip, the sub_filename to load.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_gdf</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame to filter the input data to. Only used for geographic data.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_geocode</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Geocode to filter the input data to. Only used for geographic data.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_file</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File to load as a boundary to filter the input data to. Only used for
geographic data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/io.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_table</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">sub_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boundary_gdf</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boundary_geocode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boundary_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read file and return a dataframe or geodataframe.</span>

<span class="sd">    If filename is a zip file, will unzip to a temporary directory.</span>

<span class="sd">    If filename is a geojson or shapefile, will filter the data</span>
<span class="sd">    to the boundary_gdf, boundary_geocode, or boundary_file if provided. Note that you can only</span>
<span class="sd">    provide one of these boundary filters.</span>

<span class="sd">    If filename is a geoparquet file, will filter the data to the *bounding box* of the</span>
<span class="sd">    boundary_gdf, boundary_geocode, or boundary_file if provided. Note that you can only</span>
<span class="sd">    provide one of these boundary filters.</span>

<span class="sd">    NOTE:  if you are accessing multiple files from this zip file you will want to unzip it first</span>
<span class="sd">    and THEN access the table files so you don&#39;t create multiple duplicate unzipped tmp dirs.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (Path): filename to load.</span>
<span class="sd">        sub_filename: if the file is a zip, the sub_filename to load.</span>
<span class="sd">        boundary_gdf: GeoDataFrame to filter the input data to. Only used for geographic data.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        boundary_geocode: Geocode to filter the input data to. Only used for geographic data.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        boundary_file: File to load as a boundary to filter the input data to. Only used for</span>
<span class="sd">            geographic data. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input file </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.zip&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">unzip_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">/</span> <span class="n">sub_filename</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated read time: </span><span class="si">{</span><span class="n">_estimate_read_time_of_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># will result in None if no boundary is provided</span>
    <span class="n">mask_gdf</span> <span class="o">=</span> <span class="n">get_bounding_polygon</span><span class="p">(</span>
        <span class="n">boundary_gdf</span><span class="o">=</span><span class="n">boundary_gdf</span><span class="p">,</span>
        <span class="n">boundary_geocode</span><span class="o">=</span><span class="n">boundary_geocode</span><span class="p">,</span>
        <span class="n">boundary_file</span><span class="o">=</span><span class="n">boundary_file</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">x</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;shp&quot;</span><span class="p">,</span> <span class="s2">&quot;csv&quot;</span><span class="p">]]):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># masking only supported by fiona engine, which is slower.</span>
            <span class="k">if</span> <span class="n">mask_gdf</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;pyogrio&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask_gdf</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;fiona&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
            <span class="k">if</span> <span class="s2">&quot;csv&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">FileReadError</span>
    <span class="k">elif</span> <span class="s2">&quot;parquet&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_read_parquet_table</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mask_gdf</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;json&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filetype </span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2"> not implemented.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.io.unzip_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unzip_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.io.unzip_file" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Unzips a file to a temporary directory and returns the directory path.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/io.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unzip_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unzips a file to a temporary directory and returns the directory path.&quot;&quot;&quot;</span>
    <span class="n">tmpdir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">unpack_archive</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tmpdir</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finalize</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span>

    <span class="c1"># Lazy cleanup</span>
    <span class="n">weakref</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="n">finalize</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tmpdir</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.io.write_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.io.write_table" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Write a dataframe or geodataframe to a file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>filename</code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename to write to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>overwrite</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to overwrite the file if it exists. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>additional arguments to pass to the writer.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/io.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_table</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">],</span>
    <span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a dataframe or geodataframe to a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): dataframe to write.</span>
<span class="sd">        filename (Path): filename to write to.</span>
<span class="sd">        overwrite (bool): whether to overwrite the file if it exists. Defaults to False.</span>
<span class="sd">        kwargs: additional arguments to pass to the writer.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> already exists and overwrite is False.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">filename</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Writing to </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;shp&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;parquet&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;csv&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;txt&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;geojson&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="c1"># required due to issues with list-like columns</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">drop_id</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">&quot;json&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filetype </span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2"> not implemented.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.models"></a>
    <div class="doc doc-contents first">

      <p>Helper functions for data models.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.models.DatamodelDataframeIncompatableError" class="doc doc-heading">
            <code>DatamodelDataframeIncompatableError</code>


<a href="#network_wrangler.utils.models.DatamodelDataframeIncompatableError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when a data model and a dataframe are not compatable.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DatamodelDataframeIncompatableError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a data model and a dataframe are not compatable.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.models.TableValidationError" class="doc doc-heading">
            <code>TableValidationError</code>


<a href="#network_wrangler.utils.models.TableValidationError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when a table validation fails.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TableValidationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a table validation fails.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.models.coerce_extra_fields_to_type_in_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coerce_extra_fields_to_type_in_df</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.models.coerce_extra_fields_to_type_in_df" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Coerce extra fields in data that aren&rsquo;t specified in Pydantic model to the type in the df.</p>
<p>Note: will not coerce lists of submodels, etc.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to coerce.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td>
                  <code><span title="pydantic.BaseModel">BaseModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Pydantic model to validate the data against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame to coerce the data to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">coerce_extra_fields_to_type_in_df</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coerce extra fields in data that aren&#39;t specified in Pydantic model to the type in the df.</span>

<span class="sd">    Note: will not coerce lists of submodels, etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (dict): The data to coerce.</span>
<span class="sd">        model (BaseModel): The Pydantic model to validate the data against.</span>
<span class="sd">        df (pd.DataFrame): The DataFrame to coerce the data to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Coerce submodels</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">submodel_fields_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">out_data</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">coerce_extra_fields_to_type_in_df</span><span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">df</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">extra_attributes_undefined_in_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">coerce_val_to_df_types</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">model_extra</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="n">df</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DatamodelDataframeIncompatableError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">out_data</span><span class="o">.</span><span class="n">model_extra</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">out_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.models.default_from_datamodel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">default_from_datamodel</span><span class="p">(</span><span class="n">data_model</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.models.default_from_datamodel" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Returns default value from pandera data model for a given field name.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">default_from_datamodel</span><span class="p">(</span><span class="n">data_model</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">DataFrameModel</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns default value from pandera data model for a given field name.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">data_model</span><span class="o">.</span><span class="n">__fields__</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data_model</span><span class="o">.</span><span class="n">__fields__</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;default&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">data_model</span><span class="o">.</span><span class="n">__fields__</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">default</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.models.empty_df_from_datamodel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">empty_df_from_datamodel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">LAT_LON_CRS</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.models.empty_df_from_datamodel" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Create an empty DataFrame or GeoDataFrame with the specified columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td>
                  <code><span title="pydantic.BaseModel">BaseModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pandera data model to create empty [Geo]DataFrame from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>crs</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if schema has geometry, will use this as the geometry&rsquo;s crs. Defaults to LAT_LONG_CRS</p>
              </div>
            </td>
            <td>
                  <code><span title="network_wrangler.params.LAT_LON_CRS">LAT_LON_CRS</span></code>
            </td>
          </tr>
      </tbody>
    </table>
      

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">empty_df_from_datamodel</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">DataFrameModel</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">LAT_LON_CRS</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an empty DataFrame or GeoDataFrame with the specified columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (BaseModel): A pandera data model to create empty [Geo]DataFrame from.</span>
<span class="sd">        crs: if schema has geometry, will use this as the geometry&#39;s crs. Defaults to LAT_LONG_CRS</span>
<span class="sd">    Returns:</span>
<span class="sd">        An empty [Geo]DataFrame that validates to the specified model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to_schema</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>

    <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">model</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.models.extra_attributes_undefined_in_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra_attributes_undefined_in_model</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.models.extra_attributes_undefined_in_model" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Find the extra attributes in a pydantic model that are not defined in the model.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extra_attributes_undefined_in_model</span><span class="p">(</span><span class="n">instance</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the extra attributes in a pydantic model that are not defined in the model.&quot;&quot;&quot;</span>
    <span class="n">defined_fields</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model_fields</span>
    <span class="n">all_attributes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">extra_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">all_attributes</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">defined_fields</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">extra_attributes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.models.identify_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">identify_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.models.identify_model" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Identify the model that the input data conforms to.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input data to identify.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>models</code></td>
            <td>
                  <code>list[<span title="pandera.DataFrameModel">DataFrameModel</span>, <span title="pydantic.BaseModel">BaseModel</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of models to validate the input
data against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">identify_model</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">models</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DataFrameModel</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DataFrameModel</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify the model that the input data conforms to.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Union[pd.DataFrame, dict]): The input data to identify.</span>
<span class="sd">        models (list[DataFrameModel,BaseModel]): A list of models to validate the input</span>
<span class="sd">          data against.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="n">validate_df_to_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">m</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">m</span>
        <span class="k">except</span> <span class="n">ValidationError</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">except</span> <span class="n">SchemaError</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;The input data isn&#39;t consistant with any provided data model.</span><span class="se">\</span>
<span class="s2">                         </span><span class="se">\n</span><span class="s2">Input data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="se">\</span>
<span class="s2">                         </span><span class="se">\n</span><span class="s2">Data Models: </span><span class="si">{</span><span class="n">models</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input dictionary does not conform to any of the provided models.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.models.submodel_fields_in_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">submodel_fields_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.models.submodel_fields_in_model" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Find the fields in a pydantic model that are submodels.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">submodel_fields_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the fields in a pydantic model that are submodels.&quot;&quot;&quot;</span>
    <span class="n">types</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">model_type</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">ModelMetaclass</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">]</span>
    <span class="n">submodels</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">model_fields</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">model_type</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">defined</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">submodels</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">defined</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">submodels</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.models.validate_df_to_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_df_to_model</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;validation_failure_cases.csv&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.models.validate_df_to_model" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Wrapper to validate a DataFrame against a Pandera DataFrameModel with better logging.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td>
                  <code><span title="pandera.DataFrameModel">DataFrameModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandera DataFrameModel to validate against.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output_file</code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional file to write validation errors to. Defaults to
validation_failure_cases.csv.</p>
              </div>
            </td>
            <td>
                  <code>&#39;validation_failure_cases.csv&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/models.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">validate_df_to_model</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">DataFrameModel</span><span class="p">,</span> <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;validation_failure_cases.csv&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to validate a DataFrame against a Pandera DataFrameModel with better logging.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: DataFrame to validate.</span>
<span class="sd">        model: Pandera DataFrameModel to validate against.</span>
<span class="sd">        output_file: Optional file to write validation errors to. Defaults to</span>
<span class="sd">            validation_failure_cases.csv.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">model_df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">model_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="n">default_from_datamodel</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">model_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">model_df</span><span class="p">[</span><span class="n">c</span><span class="p">]),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">model_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">default_value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">model_df</span>

    <span class="k">except</span> <span class="n">SchemaErrors</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Log the summary of errors</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Validation to </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> failed with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">failure_cases</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">            errors: </span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">failure_cases</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># If there are many errors, save them to a file</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">failure_cases</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">error_file</span> <span class="o">=</span> <span class="n">output_file</span>
            <span class="n">e</span><span class="o">.</span><span class="n">failure_cases</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">error_file</span><span class="p">)</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detailed error cases written to </span><span class="si">{</span><span class="n">error_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise log the errors directly</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Detailed failure cases:</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">failure_cases</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">TableValidationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation to </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> failed.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">SchemaError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation to </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> failed with error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failure Cases:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">failure_cases</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">TableValidationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validation to </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> failed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.net"></a>
    <div class="doc doc-contents first">

      <p>Functions to help with network manipulations in dataframes.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.net.point_seq_to_links" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">point_seq_to_links</span><span class="p">(</span><span class="n">point_seq_df</span><span class="p">,</span> <span class="n">id_field</span><span class="p">,</span> <span class="n">seq_field</span><span class="p">,</span> <span class="n">node_id_field</span><span class="p">,</span> <span class="n">from_field</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">to_field</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.net.point_seq_to_links" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Translates a df with tidy data representing a sequence of points into links.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>point_seq_df</code></td>
            <td>
                  <code><span title="network_wrangler.utils.df_accessors.pd.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe with source breadcrumbs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>id_field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Trace ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>seq_field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of breadcrumbs within ID_field</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>node_id_field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>field denoting the node ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>from_field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Field to export from_field to. Defaults to &ldquo;A&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;A&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>to_field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Field to export to_field to. Defaults to &ldquo;B&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;B&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Link records with id_field, from_field, to_field</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/net.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">point_seq_to_links</span><span class="p">(</span>
    <span class="n">point_seq_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">id_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">seq_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">node_id_field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">from_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="n">to_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Translates a df with tidy data representing a sequence of points into links.</span>

<span class="sd">    Args:</span>
<span class="sd">        point_seq_df (pd.DataFrame): Dataframe with source breadcrumbs</span>
<span class="sd">        id_field (str): Trace ID</span>
<span class="sd">        seq_field (str): Order of breadcrumbs within ID_field</span>
<span class="sd">        node_id_field (str): field denoting the node ID</span>
<span class="sd">        from_field (str, optional): Field to export from_field to. Defaults to &quot;A&quot;.</span>
<span class="sd">        to_field (str, optional): Field to export to_field to. Defaults to &quot;B&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Link records with id_field, from_field, to_field</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">point_seq_df</span> <span class="o">=</span> <span class="n">point_seq_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">id_field</span><span class="p">,</span> <span class="n">seq_field</span><span class="p">])</span>

    <span class="n">links</span> <span class="o">=</span> <span class="n">point_seq_df</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">from_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">point_seq_df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">to_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">links</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="n">links</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">id_field</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">to_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">links</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">id_field</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">from_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]]</span>

    <span class="n">links</span> <span class="o">=</span> <span class="n">links</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">id_field</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">to_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">links</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">id_field</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">from_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">id_field</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node_id_field</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">from_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">from_field</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node_id_field</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">to_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">to_field</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">links</span> <span class="o">=</span> <span class="n">links</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">from_field</span><span class="p">,</span> <span class="n">to_field</span><span class="p">])</span>
    <span class="c1"># Since join with a shift() has some NAs, we need to recast the columns to int</span>
    <span class="n">_int_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_field</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">seq_field</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">to_field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="n">links</span><span class="p">[</span><span class="n">_int_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">links</span><span class="p">[</span><span class="n">_int_cols</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">links</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.time"></a>
    <div class="doc doc-contents first">

      <p>Functions related to parsing and comparing time objects and series.</p>
<p>Internal function terminology for timespan scopes:</p>
<ul>
<li><code>matching</code>: a scope that could be applied for a given timespan combination.
    This includes the default timespan as well as scopes wholely contained within.</li>
<li><code>overlapping</code>: a timespan that fully or partially overlaps a given timespan.
    This includes the default timespan, all <code>matching</code> timespans and all timespans where
    at least one minute overlap.</li>
<li><code>conflicting</code>: a timespan that is overlapping but not matching. By definition default
     scope values are not conflicting.</li>
<li><code>independent</code> a timespan that is not overlapping.</li>
</ul>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.convert_timespan_to_start_end_dt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_timespan_to_start_end_dt</span><span class="p">(</span><span class="n">timespan_s</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.convert_timespan_to_start_end_dt" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Covert a timespan string [&lsquo;12:00&rsquo;,&lsquo;14:00] to start_time and end_time datetime cols in df.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_timespan_to_start_end_dt</span><span class="p">(</span><span class="n">timespan_s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Covert a timespan string [&#39;12:00&#39;,&#39;14:00] to start_time and end_time datetime cols in df.&quot;&quot;&quot;</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">timespan_s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">str_to_time</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">timespan_s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">str_to_time</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="n">start_time</span><span class="p">,</span> <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="n">end_time</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.dt_contains" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dt_contains</span><span class="p">(</span><span class="n">timespan1</span><span class="p">,</span> <span class="n">timespan2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.dt_contains" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if one timespan inclusively contains another.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>timespan1</code></td>
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="network_wrangler.utils.time" href="#network_wrangler.utils.time">time</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first timespan represented as a list containing the start
time and end time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>timespan2</code></td>
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="network_wrangler.utils.time" href="#network_wrangler.utils.time">time</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second timespan represented as a list containing the start
time and end time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the first timespan contains the second timespan, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span> <span class="nf">dt_contains</span><span class="p">(</span><span class="n">timespan1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span> <span class="n">timespan2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if one timespan inclusively contains another.</span>

<span class="sd">    Args:</span>
<span class="sd">        timespan1 (list[time]): The first timespan represented as a list containing the start</span>
<span class="sd">            time and end time.</span>
<span class="sd">        timespan2 (list[time]): The second timespan represented as a list containing the start</span>
<span class="sd">            time and end time.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the first timespan contains the second timespan, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_time_dt</span><span class="p">,</span> <span class="n">end_time_dt</span> <span class="o">=</span> <span class="n">timespan1</span>
    <span class="n">start_time_dt2</span><span class="p">,</span> <span class="n">end_time_dt2</span> <span class="o">=</span> <span class="n">timespan2</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">start_time_dt</span> <span class="o">&lt;=</span> <span class="n">start_time_dt2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_time_dt</span> <span class="o">&gt;=</span> <span class="n">end_time_dt2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.dt_list_overlaps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dt_list_overlaps</span><span class="p">(</span><span class="n">timespans</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.dt_list_overlaps" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if any of the timespans overlap.</p>
<p><code>overlapping</code>: a timespan that fully or partially overlaps a given timespan.
This includes and all timespans where at least one minute overlap.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span> <span class="nf">dt_list_overlaps</span><span class="p">(</span><span class="n">timespans</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if any of the timespans overlap.</span>

<span class="sd">    `overlapping`: a timespan that fully or partially overlaps a given timespan.</span>
<span class="sd">    This includes and all timespans where at least one minute overlap.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_dt_list_to_overlaps</span><span class="p">(</span><span class="n">timespans</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.dt_overlap_duration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dt_overlap_duration</span><span class="p">(</span><span class="n">timedelta1</span><span class="p">,</span> <span class="n">timedelta2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.dt_overlap_duration" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if two timespans overlap and return the amount of overlap.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span> <span class="nf">dt_overlap_duration</span><span class="p">(</span><span class="n">timedelta1</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">timedelta2</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two timespans overlap and return the amount of overlap.&quot;&quot;&quot;</span>
    <span class="n">overlap_start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">timedelta1</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="n">timedelta2</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span>
    <span class="n">overlap_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">timedelta1</span><span class="o">.</span><span class="n">end_time</span><span class="p">,</span> <span class="n">timedelta2</span><span class="o">.</span><span class="n">end_time</span><span class="p">)</span>
    <span class="n">overlap_duration</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">overlap_end</span> <span class="o">-</span> <span class="n">overlap_start</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">overlap_duration</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.dt_overlaps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dt_overlaps</span><span class="p">(</span><span class="n">timespan1</span><span class="p">,</span> <span class="n">timespan2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.dt_overlaps" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if two timespans overlap.</p>
<p><code>overlapping</code>: a timespan that fully or partially overlaps a given timespan.
This includes and all timespans where at least one minute overlap.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span> <span class="nf">dt_overlaps</span><span class="p">(</span><span class="n">timespan1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span> <span class="n">timespan2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two timespans overlap.</span>

<span class="sd">    `overlapping`: a timespan that fully or partially overlaps a given timespan.</span>
<span class="sd">    This includes and all timespans where at least one minute overlap.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">timespan1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">timespan2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">timespan2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">timespan1</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.dt_to_seconds_from_midnight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dt_to_seconds_from_midnight</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.dt_to_seconds_from_midnight" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert a datetime object to the number of seconds since midnight.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dt_to_seconds_from_midnight</span><span class="p">(</span><span class="n">dt</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a datetime object to the number of seconds since midnight.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dt</span> <span class="o">-</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.duration_dt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">duration_dt</span><span class="p">(</span><span class="n">start_time_dt</span><span class="p">,</span> <span class="n">end_time_dt</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.duration_dt" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Returns a datetime.timedelta object representing the duration of the timespan.</p>
<p>If end_time is less than start_time, the duration will assume that it crosses over
midnight.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">duration_dt</span><span class="p">(</span><span class="n">start_time_dt</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">end_time_dt</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a datetime.timedelta object representing the duration of the timespan.</span>

<span class="sd">    If end_time is less than start_time, the duration will assume that it crosses over</span>
<span class="sd">    midnight.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">end_time_dt</span> <span class="o">&lt;</span> <span class="n">start_time_dt</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span>
            <span class="n">hours</span><span class="o">=</span><span class="mi">24</span> <span class="o">-</span> <span class="n">start_time_dt</span><span class="o">.</span><span class="n">hour</span> <span class="o">+</span> <span class="n">end_time_dt</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span>
            <span class="n">minutes</span><span class="o">=</span><span class="n">end_time_dt</span><span class="o">.</span><span class="n">minute</span> <span class="o">-</span> <span class="n">start_time_dt</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span>
            <span class="n">seconds</span><span class="o">=</span><span class="n">end_time_dt</span><span class="o">.</span><span class="n">second</span> <span class="o">-</span> <span class="n">start_time_dt</span><span class="o">.</span><span class="n">second</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">end_time_dt</span> <span class="o">-</span> <span class="n">start_time_dt</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.filter_df_to_max_overlapping_timespans" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_df_to_max_overlapping_timespans</span><span class="p">(</span><span class="n">orig_df</span><span class="p">,</span> <span class="n">query_timespan</span><span class="p">,</span> <span class="n">strict_match</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_overlap_minutes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keep_max_of_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;model_link_id&#39;</span><span class="p">])</span></code>

<a href="#network_wrangler.utils.time.filter_df_to_max_overlapping_timespans" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Filters dataframe for entries that have maximum overlap with the given query timespan.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>orig_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe to query timespans for with <code>start_time</code> and <code>end_time</code> fields.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>query_timespan</code></td>
            <td>
                  <code>list[<span title="network_wrangler.models._base.types.TimeString">TimeString</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimespanString of format [&lsquo;HH:MM&rsquo;,&rsquo;HH:MM&rsquo;] to query orig_df for overlapping
records.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>strict_match</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>boolean indicating if the returned df should only contain
records that fully contain the query timespan. If set to True, min_overlap_minutes
does not apply. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>min_overlap_minutes</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>minimum number of minutes the timespans need to overlap to keep.
Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>keep_max_of_cols</code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of fields to return the maximum value of overlap for.  If None,
will return all overlapping time periods. Defaults to <code>['model_link_id']</code></p>
              </div>
            </td>
            <td>
                  <code>[&#39;model_link_id&#39;]</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filter_df_to_max_overlapping_timespans</span><span class="p">(</span>
    <span class="n">orig_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">query_timespan</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TimeString</span><span class="p">],</span>
    <span class="n">strict_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">min_overlap_minutes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">keep_max_of_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;model_link_id&quot;</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters dataframe for entries that have maximum overlap with the given query timespan.</span>

<span class="sd">    Args:</span>
<span class="sd">        orig_df: dataframe to query timespans for with `start_time` and `end_time` fields.</span>
<span class="sd">        query_timespan: TimespanString of format [&#39;HH:MM&#39;,&#39;HH:MM&#39;] to query orig_df for overlapping</span>
<span class="sd">            records.</span>
<span class="sd">        strict_match: boolean indicating if the returned df should only contain</span>
<span class="sd">            records that fully contain the query timespan. If set to True, min_overlap_minutes</span>
<span class="sd">            does not apply. Defaults to False.</span>
<span class="sd">        min_overlap_minutes: minimum number of minutes the timespans need to overlap to keep.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        keep_max_of_cols: list of fields to return the maximum value of overlap for.  If None,</span>
<span class="sd">            will return all overlapping time periods. Defaults to `[&#39;model_link_id&#39;]`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_start</span><span class="p">,</span> <span class="n">q_end</span> <span class="o">=</span> <span class="n">str_to_time_list</span><span class="p">(</span><span class="n">query_timespan</span><span class="p">)</span>

    <span class="n">overlap_start</span> <span class="o">=</span> <span class="n">orig_df</span><span class="p">[</span><span class="s2">&quot;start_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">q_start</span><span class="p">,</span> <span class="nb">max</span><span class="p">)</span>
    <span class="n">overlap_end</span> <span class="o">=</span> <span class="n">orig_df</span><span class="p">[</span><span class="s2">&quot;end_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">q_end</span><span class="p">,</span> <span class="nb">min</span><span class="p">)</span>
    <span class="n">orig_df</span><span class="p">[</span><span class="s2">&quot;overlap_duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">overlap_end</span> <span class="o">-</span> <span class="n">overlap_start</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">60</span>

    <span class="k">if</span> <span class="n">strict_match</span><span class="p">:</span>
        <span class="n">overlap_df</span> <span class="o">=</span> <span class="n">orig_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">orig_df</span><span class="o">.</span><span class="n">start_time</span> <span class="o">&lt;=</span> <span class="n">q_start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">orig_df</span><span class="o">.</span><span class="n">end_time</span> <span class="o">&gt;=</span> <span class="n">q_end</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">overlap_df</span> <span class="o">=</span> <span class="n">orig_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">orig_df</span><span class="o">.</span><span class="n">overlap_duration</span> <span class="o">&gt;</span> <span class="n">min_overlap_minutes</span><span class="p">]</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;overlap_df: </span><span class="se">\n</span><span class="si">{</span><span class="n">overlap_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">keep_max_of_cols</span><span class="p">:</span>
        <span class="c1"># keep only the maximum overlap</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">overlap_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">keep_max_of_cols</span><span class="p">)[</span><span class="s2">&quot;overlap_duration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
        <span class="n">overlap_df</span> <span class="o">=</span> <span class="n">overlap_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">overlap_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.filter_df_to_overlapping_timespans" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_df_to_overlapping_timespans</span><span class="p">(</span><span class="n">orig_df</span><span class="p">,</span> <span class="n">query_timespan</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.filter_df_to_overlapping_timespans" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Filters dataframe for entries that have any overlap with the given query timespan.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>orig_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe to query timespans for with <code>start_time</code> and <code>end_time</code> fields.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>query_timespan</code></td>
            <td>
                  <code>list[<span title="network_wrangler.models._base.types.TimeString">TimeString</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimespanString of format [&lsquo;HH:MM&rsquo;,&rsquo;HH:MM&rsquo;] to query orig_df for overlapping
records.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">filter_df_to_overlapping_timespans</span><span class="p">(</span>
    <span class="n">orig_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">query_timespan</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TimeString</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters dataframe for entries that have any overlap with the given query timespan.</span>

<span class="sd">    Args:</span>
<span class="sd">        orig_df: dataframe to query timespans for with `start_time` and `end_time` fields.</span>
<span class="sd">        query_timespan: TimespanString of format [&#39;HH:MM&#39;,&#39;HH:MM&#39;] to query orig_df for overlapping</span>
<span class="sd">            records.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q_start</span><span class="p">,</span> <span class="n">q_end</span> <span class="o">=</span> <span class="n">str_to_time_list</span><span class="p">(</span><span class="n">query_timespan</span><span class="p">)</span>
    <span class="c1"># WranglerLogger.debug(f&quot;q_start_time: {q_start}&quot;)</span>
    <span class="c1"># WranglerLogger.debug(f&quot;q_end_time:{q_end}&quot;)</span>
    <span class="c1"># make sure start_time and end_time are datetime objects</span>
    <span class="n">df_start_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">orig_df</span><span class="p">[</span><span class="s2">&quot;start_time&quot;</span><span class="p">])</span>
    <span class="n">df_end_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">orig_df</span><span class="p">[</span><span class="s2">&quot;end_time&quot;</span><span class="p">])</span>

    <span class="c1"># WranglerLogger.debug(f&quot;df_start_time: \n{df_start_time}&quot;)</span>
    <span class="c1"># WranglerLogger.debug(f&quot;df_end_time: \n{df_end_time}&quot;)</span>
    <span class="n">overlap_df</span> <span class="o">=</span> <span class="n">orig_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_start_time</span> <span class="o">&lt;</span> <span class="n">q_end</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_end_time</span> <span class="o">&gt;</span> <span class="n">q_start</span><span class="p">)]</span>

    <span class="c1"># WranglerLogger.debug(f&quot;time overlap_df: \n{overlap_df}&quot;)</span>
    <span class="k">return</span> <span class="n">overlap_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.filter_dt_list_to_overlaps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_dt_list_to_overlaps</span><span class="p">(</span><span class="n">timespans</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.filter_dt_list_to_overlaps" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Filter a list of timespans to only include those that overlap.</p>
<p><code>overlapping</code>: a timespan that fully or partially overlaps a given timespan.
This includes and all timespans where at least one minute overlap.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span> <span class="nf">filter_dt_list_to_overlaps</span><span class="p">(</span><span class="n">timespans</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter a list of timespans to only include those that overlap.</span>

<span class="sd">    `overlapping`: a timespan that fully or partially overlaps a given timespan.</span>
<span class="sd">    This includes and all timespans where at least one minute overlap.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">overlaps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">timespans</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">timespans</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">dt_overlaps</span><span class="p">(</span><span class="n">timespans</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">timespans</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
                <span class="n">overlaps</span> <span class="o">+=</span> <span class="p">[</span><span class="n">timespans</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">timespans</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>

    <span class="c1"># remove dupes</span>
    <span class="n">overlaps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">overlaps</span><span class="p">))))</span>
    <span class="k">return</span> <span class="n">overlaps</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.format_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_time</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.format_time" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Formats seconds into a human-friendly string for log files.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_time</span><span class="p">(</span><span class="n">seconds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Formats seconds into a human-friendly string for log files.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span><span class="si">}</span><span class="s2"> seconds&quot;</span>
    <span class="k">elif</span> <span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">3600</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">seconds</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="si">}</span><span class="s2"> minutes&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds</span> <span class="o">//</span> <span class="mi">3600</span><span class="p">)</span>
        <span class="n">minutes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">seconds</span> <span class="o">%</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">//</span> <span class="mi">60</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hours</span><span class="si">}</span><span class="s2"> hours and </span><span class="si">{</span><span class="n">minutes</span><span class="si">}</span><span class="s2"> minutes&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.seconds_from_midnight_to_str" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">seconds_from_midnight_to_str</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.seconds_from_midnight_to_str" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert the number of seconds since midnight to a TimeString (HH:MM).</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seconds_from_midnight_to_str</span><span class="p">(</span><span class="n">seconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeString</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the number of seconds since midnight to a TimeString (HH:MM).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">seconds</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.str_to_seconds_from_midnight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">str_to_seconds_from_midnight</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.str_to_seconds_from_midnight" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert a TimeString (HH:MM&lt;:SS&gt;) to the number of seconds since midnight.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">str_to_seconds_from_midnight</span><span class="p">(</span><span class="n">time_str</span><span class="p">:</span> <span class="n">TimeString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a TimeString (HH:MM&lt;:SS&gt;) to the number of seconds since midnight.&quot;&quot;&quot;</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">str_to_time</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dt_to_seconds_from_midnight</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.str_to_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">str_to_time</span><span class="p">(</span><span class="n">time_str</span><span class="p">,</span> <span class="n">base_date</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.str_to_time" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert TimeString (HH:MM&lt;:SS&gt;) to datetime object.</p>
<p>If HH &gt; 24, will add a day to the base_date.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>time_str</code></td>
            <td>
                  <code><span title="network_wrangler.models._base.types.TimeString">TimeString</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeString in HH:MM:SS or HH:MM format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>base_date</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime.date">date</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional date to base the datetime on. Defaults to None.
If not provided, will use today.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">str_to_time</span><span class="p">(</span><span class="n">time_str</span><span class="p">:</span> <span class="n">TimeString</span><span class="p">,</span> <span class="n">base_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert TimeString (HH:MM&lt;:SS&gt;) to datetime object.</span>

<span class="sd">    If HH &gt; 24, will add a day to the base_date.</span>

<span class="sd">    Args:</span>
<span class="sd">        time_str: TimeString in HH:MM:SS or HH:MM format.</span>
<span class="sd">        base_date: optional date to base the datetime on. Defaults to None.</span>
<span class="sd">            If not provided, will use today.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Set the base date to today if not provided</span>
    <span class="k">if</span> <span class="n">base_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">base_date</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>

    <span class="c1"># Split the time string to extract hours, minutes, and seconds</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">time_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">minutes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="c1"># Calculate total number of days to add to base_date based on hours</span>
    <span class="n">days_to_add</span> <span class="o">=</span> <span class="n">hours</span> <span class="o">//</span> <span class="mi">24</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="n">hours</span> <span class="o">%</span> <span class="mi">24</span>

    <span class="c1"># Create a time object with the adjusted hours, minutes, and seconds</span>
    <span class="n">adjusted_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hours</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">minutes</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">seconds</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Combine the base date with the adjusted time and add the extra days if needed</span>
    <span class="n">combined_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">base_date</span><span class="p">,</span> <span class="n">adjusted_time</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days_to_add</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">combined_datetime</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.str_to_time_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">str_to_time_list</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.str_to_time_list" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert list of TimeStrings (HH:MM&lt;:SS&gt;) to list of datetime.time objects.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">str_to_time_list</span><span class="p">(</span><span class="n">timespan</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TimeString</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert list of TimeStrings (HH:MM&lt;:SS&gt;) to list of datetime.time objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">str_to_time</span><span class="p">,</span> <span class="n">timespan</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.timespan_str_list_to_dt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">timespan_str_list_to_dt</span><span class="p">(</span><span class="n">timespans</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.timespan_str_list_to_dt" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert list of TimespanStrings to list of datetime.time objects.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">timespan_str_list_to_dt</span><span class="p">(</span><span class="n">timespans</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TimespanString</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">datetime</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert list of TimespanStrings to list of datetime.time objects.&quot;&quot;&quot;</span>
    <span class="p">[</span><span class="n">str_to_time_list</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">timespans</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.time.timespans_overlap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">timespans_overlap</span><span class="p">(</span><span class="n">timespan1</span><span class="p">,</span> <span class="n">timespan2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.time.timespans_overlap" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if two timespan strings overlap.</p>
<p><code>overlapping</code>: a timespan that fully or partially overlaps a given timespan.
This includes and all timespans where at least one minute overlap.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/time.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">timespans_overlap</span><span class="p">(</span><span class="n">timespan1</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TimespanString</span><span class="p">],</span> <span class="n">timespan2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TimespanString</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two timespan strings overlap.</span>

<span class="sd">    `overlapping`: a timespan that fully or partially overlaps a given timespan.</span>
<span class="sd">    This includes and all timespans where at least one minute overlap.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">timespan1</span> <span class="o">=</span> <span class="n">str_to_time_list</span><span class="p">(</span><span class="n">timespan1</span><span class="p">)</span>
    <span class="n">timespan2</span> <span class="o">=</span> <span class="n">str_to_time_list</span><span class="p">(</span><span class="n">timespan2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dt_overlaps</span><span class="p">(</span><span class="n">timespan1</span><span class="p">,</span> <span class="n">timespan2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.data"></a>
    <div class="doc doc-contents first">

      <p>Utility functions for pandas data manipulation.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.data.InvalidJoinFieldError" class="doc doc-heading">
            <code>InvalidJoinFieldError</code>


<a href="#network_wrangler.utils.data.InvalidJoinFieldError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when the join field is not unique.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidJoinFieldError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when the join field is not unique.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.data.MissingPropertiesError" class="doc doc-heading">
            <code>MissingPropertiesError</code>


<a href="#network_wrangler.utils.data.MissingPropertiesError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when properties are missing from the dataframe.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MissingPropertiesError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when properties are missing from the dataframe.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.attach_parameters_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">attach_parameters_to_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.attach_parameters_to_df" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Attatch params as a dataframe attribute which will be copied with dataframe.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">attach_parameters_to_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Attatch params as a dataframe attribute which will be copied with dataframe.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;params&quot;</span><span class="p">):</span>
        <span class="n">df</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>
        <span class="c1"># need to add params to _metadata in order to make sure it is copied.</span>
        <span class="c1"># see: https://stackoverflow.com/questions/50372509/</span>
        <span class="n">df</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span>
    <span class="c1"># WranglerLogger.debug(f&quot;DFParams: {df.params}&quot;)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.coerce_dict_to_df_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coerce_dict_to_df_types</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">skip_keys</span><span class="o">=</span><span class="p">[],</span> <span class="n">return_skipped</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.coerce_dict_to_df_types" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Coerce dictionary values to match the type of a dataframe columns matching dict keys.</p>
<p>Will also coerce a list of values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>d</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary to coerce with singleton or list values</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe to get types from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>skip_keys</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of dict keys to skip. Defaults to []/</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_skipped</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>keep the uncoerced, skipped keys/vals in the resulting dict.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict with coerced types</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">coerce_dict_to_df_types</span><span class="p">(</span>
    <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">skip_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">return_skipped</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coerce dictionary values to match the type of a dataframe columns matching dict keys.</span>

<span class="sd">    Will also coerce a list of values.</span>

<span class="sd">    Args:</span>
<span class="sd">        d (dict): dictionary to coerce with singleton or list values</span>
<span class="sd">        df (pd.DataFrame): dataframe to get types from</span>
<span class="sd">        skip_keys: list of dict keys to skip. Defaults to []/</span>
<span class="sd">        return_skipped: keep the uncoerced, skipped keys/vals in the resulting dict.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: dict with coerced types</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coerced_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">skip_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_skipped</span><span class="p">:</span>
                <span class="n">coerced_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Key </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> not in dataframe columns.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;integer&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vals</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;floating&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;boolean&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coerced_v</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
        <span class="n">coerced_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">coerced_v</span>
    <span class="k">return</span> <span class="n">coerced_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.coerce_gdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coerce_gdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">in_crs</span><span class="o">=</span><span class="n">LAT_LON_CRS</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.coerce_gdf" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Coerce a DataFrame to a GeoDataFrame, optionally with a new geometry.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">coerce_gdf</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">geometry</span><span class="p">:</span> <span class="n">GeoSeries</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">in_crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">LAT_LON_CRS</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coerce a DataFrame to a GeoDataFrame, optionally with a new geometry.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">GeoDataFrame</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">in_crs</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="s2">&quot;params&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span> <span class="ow">and</span> <span class="n">geometry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must give geometry argument if don&#39;t have Geometry in dataframe&quot;</span><span class="p">)</span>

    <span class="n">geometry</span> <span class="o">=</span> <span class="n">geometry</span> <span class="k">if</span> <span class="n">geometry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">GeoSeries</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">geometry</span> <span class="o">=</span> <span class="n">GeoSeries</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
            <span class="n">geometry</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">wkt</span><span class="o">.</span><span class="n">loads</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">in_crs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># GeoPandas seems to lose parameters if we don&#39;t re-attach them.</span>
        <span class="n">df</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.coerce_val_to_df_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coerce_val_to_df_types</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.coerce_val_to_df_types" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Coerce field value to match the type of a matching dataframe columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>field to lookup</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, int, float, bool, list[<span title="typing.Union">Union</span>[str, int, float, bool]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>value or list of values to coerce</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe to get types from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
      

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">coerce_val_to_df_types</span><span class="p">(</span>
    <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]],</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coerce field value to match the type of a matching dataframe columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        field: field to lookup</span>
<span class="sd">        val: value or list of values to coerce</span>
<span class="sd">        df (pd.DataFrame): dataframe to get types from</span>

<span class="sd">    Returns: coerced value or list of values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Field </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> not in dataframe columns.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;integer&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;floating&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">field</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;boolean&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.coerce_val_to_series_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coerce_val_to_series_type</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.coerce_val_to_series_type" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Coerces a value to match type of pandas series.</p>
<p>Will try not to fail so if you give it a value that can&rsquo;t convert to a number, it will
return a string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>val</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any type of singleton value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>s</code></td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>series to match the type to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">coerce_val_to_series_type</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coerces a value to match type of pandas series.</span>

<span class="sd">    Will try not to fail so if you give it a value that can&#39;t convert to a number, it will</span>
<span class="sd">    return a string.</span>

<span class="sd">    Args:</span>
<span class="sd">        val: Any type of singleton value</span>
<span class="sd">        s (pd.Series): series to match the type to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># WranglerLogger.debug(f&quot;Input val: {val} of type {type(val)} to match with series type \</span>
    <span class="c1">#    {pd.api.types.infer_dtype(s)}.&quot;)</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;floating&quot;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">infer_dtype</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;boolean&quot;</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="c1"># WranglerLogger.debug(f&quot;Return value: {v}&quot;)</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.compare_df_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_df_values</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">join_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="p">[],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.compare_df_values" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Compare overlapping part of dataframes and returns where there are differences.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compare_df_values</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">join_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ignore</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare overlapping part of dataframes and returns where there are differences.&quot;&quot;&quot;</span>
    <span class="n">comp_c</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">c</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">GeoSeries</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">join_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">comp_df</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">comp_c</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">df2</span><span class="p">[</span><span class="n">comp_c</span><span class="p">],</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span>
            <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_a&quot;</span><span class="p">,</span> <span class="s2">&quot;_b&quot;</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comp_df</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">comp_c</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="n">comp_c</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">join_col</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_a&quot;</span><span class="p">,</span> <span class="s2">&quot;_b&quot;</span><span class="p">])</span>

    <span class="c1"># Filter columns by data type</span>
    <span class="n">numeric_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">comp_c</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)]</span>
    <span class="n">ll_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_like_columns</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">+</span> <span class="n">list_like_columns</span><span class="p">(</span><span class="n">df2</span><span class="p">)))</span>
    <span class="n">other_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">comp_c</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">numeric_cols</span> <span class="ow">and</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ll_cols</span><span class="p">]</span>

    <span class="c1"># For numeric columns, use np.isclose</span>
    <span class="k">if</span> <span class="n">numeric_cols</span><span class="p">:</span>
        <span class="n">numeric_a</span> <span class="o">=</span> <span class="n">comp_df</span><span class="p">[[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_a&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_cols</span><span class="p">]]</span>
        <span class="n">numeric_b</span> <span class="o">=</span> <span class="n">comp_df</span><span class="p">[[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_b&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_cols</span><span class="p">]]</span>
        <span class="n">is_close</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">numeric_a</span><span class="p">,</span> <span class="n">numeric_b</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span> <span class="n">equal_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">comp_df</span><span class="p">[</span><span class="n">numeric_cols</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="n">is_close</span>

    <span class="k">if</span> <span class="n">ll_cols</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ll_c</span> <span class="ow">in</span> <span class="n">ll_cols</span><span class="p">:</span>
            <span class="n">comp_df</span><span class="p">[</span><span class="n">ll_c</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff_list_like_series</span><span class="p">(</span><span class="n">comp_df</span><span class="p">[</span><span class="n">ll_c</span> <span class="o">+</span> <span class="s2">&quot;_a&quot;</span><span class="p">],</span> <span class="n">comp_df</span><span class="p">[</span><span class="n">ll_c</span> <span class="o">+</span> <span class="s2">&quot;_b&quot;</span><span class="p">])</span>

    <span class="c1"># For non-numeric columns, use direct comparison</span>
    <span class="k">if</span> <span class="n">other_cols</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">other_cols</span><span class="p">:</span>
            <span class="n">comp_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">comp_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_a&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">comp_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_b&quot;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span>
                <span class="n">comp_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_a&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">comp_df</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_b&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="c1"># Filter columns and rows where no differences</span>
    <span class="n">cols_w_diffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">comp_c</span> <span class="k">if</span> <span class="n">comp_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span>
    <span class="n">out_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">subcol</span> <span class="ow">in</span> <span class="n">cols_w_diffs</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subcol</span><span class="si">}</span><span class="s2">_a&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subcol</span><span class="si">}</span><span class="s2">_b&quot;</span><span class="p">,</span> <span class="n">subcol</span><span class="p">)]</span>
    <span class="n">comp_df</span> <span class="o">=</span> <span class="n">comp_df</span><span class="p">[</span><span class="n">out_cols</span><span class="p">]</span>
    <span class="n">comp_df</span> <span class="o">=</span> <span class="n">comp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">comp_df</span><span class="p">[</span><span class="n">cols_w_diffs</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">comp_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.compare_lists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_lists</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.compare_lists" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Compare two lists.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compare_lists</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare two lists.&quot;&quot;&quot;</span>
    <span class="n">list1</span> <span class="o">=</span> <span class="n">convert_numpy_to_list</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span>
    <span class="n">list2</span> <span class="o">=</span> <span class="n">convert_numpy_to_list</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">list1</span> <span class="o">!=</span> <span class="n">list2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.convert_numpy_to_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_numpy_to_list</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.convert_numpy_to_list" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Function to recursively convert numpy arrays to lists.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convert_numpy_to_list</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to recursively convert numpy arrays to lists.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">convert_numpy_to_list</span><span class="p">(</span><span class="n">sub_item</span><span class="p">)</span> <span class="k">for</span> <span class="n">sub_item</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">convert_numpy_to_list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">item</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.dict_fields_in_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dict_fields_in_df</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.dict_fields_in_df" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if all fields in dict are in dataframe.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dict_fields_in_df</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if all fields in dict are in dataframe.&quot;&quot;&quot;</span>
    <span class="n">missing_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">missing_fields</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields in dictionary missing from dataframe: </span><span class="si">{</span><span class="n">missing_fields</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fields in dictionary missing from dataframe: </span><span class="si">{</span><span class="n">missing_fields</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.dict_to_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dict_to_query</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.dict_to_query" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Generates the query of from selection_dict.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selection_dict</code></td>
            <td>
                  <code><span title="typing.Mapping">Mapping</span>[str, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>selection dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dict_to_query</span><span class="p">(</span>
    <span class="n">selection_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates the query of from selection_dict.</span>

<span class="sd">    Args:</span>
<span class="sd">        selection_dict: selection dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: Query value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Building selection query&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_kv_to_query_part</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">_q_part</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">_q_part</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_kv_to_query_part</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
            <span class="k">return</span> <span class="n">_q_part</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">k</span> <span class="o">+</span> <span class="s1">&#39;.str.contains(&quot;&#39;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;==&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_kv_to_query_part</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">selection_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selection query: </span><span class="se">\n</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">query</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.diff_dfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">diff_dfs</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#network_wrangler.utils.data.diff_dfs" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Returns True if two dataframes are different and log differences.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">diff_dfs</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">ignore</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if two dataframes are different and log differences.&quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; Columns are different 1vs2 </span><span class="se">\n</span><span class="s2">    </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="nb">set</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">common_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">common_cols</span><span class="p">]</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">common_cols</span><span class="p">]</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">cols_to_compare</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">]</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">cols_to_compare</span><span class="p">]</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">cols_to_compare</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">):</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; Length is different /&quot;</span> <span class="sa">f</span><span class="s2">&quot;DF1: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span><span class="si">}</span><span class="s2"> vs /&quot;</span> <span class="sa">f</span><span class="s2">&quot;DF2: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2"> /&quot;</span>
        <span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">diff_df</span> <span class="o">=</span> <span class="n">compare_df_values</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">diff_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;!!! Differences dfs: </span><span class="se">\n</span><span class="si">{</span><span class="n">diff_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;...no differences in df found.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diff</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.diff_list_like_series" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">diff_list_like_series</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.diff_list_like_series" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Compare two series that contain list-like items as strings.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">diff_list_like_series</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compare two series that contain list-like items as strings.&quot;&quot;&quot;</span>
    <span class="n">diff_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">,</span> <span class="s2">&quot;s2&quot;</span><span class="p">])</span>
    <span class="c1"># diff_df[&quot;diff&quot;] = diff_df.apply(lambda x: str(x[&quot;s1&quot;]) != str(x[&quot;s2&quot;]), axis=1)</span>
    <span class="n">diff_df</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">compare_lists</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;s1&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;s2&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">diff_df</span><span class="p">[</span><span class="s2">&quot;diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;List-Like differences:&quot;</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">diff_df</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.fk_in_pk" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fk_in_pk</span><span class="p">(</span><span class="n">pk</span><span class="p">,</span> <span class="n">fk</span><span class="p">,</span> <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.fk_in_pk" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if all foreign keys are in the primary keys, optionally ignoring NaN.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fk_in_pk</span><span class="p">(</span>
    <span class="n">pk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">fk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">ignore_nan</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if all foreign keys are in the primary keys, optionally ignoring NaN.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fk</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">fk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fk</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ignore_nan</span><span class="p">:</span>
        <span class="n">fk</span> <span class="o">=</span> <span class="n">fk</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="n">missing_flag</span> <span class="o">=</span> <span class="o">~</span><span class="n">fk</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">missing_flag</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Following keys referenced in </span><span class="si">{</span><span class="n">fk</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> but missing in</span><span class="se">\</span>
<span class="s2">            primary key table: </span><span class="se">\n</span><span class="si">{</span><span class="n">fk</span><span class="p">[</span><span class="n">missing_flag</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fk</span><span class="p">[</span><span class="n">missing_flag</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.list_like_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_like_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">item_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.list_like_columns" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Find columns in a dataframe that contain list-like items that can&rsquo;t be json-serialized.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dataframe to check</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>item_type</code></td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if not None, will only return columns where all items are of this type by
checking <strong>only</strong> the first item in the column.  Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_like_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">item_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find columns in a dataframe that contain list-like items that can&#39;t be json-serialized.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: dataframe to check</span>
<span class="sd">        item_type: if not None, will only return columns where all items are of this type by</span>
<span class="sd">            checking **only** the first item in the column.  Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">list_like_columns</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">ndarray</span><span class="p">)))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item_type</span><span class="p">):</span>
                    <span class="k">continue</span>
            <span class="n">list_like_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">list_like_columns</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.segment_data_by_selection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">segment_data_by_selection</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_val</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.segment_data_by_selection" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Segment a dataframe or series into before, middle, and end segments based on item_list.</p>
<p>selected segment = everything from the first to last item in item_list inclusive of the first
    and last items.
Before segment = everything before
After segment = everything after</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>item_list</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of items to segment data by. If longer than two, will only
use the first and last items.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data to segment into before, middle, and after.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a dataframe, specifies which field to reference.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_val</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Notation for util the end or from the begining. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If item list isn&rsquo;t found in data in correct order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code>tuple[<span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, list, <span title="pandas.DataFrame">DataFrame</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>data broken out by beofore, selected segment, and after.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">segment_data_by_selection</span><span class="p">(</span>
    <span class="n">item_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span>
    <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_val</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Segment a dataframe or series into before, middle, and end segments based on item_list.</span>

<span class="sd">    selected segment = everything from the first to last item in item_list inclusive of the first</span>
<span class="sd">        and last items.</span>
<span class="sd">    Before segment = everything before</span>
<span class="sd">    After segment = everything after</span>


<span class="sd">    Args:</span>
<span class="sd">        item_list (list): List of items to segment data by. If longer than two, will only</span>
<span class="sd">            use the first and last items.</span>
<span class="sd">        data (Union[pd.Series, pd.DataFrame]): Data to segment into before, middle, and after.</span>
<span class="sd">        field (str, optional): If a dataframe, specifies which field to reference.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        end_val (int, optional): Notation for util the end or from the begining. Defaults to 0.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If item list isn&#39;t found in data in correct order.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: data broken out by beofore, selected segment, and after.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ref_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">ref_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">ref_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># ------- Replace &quot;to the end&quot; indicators with first or last value --------</span>
    <span class="n">start_item</span><span class="p">,</span> <span class="n">end_item</span> <span class="o">=</span> <span class="n">item_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">start_item</span> <span class="o">==</span> <span class="n">end_val</span><span class="p">:</span>
        <span class="n">start_item</span> <span class="o">=</span> <span class="n">ref_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">end_item</span> <span class="o">==</span> <span class="n">end_val</span><span class="p">:</span>
        <span class="n">end_item</span> <span class="o">=</span> <span class="n">ref_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># --------Find the start and end indices -----------------------------------</span>
    <span class="n">start_idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ref_data</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">start_item</span><span class="p">]))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">start_idxs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Segment start item: </span><span class="si">{</span><span class="n">start_item</span><span class="si">}</span><span class="s2"> not in data.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_idxs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Found multiple starting locations for data segment: </span><span class="si">{</span><span class="n">start_item</span><span class="si">}</span><span class="s2">.</span><span class="se">\</span>
<span class="s2">                                Choosing first  largest segment being selected.&quot;</span>
        <span class="p">)</span>
    <span class="n">start_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">start_idxs</span><span class="p">)</span>

    <span class="c1"># find the end node starting from the start index.</span>
    <span class="n">end_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">start_idx</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ref_data</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:])</span> <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">end_item</span><span class="p">]</span>
    <span class="c1"># WranglerLogger.debug(f&quot;End indexes: {end_idxs}&quot;)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">end_idxs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Segment end item: </span><span class="si">{</span><span class="n">end_item</span><span class="si">}</span><span class="s2"> not in data after starting idx.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">end_idxs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Found multiple ending locations for data segment: </span><span class="si">{</span><span class="n">end_item</span><span class="si">}</span><span class="s2">.</span><span class="se">\</span>
<span class="s2">                                Choosing last  largest segment being selected.&quot;</span>
        <span class="p">)</span>
    <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">end_idxs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1"># WranglerLogger.debug(</span>
    <span class="c1"># f&quot;Segmenting data fr {start_item} idx:{start_idx} to {end_item} idx:{end_idx}.\n{ref_data}&quot;)</span>
    <span class="c1"># -------- Extract the segments --------------------------------------------</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">before_segment</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">start_idx</span><span class="p">]</span>
        <span class="n">selected_segment</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
        <span class="n">after_segment</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">end_idx</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">before_segment</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="n">start_idx</span><span class="p">]</span>
        <span class="n">selected_segment</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
        <span class="n">after_segment</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">end_idx</span><span class="p">:]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">before_segment</span> <span class="o">=</span> <span class="n">before_segment</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">selected_segment</span> <span class="o">=</span> <span class="n">selected_segment</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">after_segment</span> <span class="o">=</span> <span class="n">after_segment</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># WranglerLogger.debug(f&quot;Segmented data into before, selected, and after.\n \</span>
    <span class="c1">#    Before:\n{before_segment}\nSelected:\n{selected_segment}\nAfter:\n{after_segment}&quot;)</span>

    <span class="k">return</span> <span class="n">before_segment</span><span class="p">,</span> <span class="n">selected_segment</span><span class="p">,</span> <span class="n">after_segment</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.segment_data_by_selection_min_overlap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">segment_data_by_selection_min_overlap</span><span class="p">(</span><span class="n">selection_list</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">replacements_list</span><span class="p">,</span> <span class="n">end_val</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.segment_data_by_selection_min_overlap" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Segments data based on item_list reducing overlap with replacement list.</p>
<p><em>selected segment</em>: everything from the first to last item in item_list inclusive of the first
    and last items but not if first and last items overlap with replacement list.
Before segment = everything before
After segment = everything after</p>
<p>Example:
selection_list = [2,5]
data = pd.DataFrame({&ldquo;i&rdquo;:[1,2,3,4,5,6]})
field = &ldquo;i&rdquo;
replacements_list = [2,22,33]</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>[22,33]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[<span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, list, <span title="pandas.DataFrame">DataFrame</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>[1], [2,3,4,5], [6]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selection_list</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of items to segment data by. If longer than two, will only
use the first and last items.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data to segment into before, middle, and after.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>field</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies which field to reference.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>replacements_list</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of items to eventually replace the selected segment with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>end_val</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Notation for util the end or from the begining. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">tuple containing:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>updated replacement_list</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[<span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, list, <span title="pandas.DataFrame">DataFrame</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>tuple of before, selected segment, and after data</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">segment_data_by_selection_min_overlap</span><span class="p">(</span>
    <span class="n">selection_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">replacements_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">end_val</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Segments data based on item_list reducing overlap with replacement list.</span>

<span class="sd">    *selected segment*: everything from the first to last item in item_list inclusive of the first</span>
<span class="sd">        and last items but not if first and last items overlap with replacement list.</span>
<span class="sd">    Before segment = everything before</span>
<span class="sd">    After segment = everything after</span>

<span class="sd">    Example:</span>
<span class="sd">    selection_list = [2,5]</span>
<span class="sd">    data = pd.DataFrame({&quot;i&quot;:[1,2,3,4,5,6]})</span>
<span class="sd">    field = &quot;i&quot;</span>
<span class="sd">    replacements_list = [2,22,33]</span>

<span class="sd">    returns:</span>
<span class="sd">        [22,33]</span>
<span class="sd">        [1], [2,3,4,5], [6]</span>

<span class="sd">    Args:</span>
<span class="sd">        selection_list (list): List of items to segment data by. If longer than two, will only</span>
<span class="sd">            use the first and last items.</span>
<span class="sd">        data (Union[pd.Series, pd.DataFrame]): Data to segment into before, middle, and after.</span>
<span class="sd">        field (str): Specifies which field to reference.</span>
<span class="sd">        replacements_list (list): List of items to eventually replace the selected segment with.</span>
<span class="sd">        end_val (int, optional): Notation for util the end or from the begining. Defaults to 0.</span>

<span class="sd">    Returns: tuple containing:</span>
<span class="sd">        - updated replacement_list</span>
<span class="sd">        - tuple of before, selected segment, and after data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">before_segment</span><span class="p">,</span> <span class="n">segment_df</span><span class="p">,</span> <span class="n">after_segment</span> <span class="o">=</span> <span class="n">segment_data_by_selection</span><span class="p">(</span>
        <span class="n">selection_list</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">field</span><span class="p">,</span> <span class="n">end_val</span><span class="o">=</span><span class="n">end_val</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">replacements_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">segment_df</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="c1"># move first item from selected segment to the before_segment df</span>
        <span class="n">replacements_list</span> <span class="o">=</span> <span class="n">replacements_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">before_segment</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
            <span class="p">[</span><span class="n">before_segment</span><span class="p">,</span> <span class="n">segment_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">segment_df</span> <span class="o">=</span> <span class="n">segment_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;item start overlaps with replacement. Repl: </span><span class="si">{</span><span class="n">replacements_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">replacements_list</span> <span class="ow">and</span> <span class="n">replacements_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="c1"># move last item from selected segment to the after_segment df</span>
        <span class="n">replacements_list</span> <span class="o">=</span> <span class="n">replacements_list</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">after_segment</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">after_segment</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">segment_df</span> <span class="o">=</span> <span class="n">segment_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;item end overlaps with replacement. Repl: </span><span class="si">{</span><span class="n">replacements_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">replacements_list</span><span class="p">,</span> <span class="p">(</span><span class="n">before_segment</span><span class="p">,</span> <span class="n">segment_df</span><span class="p">,</span> <span class="n">after_segment</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.update_df_by_col_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_df_by_col_value</span><span class="p">(</span><span class="n">destination_df</span><span class="p">,</span> <span class="n">source_df</span><span class="p">,</span> <span class="n">join_col</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fail_if_missing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.update_df_by_col_value" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Updates destination_df with ALL values in source_df for specified props with same join_col.</p>
<p>Source_df can contain a subset of IDs of destination_df.
If fail_if_missing is true, destination_df must have all
the IDS in source DF - ensuring all source_df values are contained in resulting df.</p>
<div class="language-text highlight"><pre><span></span><code>&gt;&gt; destination_df
trip_id  property1  property2
1         10      100
2         20      200
3         30      300
4         40      400

&gt;&gt; source_df
trip_id  property1  property2
2         25      250
3         35      350

&gt;&gt; updated_df
trip_id  property1  property2
0        1       10      100
1        2       25      250
2        3       35      350
3        4       40      400
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>destination_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe to modify.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>source_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe with updated columns</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>join_col</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>column to join on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>properties</code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of properties to use. If None, will default to all
in source_df.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fail_if_missing</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will raise an error if there are missing IDs in
destination_df that exist in source_df.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_df_by_col_value</span><span class="p">(</span>
    <span class="n">destination_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">source_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">join_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">properties</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fail_if_missing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates destination_df with ALL values in source_df for specified props with same join_col.</span>

<span class="sd">    Source_df can contain a subset of IDs of destination_df.</span>
<span class="sd">    If fail_if_missing is true, destination_df must have all</span>
<span class="sd">    the IDS in source DF - ensuring all source_df values are contained in resulting df.</span>

<span class="sd">    ```</span>
<span class="sd">    &gt;&gt; destination_df</span>
<span class="sd">    trip_id  property1  property2</span>
<span class="sd">    1         10      100</span>
<span class="sd">    2         20      200</span>
<span class="sd">    3         30      300</span>
<span class="sd">    4         40      400</span>

<span class="sd">    &gt;&gt; source_df</span>
<span class="sd">    trip_id  property1  property2</span>
<span class="sd">    2         25      250</span>
<span class="sd">    3         35      350</span>

<span class="sd">    &gt;&gt; updated_df</span>
<span class="sd">    trip_id  property1  property2</span>
<span class="sd">    0        1       10      100</span>
<span class="sd">    1        2       25      250</span>
<span class="sd">    2        3       35      350</span>
<span class="sd">    3        4       40      400</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        destination_df (pd.DataFrame): Dataframe to modify.</span>
<span class="sd">        source_df (pd.DataFrame): Dataframe with updated columns</span>
<span class="sd">        join_col (str): column to join on</span>
<span class="sd">        properties (list[str]): List of properties to use. If None, will default to all</span>
<span class="sd">            in source_df.</span>
<span class="sd">        fail_if_missing (bool): If True, will raise an error if there are missing IDs in</span>
<span class="sd">            destination_df that exist in source_df.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. Identify which properties should be updated; and if they exist in both DFs.</span>
    <span class="k">if</span> <span class="n">properties</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">source_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">destination_df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">join_col</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_dest_miss</span> <span class="o">=</span> <span class="n">_df_missing_cols</span><span class="p">(</span><span class="n">destination_df</span><span class="p">,</span> <span class="n">properties</span> <span class="o">+</span> <span class="p">[</span><span class="n">join_col</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">_dest_miss</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MissingPropertiesError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Properties missing from destination_df: </span><span class="si">{</span><span class="n">_dest_miss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">_source_miss</span> <span class="o">=</span> <span class="n">_df_missing_cols</span><span class="p">(</span><span class="n">source_df</span><span class="p">,</span> <span class="n">properties</span> <span class="o">+</span> <span class="p">[</span><span class="n">join_col</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">_source_miss</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MissingPropertiesError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Properties missing from source_df: </span><span class="si">{</span><span class="n">_source_miss</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 2. Identify if there are IDs missing from destintation_df that exist in source_df</span>
    <span class="k">if</span> <span class="n">fail_if_missing</span><span class="p">:</span>
        <span class="n">missing_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">source_df</span><span class="p">[</span><span class="n">join_col</span><span class="p">])</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">destination_df</span><span class="p">[</span><span class="n">join_col</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">missing_ids</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidJoinFieldError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IDs missing from source_df: </span><span class="se">\n</span><span class="si">{</span><span class="n">missing_ids</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating properties for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">source_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> records: </span><span class="si">{</span><span class="n">properties</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">source_df</span><span class="p">[</span><span class="n">join_col</span><span class="p">]</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
        <span class="n">InvalidJoinFieldError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t join from source_df when join_col: </span><span class="si">{join_col}</span><span class="s2"> is not unique.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">destination_df</span><span class="p">[</span><span class="n">join_col</span><span class="p">]</span><span class="o">.</span><span class="n">is_unique</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_update_props_from_one_to_many</span><span class="p">(</span><span class="n">destination_df</span><span class="p">,</span> <span class="n">source_df</span><span class="p">,</span> <span class="n">join_col</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_update_props_for_common_idx</span><span class="p">(</span><span class="n">destination_df</span><span class="p">,</span> <span class="n">source_df</span><span class="p">,</span> <span class="n">join_col</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.data.validate_existing_value_in_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_existing_value_in_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">expected_value</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.data.validate_existing_value_in_df" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Validate if df[field]==expected_value for all indices in idx.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/data.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate_existing_value_in_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected_value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate if df[field]==expected_value for all indices in idx.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;!! </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> Not an existing field.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">expected_value</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Existing value defined for </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> in project card </span><span class="se">\</span>
<span class="s2">            does not match the value in the selection links. </span><span class="se">\n\</span>
<span class="s2">            Specified Existing: </span><span class="si">{</span><span class="n">expected_value</span><span class="si">}</span><span class="se">\n\</span>
<span class="s2">            Actual Existing: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.geo"></a>
    <div class="doc doc-contents first">

      <p>Helper geographic manipulation functions.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.geo.InvalidCRSError" class="doc doc-heading">
            <code>InvalidCRSError</code>


<a href="#network_wrangler.utils.geo.InvalidCRSError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when a point is not valid for a given coordinate reference system.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidCRSError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a point is not valid for a given coordinate reference system.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.geo.MissingNodesError" class="doc doc-heading">
            <code>MissingNodesError</code>


<a href="#network_wrangler.utils.geo.MissingNodesError" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


      <p>Raised when referenced nodes are missing from the network.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MissingNodesError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when referenced nodes are missing from the network.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.check_point_valid_for_crs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_point_valid_for_crs</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.check_point_valid_for_crs" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Check if a point is valid for a given coordinate reference system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>point</code></td>
            <td>
                  <code><span title="shapely.geometry.Point">Point</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shapely Point</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>crs</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate reference system in ESPG code</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
      

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_point_valid_for_crs</span><span class="p">(</span><span class="n">point</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a point is valid for a given coordinate reference system.</span>

<span class="sd">    Args:</span>
<span class="sd">        point: Shapely Point</span>
<span class="sd">        crs: coordinate reference system in ESPG code</span>

<span class="sd">    raises: InvalidCRSError if point is not valid for the given crs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_user_input</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>
    <span class="n">minx</span><span class="p">,</span> <span class="n">miny</span><span class="p">,</span> <span class="n">maxx</span><span class="p">,</span> <span class="n">maxy</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">area_of_use</span><span class="o">.</span><span class="n">bounds</span>
    <span class="n">ok_bounds</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">minx</span> <span class="o">&lt;=</span> <span class="n">point</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">maxx</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid X coordinate for CRS </span><span class="si">{</span><span class="n">crs</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ok_bounds</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">miny</span> <span class="o">&lt;=</span> <span class="n">point</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">maxy</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Y coordinate for CRS </span><span class="si">{</span><span class="n">crs</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ok_bounds</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ok_bounds</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidCRSError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid coordinate for CRS </span><span class="si">{</span><span class="n">crs</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">point</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.get_bearing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_bearing</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.get_bearing" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Calculate the bearing (forward azimuth) b/w the two points.</p>
<p>returns: bearing in radians</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_bearing</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the bearing (forward azimuth) b/w the two points.</span>

<span class="sd">    returns: bearing in radians</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># bearing in degrees</span>
    <span class="n">brng</span> <span class="o">=</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">WGS84</span><span class="o">.</span><span class="n">Inverse</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">)[</span><span class="s2">&quot;azi1&quot;</span><span class="p">]</span>

    <span class="c1"># convert bearing to radians</span>
    <span class="n">brng</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">brng</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">brng</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.get_bounding_polygon" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_bounding_polygon</span><span class="p">(</span><span class="n">boundary_geocode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_gdf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">LAT_LON_CRS</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.get_bounding_polygon" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Get the bounding polygon for a given boundary.</p>
<p>Will return None if no arguments given. Will raise a ValueError if more than one given.</p>
<p>This function retrieves the bounding polygon for a given boundary. The boundary can be provided
as a GeoDataFrame, a geocode string or dictionary, or a boundary file. The resulting polygon
geometry is returned as a GeoSeries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>boundary_geocode</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A geocode string or dictionary
representing the boundary. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_file</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A path to the boundary file. Only used if
boundary_geocode is None. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>boundary_gdf</code></td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A GeoDataFrame representing the boundary.
Only used if boundary_geocode and boundary_file are None. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>crs</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coordinate reference system (CRS) code. Defaults to 4326 (WGS84).</p>
              </div>
            </td>
            <td>
                  <code><span title="network_wrangler.params.LAT_LON_CRS">LAT_LON_CRS</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="geopandas.GeoSeries">GeoSeries</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>gpd.GeoSeries: The polygon geometry representing the bounding polygon.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_bounding_polygon</span><span class="p">(</span>
    <span class="n">boundary_geocode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boundary_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">boundary_gdf</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">LAT_LON_CRS</span><span class="p">,</span>  <span class="c1"># WGS84</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the bounding polygon for a given boundary.</span>

<span class="sd">    Will return None if no arguments given. Will raise a ValueError if more than one given.</span>

<span class="sd">    This function retrieves the bounding polygon for a given boundary. The boundary can be provided</span>
<span class="sd">    as a GeoDataFrame, a geocode string or dictionary, or a boundary file. The resulting polygon</span>
<span class="sd">    geometry is returned as a GeoSeries.</span>

<span class="sd">    Args:</span>
<span class="sd">        boundary_geocode (Union[str, dict], optional): A geocode string or dictionary</span>
<span class="sd">            representing the boundary. Defaults to None.</span>
<span class="sd">        boundary_file (Union[str, Path], optional): A path to the boundary file. Only used if</span>
<span class="sd">            boundary_geocode is None. Defaults to None.</span>
<span class="sd">        boundary_gdf (gpd.GeoDataFrame, optional): A GeoDataFrame representing the boundary.</span>
<span class="sd">            Only used if boundary_geocode and boundary_file are None. Defaults to None.</span>
<span class="sd">        crs (int, optional): The coordinate reference system (CRS) code. Defaults to 4326 (WGS84).</span>

<span class="sd">    Returns:</span>
<span class="sd">        gpd.GeoSeries: The polygon geometry representing the bounding polygon.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">osmnx</span> <span class="k">as</span> <span class="nn">ox</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">boundary_gdf</span><span class="p">,</span> <span class="n">boundary_geocode</span><span class="p">,</span> <span class="n">boundary_file</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">nargs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Exacly one of boundary_gdf, boundary_geocode, or boundary_shp must </span><span class="se">\</span>
<span class="s2">                         be provided&quot;</span>
        <span class="p">)</span>

    <span class="n">OK_BOUNDARY_SUFF</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;.shp&quot;</span><span class="p">,</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">,</span> <span class="s2">&quot;.parquet&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">boundary_geocode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">boundary_gdf</span> <span class="o">=</span> <span class="n">ox</span><span class="o">.</span><span class="n">geocode_to_gdf</span><span class="p">(</span><span class="n">boundary_geocode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">boundary_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">boundary_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">boundary_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">boundary_file</span><span class="o">.</span><span class="n">suffix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">OK_BOUNDARY_SUFF</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Boundary file must have one of the following suffixes: </span><span class="si">{</span><span class="n">OK_BOUNDARY_SUFF</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">boundary_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Boundary file </span><span class="si">{</span><span class="n">boundary_file</span><span class="si">}</span><span class="s2"> does not exist&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">boundary_file</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.parquet&quot;</span><span class="p">:</span>
            <span class="n">boundary_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">boundary_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">boundary_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">boundary_file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">boundary_file</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.geojson&quot;</span><span class="p">:</span>  <span class="c1"># geojson standard is WGS84</span>
                <span class="n">boundary_gdf</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>

    <span class="k">if</span> <span class="n">boundary_gdf</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">boundary_gdf</span> <span class="o">=</span> <span class="n">boundary_gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>
    <span class="c1"># make sure boundary_gdf is a polygon</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundary_gdf</span><span class="o">.</span><span class="n">geom_type</span><span class="p">[</span><span class="n">boundary_gdf</span><span class="o">.</span><span class="n">geom_type</span> <span class="o">!=</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;boundary_gdf must all be Polygons&quot;</span><span class="p">)</span>
    <span class="c1"># get the boundary as a single polygon</span>
    <span class="n">boundary_gs</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">boundary_gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">unary_union</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">boundary_gs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.get_point_geometry_from_linestring" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_point_geometry_from_linestring</span><span class="p">(</span><span class="n">polyline_geometry</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.get_point_geometry_from_linestring" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Get a point geometry from a linestring geometry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>polyline_geometry</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shapely LineString instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>pos</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>position in the linestring to get the point from. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_point_geometry_from_linestring</span><span class="p">(</span><span class="n">polyline_geometry</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a point geometry from a linestring geometry.</span>

<span class="sd">    Args:</span>
<span class="sd">        polyline_geometry: shapely LineString instance</span>
<span class="sd">        pos: position in the linestring to get the point from. Defaults to 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># WranglerLogger.debug(</span>
    <span class="c1">#    f&quot;get_point_geometry_from_linestring.polyline_geometry.coords[0]: \</span>
    <span class="c1">#    {polyline_geometry.coords[0]}.&quot;</span>
    <span class="c1"># )</span>

    <span class="c1"># Note: when upgrading to shapely 2.0, will need to use following command</span>
    <span class="c1"># _point_coords = get_coordinates(polyline_geometry).tolist()[pos]</span>
    <span class="k">return</span> <span class="n">point_from_xy</span><span class="p">(</span><span class="o">*</span><span class="n">polyline_geometry</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">pos</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.length_of_linestring_miles" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">length_of_linestring_miles</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.length_of_linestring_miles" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Returns a Series with the linestring length in miles.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>gdf</code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="geopandas.GeoSeries">GeoSeries</span>, <span title="geopandas.GeoDataFrame">GeoDataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame with linestring geometry.  If given a GeoSeries will attempt to convert
to a GeoDataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">length_of_linestring_miles</span><span class="p">(</span><span class="n">gdf</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a Series with the linestring length in miles.</span>

<span class="sd">    Args:</span>
<span class="sd">        gdf: GeoDataFrame with linestring geometry.  If given a GeoSeries will attempt to convert</span>
<span class="sd">            to a GeoDataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># WranglerLogger.debug(f&quot;length_of_linestring_miles.gdf input:\n{gdf}.&quot;)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">):</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="n">gdf</span><span class="p">)</span>

    <span class="n">p_crs</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">estimate_utm_crs</span><span class="p">()</span>
    <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">p_crs</span><span class="p">)</span>
    <span class="n">METERS_IN_MILES</span> <span class="o">=</span> <span class="mf">1609.34</span>
    <span class="n">length_miles</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">METERS_IN_MILES</span>
    <span class="n">length_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">length_miles</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">length_s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.linestring_from_lats_lons" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">linestring_from_lats_lons</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lat_fields</span><span class="p">,</span> <span class="n">lon_fields</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.linestring_from_lats_lons" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Create a LineString geometry from a DataFrame with lon/lat fields.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>df</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with columns for lon/lat fields.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lat_fields</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of column names for the lat fields.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lon_fields</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of column names for the lon fields.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">linestring_from_lats_lons</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lat_fields</span><span class="p">,</span> <span class="n">lon_fields</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a LineString geometry from a DataFrame with lon/lat fields.</span>

<span class="sd">    Args:</span>
<span class="sd">        df: DataFrame with columns for lon/lat fields.</span>
<span class="sd">        lat_fields: list of column names for the lat fields.</span>
<span class="sd">        lon_fields: list of column names for the lon fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lon_fields</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lat_fields</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;lon_fields and lat_fields lists must have the same length&quot;</span><span class="p">)</span>

    <span class="n">line_geometries</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">LineString</span><span class="p">([(</span><span class="n">row</span><span class="p">[</span><span class="n">lon</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="n">lat</span><span class="p">])</span> <span class="k">for</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lon_fields</span><span class="p">,</span> <span class="n">lat_fields</span><span class="p">)])</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">line_geometries</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.linestring_from_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">linestring_from_nodes</span><span class="p">(</span><span class="n">links_df</span><span class="p">,</span> <span class="n">nodes_df</span><span class="p">,</span> <span class="n">from_node</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">to_node</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">node_pk</span><span class="o">=</span><span class="s1">&#39;model_node_id&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.linestring_from_nodes" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Creates a LineString geometry GeoSeries from a DataFrame of links and a DataFrame of nodes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>links_df</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with columns for from_node and to_node.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>nodes_df</code></td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame with geometry column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>from_node</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>column name in links_df for the from node. Defaults to &ldquo;A&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;A&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>to_node</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>column name in links_df for the to node. Defaults to &ldquo;B&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;B&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>node_pk</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>primary key column name in nodes_df. Defaults to &ldquo;model_node_id&rdquo;.</p>
              </div>
            </td>
            <td>
                  <code>&#39;model_node_id&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">linestring_from_nodes</span><span class="p">(</span>
    <span class="n">links_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">nodes_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span>
    <span class="n">from_node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
    <span class="n">to_node</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span>
    <span class="n">node_pk</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a LineString geometry GeoSeries from a DataFrame of links and a DataFrame of nodes.</span>

<span class="sd">    Args:</span>
<span class="sd">        links_df: DataFrame with columns for from_node and to_node.</span>
<span class="sd">        nodes_df: GeoDataFrame with geometry column.</span>
<span class="sd">        from_node: column name in links_df for the from node. Defaults to &quot;A&quot;.</span>
<span class="sd">        to_node: column name in links_df for the to node. Defaults to &quot;B&quot;.</span>
<span class="sd">        node_pk: primary key column name in nodes_df. Defaults to &quot;model_node_id&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">nodes_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;nodes_df must have a &#39;geometry&#39; column&quot;</span>

    <span class="n">idx_name</span> <span class="o">=</span> <span class="s2">&quot;index&quot;</span> <span class="k">if</span> <span class="n">links_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">links_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>
    <span class="c1"># WranglerLogger.debug(f&quot;Index name: {idx_name}&quot;)</span>
    <span class="n">required_link_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">col</span> <span class="ow">in</span> <span class="n">links_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_link_cols</span><span class="p">]):</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;links_df.columns missing required columns.</span><span class="se">\n\</span>
<span class="s2">                            links_df.columns: </span><span class="si">{</span><span class="n">links_df</span><span class="o">.</span><span class="n">columns</span><span class="si">}</span><span class="se">\n\</span>
<span class="s2">                            required_link_cols: </span><span class="si">{</span><span class="n">required_link_cols</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;links_df must have columns </span><span class="si">{</span><span class="n">required_link_cols</span><span class="si">}</span><span class="s2"> to create linestring from nodes&quot;</span>
        <span class="p">)</span>

    <span class="n">links_geo_df</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">links_df</span><span class="p">[</span><span class="n">required_link_cols</span><span class="p">])</span>
    <span class="c1"># need to continuously reset the index to make sure the index is the same as the link index</span>
    <span class="n">links_geo_df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">links_geo_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">nodes_df</span><span class="p">[[</span><span class="n">node_pk</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
            <span class="n">left_on</span><span class="o">=</span><span class="n">from_node</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="n">node_pk</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">idx_name</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">links_geo_df</span> <span class="o">=</span> <span class="n">links_geo_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="s2">&quot;geometry_A&quot;</span><span class="p">})</span>

    <span class="n">links_geo_df</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">links_geo_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">nodes_df</span><span class="p">[[</span><span class="n">node_pk</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
            <span class="n">left_on</span><span class="o">=</span><span class="n">to_node</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="n">node_pk</span><span class="p">,</span>
            <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">idx_name</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">links_geo_df</span> <span class="o">=</span> <span class="n">links_geo_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="s2">&quot;geometry_B&quot;</span><span class="p">})</span>

    <span class="c1"># makes sure all nodes exist</span>
    <span class="n">_missing_geo_links_df</span> <span class="o">=</span> <span class="n">links_geo_df</span><span class="p">[</span>
        <span class="n">links_geo_df</span><span class="p">[</span><span class="s2">&quot;geometry_A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">|</span> <span class="n">links_geo_df</span><span class="p">[</span><span class="s2">&quot;geometry_B&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_missing_geo_links_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">missing_nodes</span> <span class="o">=</span> <span class="n">_missing_geo_links_df</span><span class="p">[[</span><span class="n">from_node</span><span class="p">,</span> <span class="n">to_node</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Cannot create link geometry from nodes because the nodes are</span><span class="se">\</span>
<span class="s2">                             missing from the network. Missing nodes: </span><span class="si">{</span><span class="n">missing_nodes</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">MissingNodesError</span><span class="p">(</span><span class="s2">&quot;Specified from/to nodes are missing in nodes_df&quot;</span><span class="p">)</span>

    <span class="c1"># create geometry from points</span>
    <span class="n">links_geo_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">links_geo_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">LineString</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;geometry_A&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;geometry_B&quot;</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="c1"># convert to GeoDataFrame</span>
    <span class="n">links_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">links_geo_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">],</span> <span class="n">geometry</span><span class="o">=</span><span class="n">links_geo_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">links_gdf</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.location_ref_from_point" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">location_ref_from_point</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bearing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distance_to_next_ref</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.location_ref_from_point" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Generates a shared street point location reference.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>geometry</code></td>
            <td>
                  <code><span title="shapely.geometry.Point">Point</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Point shapely geometry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence if part of polyline. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>bearing</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direction of line if part of polyline. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>distance_to_next_ref</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distnce to next point if part of polyline.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>LocationReference</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.types.LocationReference" href="../data_models/#network_wrangler.models.roadway.types.LocationReference">LocationReference</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>As defined by sharedStreets.io schema</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">location_ref_from_point</span><span class="p">(</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span>
    <span class="n">sequence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">bearing</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">distance_to_next_ref</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocationReference</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a shared street point location reference.</span>

<span class="sd">    Args:</span>
<span class="sd">        geometry (Point): Point shapely geometry</span>
<span class="sd">        sequence (int, optional): Sequence if part of polyline. Defaults to None.</span>
<span class="sd">        bearing (float, optional): Direction of line if part of polyline. Defaults to None.</span>
<span class="sd">        distance_to_next_ref (float, optional): Distnce to next point if part of polyline.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LocationReference: As defined by sharedStreets.io schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;point&quot;</span><span class="p">:</span> <span class="n">LatLongCoordinates</span><span class="p">(</span><span class="n">geometry</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="s2">&quot;bearing&quot;</span><span class="p">,</span> <span class="s2">&quot;distance_to_next_ref&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">locals</span><span class="p">()[</span><span class="n">arg</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lr</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()[</span><span class="n">arg</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">LocationReference</span><span class="p">(</span><span class="o">**</span><span class="n">lr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.location_refs_from_linestring" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">location_refs_from_linestring</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.location_refs_from_linestring" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Generates a shared street location reference from linestring.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>geometry</code></td>
            <td>
                  <code><span title="shapely.geometry.LineString">LineString</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shapely LineString instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>LocationReferences</code></td>            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="network_wrangler.models.roadway.types.LocationReference" href="../data_models/#network_wrangler.models.roadway.types.LocationReference">LocationReference</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>As defined by sharedStreets.io schema</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">location_refs_from_linestring</span><span class="p">(</span><span class="n">geometry</span><span class="p">:</span> <span class="n">LineString</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">LocationReference</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a shared street location reference from linestring.</span>

<span class="sd">    Args:</span>
<span class="sd">        geometry (LineString): Shapely LineString instance</span>

<span class="sd">    Returns:</span>
<span class="sd">        LocationReferences: As defined by sharedStreets.io schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">location_ref_from_point</span><span class="p">(</span>
            <span class="n">point</span><span class="p">,</span>
            <span class="n">sequence</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">distance_to_next_ref</span><span class="o">=</span><span class="n">point</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">geometry</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span>
            <span class="n">bearing</span><span class="o">=</span><span class="n">get_bearing</span><span class="p">(</span><span class="o">*</span><span class="n">point</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="n">geometry</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">geometry</span><span class="o">.</span><span class="n">coords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.offset_geometry_meters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">offset_geometry_meters</span><span class="p">(</span><span class="n">geo_s</span><span class="p">,</span> <span class="n">offset_distance_meters</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.offset_geometry_meters" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Offset a GeoSeries of LineStrings by a given distance in meters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>geo_s</code></td>
            <td>
                  <code><span title="geopandas.GeoSeries">GeoSeries</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoSeries of LineStrings to offset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>offset_distance_meters</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>distance in meters to offset the LineStrings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">offset_geometry_meters</span><span class="p">(</span><span class="n">geo_s</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">,</span> <span class="n">offset_distance_meters</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Offset a GeoSeries of LineStrings by a given distance in meters.</span>

<span class="sd">    Args:</span>
<span class="sd">        geo_s: GeoSeries of LineStrings to offset.</span>
<span class="sd">        offset_distance_meters: distance in meters to offset the LineStrings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">og_crs</span> <span class="o">=</span> <span class="n">geo_s</span><span class="o">.</span><span class="n">crs</span>
    <span class="n">geo_s</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">METERS_CRS</span><span class="p">)</span>
    <span class="n">offset_geo</span> <span class="o">=</span> <span class="n">geo_s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">offset_curve</span><span class="p">(</span><span class="n">offset_distance_meters</span><span class="p">))</span>
    <span class="n">offset_geo</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">offset_geo</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">offset_geo</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">og_crs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.offset_point_with_distance_and_bearing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">offset_point_with_distance_and_bearing</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">bearing</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.offset_point_with_distance_and_bearing" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Get the new lon-lat (in degrees) given current point (lon-lat), distance and bearing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>lon</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>longitude of original point</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lat</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>latitude of original point</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>distance</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>distance in meters to offset point by</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>bearing</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>direction to offset point to in radians</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
      

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">offset_point_with_distance_and_bearing</span><span class="p">(</span>
    <span class="n">lon</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">bearing</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the new lon-lat (in degrees) given current point (lon-lat), distance and bearing.</span>

<span class="sd">    Args:</span>
<span class="sd">        lon: longitude of original point</span>
<span class="sd">        lat: latitude of original point</span>
<span class="sd">        distance: distance in meters to offset point by</span>
<span class="sd">        bearing: direction to offset point to in radians</span>

<span class="sd">    returns: list of new offset lon-lat</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Earth&#39;s radius in meters</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mi">6378137</span>

    <span class="c1"># convert the lat long from degree to radians</span>
    <span class="n">lat_radians</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
    <span class="n">lon_radians</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>

    <span class="c1"># calculate the new lat long in radians</span>
    <span class="n">out_lat_radians</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span>
        <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat_radians</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="n">radius</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_radians</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="n">radius</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">out_lon_radians</span> <span class="o">=</span> <span class="n">lon_radians</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span>
        <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="n">radius</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_radians</span><span class="p">),</span>
        <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">distance</span> <span class="o">/</span> <span class="n">radius</span><span class="p">)</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat_radians</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat_radians</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># convert the new lat long back to degree</span>
    <span class="n">out_lat</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">out_lat_radians</span><span class="p">)</span>
    <span class="n">out_lon</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">out_lon_radians</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">out_lon</span><span class="p">,</span> <span class="n">out_lat</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.point_from_xy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">point_from_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xy_crs</span><span class="o">=</span><span class="n">LAT_LON_CRS</span><span class="p">,</span> <span class="n">point_crs</span><span class="o">=</span><span class="n">LAT_LON_CRS</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.point_from_xy" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Creates point geometry from x and y coordinates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>x</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x coordinate, in xy_crs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>y coordinate, in xy_crs</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>xy_crs</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate reference system in ESPG code for x/y inputs. Defaults to 4326 (WGS84)</p>
              </div>
            </td>
            <td>
                  <code><span title="network_wrangler.params.LAT_LON_CRS">LAT_LON_CRS</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>point_crs</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate reference system in ESPG code for point output.
Defaults to 4326 (WGS84)</p>
              </div>
            </td>
            <td>
                  <code><span title="network_wrangler.params.LAT_LON_CRS">LAT_LON_CRS</span></code>
            </td>
          </tr>
      </tbody>
    </table>
      

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">point_from_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xy_crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">LAT_LON_CRS</span><span class="p">,</span> <span class="n">point_crs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">LAT_LON_CRS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates point geometry from x and y coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: x coordinate, in xy_crs</span>
<span class="sd">        y: y coordinate, in xy_crs</span>
<span class="sd">        xy_crs: coordinate reference system in ESPG code for x/y inputs. Defaults to 4326 (WGS84)</span>
<span class="sd">        point_crs: coordinate reference system in ESPG code for point output.</span>
<span class="sd">            Defaults to 4326 (WGS84)</span>

<span class="sd">    Returns: Shapely Point in point_crs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">point</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xy_crs</span> <span class="o">==</span> <span class="n">point_crs</span><span class="p">:</span>
        <span class="n">check_point_valid_for_crs</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">point_crs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">point</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">xy_crs</span><span class="p">,</span> <span class="n">point_crs</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">transformers</span><span class="p">:</span>
        <span class="c1"># store transformers in dictionary because they are an &quot;expensive&quot; operation</span>
        <span class="n">transformers</span><span class="p">[(</span><span class="n">xy_crs</span><span class="p">,</span> <span class="n">point_crs</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_proj</span><span class="p">(</span>
            <span class="n">Proj</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="s2">&quot;epsg:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xy_crs</span><span class="p">)),</span>
            <span class="n">Proj</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="s2">&quot;epsg:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">point_crs</span><span class="p">)),</span>
            <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># required b/c Proj v6+ uses lon/lat instead of x/y</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">transform</span><span class="p">(</span><span class="n">transformers</span><span class="p">[(</span><span class="n">xy_crs</span><span class="p">,</span> <span class="n">point_crs</span><span class="p">)]</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.to_points_gdf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_points_gdf</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">ref_nodes_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_road_net</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.to_points_gdf" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Convert a table to a GeoDataFrame.</p>
<p>If the table is already a GeoDataFrame, return it as is. Otherwise, attempt to convert the
table to a GeoDataFrame using the following methods:
1. If the table has a &lsquo;geometry&rsquo; column, return a GeoDataFrame using that column.
2. If the table has &lsquo;lat&rsquo; and &lsquo;lon&rsquo; columns, return a GeoDataFrame using those columns.
3. If the table has a &lsquo;*model_node_id&rsquo; or &lsquo;stop_id&rsquo; column, return a GeoDataFrame using that column and the
     nodes_df provided.
If none of the above, raise a ValueError.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>table</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to convert to GeoDataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>ref_nodes_df</code></td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame of nodes to use to convert model_node_id to geometry.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>ref_road_net</code></td>
            <td>
                  <code>&#39;RoadwayNetwork&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RoadwayNetwork object to use to convert model_node_id to geometry.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoDataFrame</code></td>            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame representation of the table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_points_gdf</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">ref_nodes_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ref_road_net</span><span class="p">:</span> <span class="s2">&quot;RoadwayNetwork&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a table to a GeoDataFrame.</span>

<span class="sd">    If the table is already a GeoDataFrame, return it as is. Otherwise, attempt to convert the</span>
<span class="sd">    table to a GeoDataFrame using the following methods:</span>
<span class="sd">    1. If the table has a &#39;geometry&#39; column, return a GeoDataFrame using that column.</span>
<span class="sd">    2. If the table has &#39;lat&#39; and &#39;lon&#39; columns, return a GeoDataFrame using those columns.</span>
<span class="sd">    3. If the table has a &#39;*model_node_id&#39; or &#39;stop_id&#39; column, return a GeoDataFrame using that column and the</span>
<span class="sd">         nodes_df provided.</span>
<span class="sd">    If none of the above, raise a ValueError.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: DataFrame to convert to GeoDataFrame.</span>
<span class="sd">        ref_nodes_df: GeoDataFrame of nodes to use to convert model_node_id to geometry.</span>
<span class="sd">        ref_road_net: RoadwayNetwork object to use to convert model_node_id to geometry.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoDataFrame: GeoDataFrame representation of the table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">table</span> <span class="ow">is</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">table</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Converting GTFS table to GeoDataFrame&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;geometry&quot;</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>

    <span class="n">lat_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
    <span class="n">lon_cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="s2">&quot;lon&quot;</span> <span class="ow">in</span> <span class="n">col</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
    <span class="n">model_node_id_cols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span> <span class="s2">&quot;stop_id&quot;</span><span class="p">,</span> <span class="s2">&quot;shape_model_node_id&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lat_cols</span> <span class="ow">and</span> <span class="n">lon_cols</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">model_node_id_cols</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;Needed either lat/long or *model_node_id columns to convert </span><span class="se">\</span>
<span class="s2">            to GeoDataFrame. Columns found: </span><span class="si">{table.columns}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lat_cols</span> <span class="ow">and</span> <span class="n">lon_cols</span><span class="p">):</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No lat/long cols found.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model_node_id_cols</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No *model_node_id cols found.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Could not find lat/long, geometry columns or *model_node_id column in </span><span class="se">\</span>
<span class="s2">                         table necessary to convert to GeoDataFrame&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">lat_cols</span> <span class="ow">and</span> <span class="n">lon_cols</span><span class="p">:</span>
        <span class="c1"># using first found lat and lon columns</span>
        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="n">table</span><span class="p">,</span>
            <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">lon_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">table</span><span class="p">[</span><span class="n">lat_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span>
            <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">model_node_id_cols</span><span class="p">:</span>
        <span class="n">node_id_col</span> <span class="o">=</span> <span class="n">model_node_id_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ref_nodes_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ref_road_net</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Must provide either nodes_df or road_net to convert </span><span class="se">\</span>
<span class="s2">                                 model_node_id to geometry&quot;</span>
                <span class="p">)</span>
            <span class="n">ref_nodes_df</span> <span class="o">=</span> <span class="n">ref_road_net</span><span class="o">.</span><span class="n">nodes_df</span>

        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Converting table to GeoDataFrame using model_node_id&quot;</span><span class="p">)</span>

        <span class="n">_table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">ref_nodes_df</span><span class="p">[[</span><span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
            <span class="n">left_on</span><span class="o">=</span><span class="n">node_id_col</span><span class="p">,</span>
            <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">_table</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="s2">&quot;Could not find lat/long, geometry columns or *model_node_id column in table </span><span class="se">\</span>
<span class="s2">                     necessary to convert to GeoDataFrame&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.update_nodes_in_linestring_geometry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_nodes_in_linestring_geometry</span><span class="p">(</span><span class="n">original_df</span><span class="p">,</span> <span class="n">updated_nodes_df</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.update_nodes_in_linestring_geometry" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Updates the nodes in a linestring geometry and returns updated geometry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>original_df</code></td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame with the <code>model_node_id</code> and linestring geometry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>updated_nodes_df</code></td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame with updated node geometries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>position in the linestring to update with the node.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_nodes_in_linestring_geometry</span><span class="p">(</span>
    <span class="n">original_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span>
    <span class="n">updated_nodes_df</span><span class="p">:</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">,</span>
    <span class="n">position</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates the nodes in a linestring geometry and returns updated geometry.</span>

<span class="sd">    Args:</span>
<span class="sd">        original_df: GeoDataFrame with the `model_node_id` and linestring geometry</span>
<span class="sd">        updated_nodes_df: GeoDataFrame with updated node geometries.</span>
<span class="sd">        position: position in the linestring to update with the node.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">LINK_FK_NODE</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]</span>
    <span class="n">original_index</span> <span class="o">=</span> <span class="n">original_df</span><span class="o">.</span><span class="n">index</span>

    <span class="n">updated_df</span> <span class="o">=</span> <span class="n">original_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">updated_nodes_df</span><span class="p">[[</span><span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
        <span class="n">left_on</span><span class="o">=</span><span class="n">LINK_FK_NODE</span><span class="p">[</span><span class="n">position</span><span class="p">],</span>
        <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span>
        <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_node&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">updated_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">updated_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">update_points_in_linestring</span><span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;geometry_node&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">position</span>
        <span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">updated_df</span> <span class="o">=</span> <span class="n">updated_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">original_index</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;updated_df - AFTER: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">updated_df</span><span class="o">.</span><span class="n">geometry</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">updated_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.update_point_geometry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_point_geometry</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">ref_point_df</span><span class="p">,</span> <span class="n">lon_field</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">lat_field</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">id_field</span><span class="o">=</span><span class="s1">&#39;model_node_id&#39;</span><span class="p">,</span> <span class="n">ref_lon_field</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">ref_lat_field</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">ref_id_field</span><span class="o">=</span><span class="s1">&#39;model_node_id&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.update_point_geometry" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Returns copy of df with lat and long fields updated with geometry from ref_point_df.</p>
<p>NOTE: does not update &ldquo;geometry&rdquo; field if it exists.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_point_geometry</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">ref_point_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">lon_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span>
    <span class="n">lat_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">id_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span>
    <span class="n">ref_lon_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span>
    <span class="n">ref_lat_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">ref_id_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;model_node_id&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns copy of df with lat and long fields updated with geometry from ref_point_df.</span>

<span class="sd">    NOTE: does not update &quot;geometry&quot; field if it exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">ref_df</span> <span class="o">=</span> <span class="n">ref_point_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="n">ref_lon_field</span><span class="p">:</span> <span class="n">lon_field</span><span class="p">,</span>
            <span class="n">ref_lat_field</span><span class="p">:</span> <span class="n">lat_field</span><span class="p">,</span>
            <span class="n">ref_id_field</span><span class="p">:</span> <span class="n">id_field</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="n">updated_df</span> <span class="o">=</span> <span class="n">update_df_by_col_value</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span>
        <span class="n">ref_df</span><span class="p">[[</span><span class="n">id_field</span><span class="p">,</span> <span class="n">lon_field</span><span class="p">,</span> <span class="n">lat_field</span><span class="p">]],</span>
        <span class="n">id_field</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="n">lat_field</span><span class="p">,</span> <span class="n">lon_field</span><span class="p">],</span>
        <span class="n">fail_if_missing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">updated_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="network_wrangler.utils.geo.update_points_in_linestring" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_points_in_linestring</span><span class="p">(</span><span class="n">linestring</span><span class="p">,</span> <span class="n">updated_coords</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.geo.update_points_in_linestring" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Replaces a point in a linestring with a new point.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>linestring</code></td>
            <td>
                  <code><span title="shapely.geometry.LineString">LineString</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>original_linestring</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>updated_coords</code></td>
            <td>
                  <code><span title="typing.List">List</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>updated poimt coordinates</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>position</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>position in the linestring to update</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/geo.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_points_in_linestring</span><span class="p">(</span>
    <span class="n">linestring</span><span class="p">:</span> <span class="n">LineString</span><span class="p">,</span> <span class="n">updated_coords</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Replaces a point in a linestring with a new point.</span>

<span class="sd">    Args:</span>
<span class="sd">        linestring (LineString): original_linestring</span>
<span class="sd">        updated_coords (List[float]): updated poimt coordinates</span>
<span class="sd">        position (int): position in the linestring to update</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">linestring</span><span class="o">.</span><span class="n">coords</span><span class="p">]</span>
    <span class="n">coords</span><span class="p">[</span><span class="n">position</span><span class="p">]</span> <span class="o">=</span> <span class="n">updated_coords</span>
    <span class="k">return</span> <span class="n">LineString</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.utils.df_accessors"></a>
    <div class="doc doc-contents first">

      <p>Dataframe accessors that allow functions to be called directly on the dataframe.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.df_accessors.DictQueryAccessor" class="doc doc-heading">
            <code>DictQueryAccessor</code>


<a href="#network_wrangler.utils.df_accessors.DictQueryAccessor" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">


      <p>Query link, node and shape dataframes using project selection dictionary.</p>
<p>Will overlook any keys which are not columns in the dataframe.</p>
<p>Usage:</p>
<div class="language-text highlight"><pre><span></span><code>selection_dict = {
    &quot;lanes&quot;:[1,2,3],
    &quot;name&quot;:[&#39;6th&#39;,&#39;Sixth&#39;,&#39;sixth&#39;],
    &quot;drive_access&quot;: 1,
}
selected_links_df = links_df.dict_query(selection_dict)
</code></pre></div>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/df_accessors.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">register_dataframe_accessor</span><span class="p">(</span><span class="s2">&quot;dict_query&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">DictQueryAccessor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query link, node and shape dataframes using project selection dictionary.</span>

<span class="sd">    Will overlook any keys which are not columns in the dataframe.</span>

<span class="sd">    Usage:</span>

<span class="sd">    ```</span>
<span class="sd">    selection_dict = {</span>
<span class="sd">        &quot;lanes&quot;:[1,2,3],</span>
<span class="sd">        &quot;name&quot;:[&#39;6th&#39;,&#39;Sixth&#39;,&#39;sixth&#39;],</span>
<span class="sd">        &quot;drive_access&quot;: 1,</span>
<span class="sd">    }</span>
<span class="sd">    selected_links_df = links_df.dict_query(selection_dict)</span>
<span class="sd">    ```</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pandas_obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialization function for the dictionary query accessor.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">pandas_obj</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">return_all_if_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Queries the dataframe using the selection dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            selection_dict (dict): _description_</span>
<span class="sd">            return_all_if_none (bool, optional): If True, will return entire df if dict has</span>
<span class="sd">                 no values. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_selection_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">selection_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">_selection_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_all_if_none</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relevant part of selection dictionary is empty: </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">_sel_query</span> <span class="o">=</span> <span class="n">dict_to_query</span><span class="p">(</span><span class="n">_selection_dict</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_sel_query: </span><span class="se">\n</span><span class="s2">   </span><span class="si">{</span><span class="n">_sel_query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">_sel_query</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No records found in df </span><span class="se">\</span>
<span class="s2">                  using selection: </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">_df</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="network_wrangler.utils.df_accessors.DictQueryAccessor.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">selection_dict</span><span class="p">,</span> <span class="n">return_all_if_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.df_accessors.DictQueryAccessor.__call__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Queries the dataframe using the selection dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>selection_dict</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>return_all_if_none</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will return entire df if dict has
 no values. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/df_accessors.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selection_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">return_all_if_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Queries the dataframe using the selection dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        selection_dict (dict): _description_</span>
<span class="sd">        return_all_if_none (bool, optional): If True, will return entire df if dict has</span>
<span class="sd">             no values. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_selection_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">selection_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">_selection_dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_all_if_none</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relevant part of selection dictionary is empty: </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">_sel_query</span> <span class="o">=</span> <span class="n">dict_to_query</span><span class="p">(</span><span class="n">_selection_dict</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_sel_query: </span><span class="se">\n</span><span class="s2">   </span><span class="si">{</span><span class="n">_sel_query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">_sel_query</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;No records found in df </span><span class="se">\</span>
<span class="s2">              using selection: </span><span class="si">{</span><span class="n">selection_dict</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">_df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.utils.df_accessors.DictQueryAccessor.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">pandas_obj</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.df_accessors.DictQueryAccessor.__init__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Initialization function for the dictionary query accessor.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/df_accessors.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pandas_obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization function for the dictionary query accessor.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">pandas_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="network_wrangler.utils.df_accessors.dfHash" class="doc doc-heading">
            <code>dfHash</code>


<a href="#network_wrangler.utils.df_accessors.dfHash" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">


      <p>Creates a dataframe hash that is compatable with geopandas and various metadata.</p>
<p>Definitely not the fastest, but she seems to work where others have failed.</p>

              <details class="quote">
                <summary>Source code in <code>network_wrangler/utils/df_accessors.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">register_dataframe_accessor</span><span class="p">(</span><span class="s2">&quot;df_hash&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">dfHash</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a dataframe hash that is compatable with geopandas and various metadata.</span>

<span class="sd">    Definitely not the fastest, but she seems to work where others have failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pandas_obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialization function for the dataframe hash.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">pandas_obj</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to hash the dataframe.&quot;&quot;&quot;</span>
        <span class="n">_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="nb">hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">_value</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">hash</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="network_wrangler.utils.df_accessors.dfHash.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">()</span></code>

<a href="#network_wrangler.utils.df_accessors.dfHash.__call__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Function to hash the dataframe.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/df_accessors.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to hash the dataframe.&quot;&quot;&quot;</span>
    <span class="n">_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="nb">hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">_value</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">hash</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="network_wrangler.utils.df_accessors.dfHash.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">pandas_obj</span><span class="p">)</span></code>

<a href="#network_wrangler.utils.df_accessors.dfHash.__init__" class="headerlink" title="Permanent link"> </a></h3>


    <div class="doc doc-contents ">

      <p>Initialization function for the dataframe hash.</p>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/utils/df_accessors.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pandas_obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization function for the dataframe hash.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">pandas_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="network_wrangler.logger"></a>
    <div class="doc doc-contents first">

      <p>Logging utilities for Network Wrangler.</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="network_wrangler.logger.setup_logging" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setup_logging</span><span class="p">(</span><span class="n">info_log_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug_log_filename</span><span class="o">=</span><span class="s1">&#39;wrangler_</span><span class="si">{}</span><span class="s1">.debug.log&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y_%m_</span><span class="si">%d</span><span class="s1">__%H_%M_%S&#39;</span><span class="p">)),</span> <span class="n">std_out_level</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">)</span></code>

<a href="#network_wrangler.logger.setup_logging" class="headerlink" title="Permanent link"> </a></h2>


    <div class="doc doc-contents ">

      <p>Sets up the WranglerLogger w.r.t. the debug file location and if logging to console.</p>
<p>Called by the test_logging fixture in conftest.py and can be called by the user to setup
logging for their session. If called multiple times, the logger will be reset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>info_log_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the location of the log file that will get created to add the INFO log.
The INFO Log is terse, just gives the bare minimum of details.
Defaults to file in cwd() <code>wrangler_[datetime].log</code>. To turn off logging to a file,
use log_filename = None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>debug_log_filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the location of the log file that will get created to add the DEBUG log
The DEBUG log is very noisy, for debugging. Defaults to file in cwd()
<code>wrangler_[datetime].log</code>. To turn off logging to a file, use log_filename = None.</p>
              </div>
            </td>
            <td>
                  <code><span title="str.format">format</span>(strftime(&#39;%Y_%m_%d__%H_%M_%S&#39;))</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>std_out_level</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the level of logging to the console. One of &ldquo;info&rdquo;, &ldquo;warning&rdquo;, &ldquo;debug&rdquo;.
Defaults to &ldquo;info&rdquo; but will be set to ERROR if nothing provided matches.</p>
              </div>
            </td>
            <td>
                  <code>&#39;info&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>network_wrangler/logger.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span>
    <span class="n">info_log_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">debug_log_filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;wrangler_</span><span class="si">{}</span><span class="s2">.debug.log&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">__%H_%M_%S&quot;</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">std_out_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;info&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets up the WranglerLogger w.r.t. the debug file location and if logging to console.</span>

<span class="sd">    Called by the test_logging fixture in conftest.py and can be called by the user to setup</span>
<span class="sd">    logging for their session. If called multiple times, the logger will be reset.</span>

<span class="sd">    Args:</span>
<span class="sd">        info_log_filename: the location of the log file that will get created to add the INFO log.</span>
<span class="sd">            The INFO Log is terse, just gives the bare minimum of details.</span>
<span class="sd">            Defaults to file in cwd() `wrangler_[datetime].log`. To turn off logging to a file,</span>
<span class="sd">            use log_filename = None.</span>
<span class="sd">        debug_log_filename: the location of the log file that will get created to add the DEBUG log</span>
<span class="sd">            The DEBUG log is very noisy, for debugging. Defaults to file in cwd()</span>
<span class="sd">            `wrangler_[datetime].log`. To turn off logging to a file, use log_filename = None.</span>
<span class="sd">        std_out_level: the level of logging to the console. One of &quot;info&quot;, &quot;warning&quot;, &quot;debug&quot;.</span>
<span class="sd">            Defaults to &quot;info&quot; but will be set to ERROR if nothing provided matches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># add function variable so that we know if logging has been called</span>
    <span class="n">setup_logging</span><span class="o">.</span><span class="n">called</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Clear handles if any exist already</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

    <span class="n">FORMAT</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">%(asctime)-15s</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2">: </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S,&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">info_log_filename</span><span class="p">:</span>
        <span class="n">info_log_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
            <span class="s2">&quot;network_wrangler_</span><span class="si">{}</span><span class="s2">.info.log&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">__%H_%M_%S&quot;</span><span class="p">)),</span>
        <span class="p">)</span>

    <span class="n">info_file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">info_log_filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">))</span>
    <span class="n">info_file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">info_file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">FORMAT</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">info_file_handler</span><span class="p">)</span>

    <span class="c1"># create debug file only when debug_log_filename is provided</span>
    <span class="k">if</span> <span class="n">debug_log_filename</span><span class="p">:</span>
        <span class="n">debug_log_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">debug_log_filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">))</span>
        <span class="n">debug_log_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
        <span class="n">debug_log_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">FORMAT</span><span class="p">)</span>
        <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">debug_log_handler</span><span class="p">)</span>

    <span class="n">console_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">console_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">FORMAT</span><span class="p">)</span>
    <span class="n">WranglerLogger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">console_handler</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">std_out_level</span> <span class="o">==</span> <span class="s2">&quot;debug&quot;</span><span class="p">:</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">std_out_level</span> <span class="o">==</span> <span class="s2">&quot;info&quot;</span><span class="p">:</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">std_out_level</span> <span class="o">==</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">console_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "content.code.annotate", "content.tabs.link", "navigation.indexes"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@8.5.0/dist/mermaid.min.js"></script>
      
    
  </body>
</html>